#include <iostream>
#include <array>
#include <pybind11/pybind11.h>
#include <pybind11/numpy.h>

namespace py = pybind11;

// math consts
static const double PI = 3.141592653589793238;
static const std::complex<double> I(0.0, 1.0);

// for ddnc calculation
static const int Nmin = 15;
static const double w_d = 0.5;
static const double r = 2.5;
static const double c = (Nmin * PI) / (r*r * (1 + r) * w_d);
static const double d = c / 2.0;
static const double shift_coeff = PI * exp(c);


// func definition
py::array_t<double> calc_10D_ddnc(py::array_t<double> eigvals, const int N){
    // set eigenvalues
    double max_eigval = *eigvals.data(0);
    for (int i = 0; i<4; i++){
        if (max_eigval < *eigvals.data(i)){
            max_eigval = *eigvals.data(i);
        }
    }

    std::array<double, 4> eigval_shifted;

    for (int i=0; i<4; i++){
        eigval_shifted[i] = *eigvals.data(i) - max_eigval;
    }
    double shift_constant = exp(max_eigval);

    // set variables for integration
    double h = sqrt(2 * PI * d * (1 + r) / (w_d * N));
    double p1 = sqrt(N * h / w_d);
    double p2 = sqrt(w_d * N * h / 4.0);
    double w;

    // initialize elements
    std::complex<double> elem00 = 0.0;
    std::complex<double> elem01 = 0.0;
    std::complex<double> elem02 = 0.0;
    std::complex<double> elem03 = 0.0;
    std::complex<double> elem11 = 0.0;
    std::complex<double> elem12 = 0.0;
    std::complex<double> elem13 = 0.0;
    std::complex<double> elem22 = 0.0;
    std::complex<double> elem23 = 0.0;
    std::complex<double> elem33 = 0.0;

    // initialize
    double t;
    std::complex<double> integrand_funcF;

    py::array_t<double> _result(10);
    auto result = _result.mutable_unchecked<1>();
    
    for (int i=-N-1; i<N+1; i++){
        t = i*h;
        w = 0.5 * std::erfc(fabs(t) / p1 - p2);

        std::complex<double> L0inv = -1. * eigval_shifted[0] + I*t + c;
        std::complex<double> L1inv = -1. * eigval_shifted[1] + I*t + c;
        std::complex<double> L2inv = -1. * eigval_shifted[2] + I*t + c;
        std::complex<double> L3inv = -1. * eigval_shifted[3] + I*t + c;

        // funcF
        integrand_funcF = 1.0;
        for(int j=0; j<4; j++){
            integrand_funcF *= 1. / sqrt(-1. * eigval_shifted[j] + I*t + c);
        }

        // integrate
        // raw 0
        elem00 += 0.75 * w * integrand_funcF/(L0inv*L0inv) * exp(I * t);
        elem01 += 0.25 * w * integrand_funcF/(L0inv*L1inv) * exp(I * t);
        elem02 += 0.25 * w * integrand_funcF/(L0inv*L2inv) * exp(I * t);
        elem03 += 0.25 * w * integrand_funcF/(L0inv*L3inv) * exp(I * t);
        // raw 1
        elem11 += 0.75 * w * integrand_funcF/(L1inv*L1inv) * exp(I * t);
        elem12 += 0.25 * w * integrand_funcF/(L1inv*L2inv) * exp(I * t);
        elem13 += 0.25 * w * integrand_funcF/(L1inv*L3inv) * exp(I * t);
        // raw 2
        elem22 += 0.75 * w * integrand_funcF/(L2inv*L2inv) * exp(I * t);
        elem23 += 0.25 * w * integrand_funcF/(L2inv*L3inv) * exp(I * t);
        // raw 3
        elem33 += 0.75 * w * integrand_funcF/(L3inv*L3inv) * exp(I * t);
    }

    // set elements
    result(0) = std::real(elem00) * h * shift_coeff;
    result(1) = std::real(elem01) * h * shift_coeff;
    result(2) = std::real(elem02) * h * shift_coeff;
    result(3) = std::real(elem03) * h * shift_coeff;
    result(4) = std::real(elem11) * h * shift_coeff;
    result(5) = std::real(elem12) * h * shift_coeff;
    result(6) = std::real(elem13) * h * shift_coeff;
    result(7) = std::real(elem22) * h * shift_coeff;
    result(8) = std::real(elem23) * h * shift_coeff;
    result(9) = std::real(elem33) * h * shift_coeff;

    return _result;
}


// func definition
py::array_t<double> calc_4thmoment_coeff(py::array_t<double> M_orthogonal){
    // initialize;
    py::array_t<double> _C({35,10});
    auto C = _C.mutable_unchecked<2>();

    // convert into std::array
    std::array<std::array<double, 4>, 4> M;
    for (int i=0; i<4; i++){
        for (int j=0; j<4; j++){
            M[i][j] = *M_orthogonal.data(i,j);
        }
    }

    // set values;
    C(0,0) = M[0][0]* M[0][0]* M[0][0]* M[0][0];
    C(1,0) = M[0][0]* M[0][0]* M[0][0]*M[1][0];
    C(2,0) = M[0][0]* M[0][0]*M[1][0]*M[1][0];
    C(3,0) = M[0][0]*M[1][0]*M[1][0]*M[1][0];
    C(4,0) = M[1][0]* M[1][0]* M[1][0]* M[1][0];
    C(5,0) = M[0][0]* M[0][0]* M[0][0]*M[2][0];
    C(6,0) = M[0][0]* M[0][0]*M[1][0]*M[2][0];
    C(7,0) = M[0][0]*M[1][0]*M[1][0]*M[2][0];
    C(8,0) = M[1][0]*M[1][0]*M[1][0]*M[2][0];
    C(9,0) = M[0][0]* M[0][0]*M[2][0]*M[2][0];
    C(10,0) = M[0][0]*M[1][0]*M[2][0]*M[2][0];
    C(11,0) = M[1][0]*M[1][0]*M[2][0]*M[2][0];
    C(12,0) = M[0][0]*M[2][0]*M[2][0]*M[2][0];
    C(13,0) = M[1][0]*M[2][0]*M[2][0]*M[2][0];
    C(14,0) = M[2][0]* M[2][0]* M[2][0]* M[2][0];
    C(15,0) = M[0][0]* M[0][0]* M[0][0]*M[3][0];
    C(16,0) = M[0][0]* M[0][0]*M[1][0]*M[3][0];
    C(17,0) = M[0][0]*M[1][0]*M[1][0]*M[3][0];
    C(18,0) = M[1][0]*M[1][0]*M[1][0]*M[3][0];
    C(19,0) = M[0][0]* M[0][0]*M[2][0]*M[3][0];
    C(20,0) = M[0][0]*M[1][0]*M[2][0]*M[3][0];
    C(21,0) = M[1][0]*M[1][0]*M[2][0]*M[3][0];
    C(22,0) = M[0][0]*M[2][0]*M[2][0]*M[3][0];
    C(23,0) = M[1][0]*M[2][0]*M[2][0]*M[3][0];
    C(24,0) = M[2][0]*M[2][0]*M[2][0]*M[3][0];
    C(25,0) = M[0][0]* M[0][0]*M[3][0]*M[3][0];
    C(26,0) = M[0][0]*M[1][0]*M[3][0]*M[3][0];
    C(27,0) = M[1][0]*M[1][0]*M[3][0]*M[3][0];
    C(28,0) = M[0][0]*M[2][0]*M[3][0]*M[3][0];
    C(29,0) = M[1][0]*M[2][0]*M[3][0]*M[3][0];
    C(30,0) = M[2][0]*M[2][0]*M[3][0]*M[3][0];
    C(31,0) = M[0][0]*M[3][0]*M[3][0]*M[3][0];
    C(32,0) = M[1][0]*M[3][0]*M[3][0]*M[3][0];
    C(33,0) = M[2][0]*M[3][0]*M[3][0]*M[3][0];
    C(34,0) = M[3][0]* M[3][0]* M[3][0]* M[3][0];
    C(0,1) = 6*M[0][0]*M[0][0]*M[0][1]*M[0][1];
    C(1,1) = 3*M[0][0]*M[0][0]*M[0][1]*M[1][1] + 3*M[0][0]*M[0][1]*M[0][1]*M[1][0];
    C(2,1) = M[0][0]* M[0][0]*M[1][1]*M[1][1]+ 4*M[0][0]*M[0][1]*M[1][0]*M[1][1] + M[0][1]*M[0][1]*M[1][0]*M[1][0];
    C(3,1) = 3*M[0][0]*M[1][0]*M[1][1]*M[1][1]+ 3*M[0][1]*M[1][0]*M[1][0]*M[1][1];
    C(4,1) = 6*M[1][0]*M[1][0]*M[1][1]*M[1][1];
    C(5,1) = 3*M[0][0]*M[0][0]*M[0][1]*M[2][1] + 3*M[0][0]*M[0][1]*M[0][1]*M[2][0];
    C(6,1) = M[0][0]* M[0][0]*M[1][1]*M[2][1] + 2*M[0][0]*M[0][1]*M[1][0]*M[2][1] + 2*M[0][0]*M[0][1]*M[1][1]*M[2][0] + M[0][1]*M[0][1]*M[1][0]*M[2][0];
    C(7,1) = 2*M[0][0]*M[1][0]*M[1][1]*M[2][1] + M[0][0]*M[1][1]*M[1][1]*M[2][0] + M[0][1]*M[1][0]*M[1][0]*M[2][1] + 2*M[0][1]*M[1][0]*M[1][1]*M[2][0];
    C(8,1) = 3*M[1][0]*M[1][0]*M[1][1]*M[2][1] + 3*M[1][0]*M[1][1]*M[1][1]*M[2][0];
    C(9,1) = M[0][0]* M[0][0]*M[2][1]*M[2][1]+ 4*M[0][0]*M[0][1]*M[2][0]*M[2][1] + M[0][1]*M[0][1]*M[2][0]*M[2][0];
    C(10,1) = M[0][0]*M[1][0]*M[2][1]*M[2][1]+ 2*M[0][0]*M[1][1]*M[2][0]*M[2][1] + 2*M[0][1]*M[1][0]*M[2][0]*M[2][1] + M[0][1]*M[1][1]*M[2][0]*M[2][0];
    C(11,1) = M[1][0]*M[1][0]*M[2][1]*M[2][1]+ 4*M[1][0]*M[1][1]*M[2][0]*M[2][1] + M[1][1]*M[1][1]*M[2][0]*M[2][0];
    C(12,1) = 3*M[0][0]*M[2][0]*M[2][1]*M[2][1]+ 3*M[0][1]*M[2][0]*M[2][0]*M[2][1];
    C(13,1) = 3*M[1][0]*M[2][0]*M[2][1]*M[2][1]+ 3*M[1][1]*M[2][0]*M[2][0]*M[2][1];
    C(14,1) = 6*M[2][0]*M[2][0]*M[2][1]*M[2][1];
    C(15,1) = 3*M[0][0]*M[0][0]*M[0][1]*M[3][1] + 3*M[0][0]*M[0][1]*M[0][1]*M[3][0];
    C(16,1) = M[0][0]* M[0][0]*M[1][1]*M[3][1] + 2*M[0][0]*M[0][1]*M[1][0]*M[3][1] + 2*M[0][0]*M[0][1]*M[1][1]*M[3][0] + M[0][1]*M[0][1]*M[1][0]*M[3][0];
    C(17,1) = 2*M[0][0]*M[1][0]*M[1][1]*M[3][1] + M[0][0]*M[1][1]*M[1][1]*M[3][0] + M[0][1]*M[1][0]*M[1][0]*M[3][1] + 2*M[0][1]*M[1][0]*M[1][1]*M[3][0];
    C(18,1) = 3*M[1][0]*M[1][0]*M[1][1]*M[3][1] + 3*M[1][0]*M[1][1]*M[1][1]*M[3][0];
    C(19,1) = M[0][0]* M[0][0]*M[2][1]*M[3][1] + 2*M[0][0]*M[0][1]*M[2][0]*M[3][1] + 2*M[0][0]*M[0][1]*M[2][1]*M[3][0] + M[0][1]*M[0][1]*M[2][0]*M[3][0];
    C(20,1) = M[0][0]*M[1][0]*M[2][1]*M[3][1] + M[0][0]*M[1][1]*M[2][0]*M[3][1] + M[0][0]*M[1][1]*M[2][1]*M[3][0] + M[0][1]*M[1][0]*M[2][0]*M[3][1] + M[0][1]*M[1][0]*M[2][1]*M[3][0] + M[0][1]*M[1][1]*M[2][0]*M[3][0];
    C(21,1) = M[1][0]*M[1][0]*M[2][1]*M[3][1] + 2*M[1][0]*M[1][1]*M[2][0]*M[3][1] + 2*M[1][0]*M[1][1]*M[2][1]*M[3][0] + M[1][1]*M[1][1]*M[2][0]*M[3][0];
    C(22,1) = 2*M[0][0]*M[2][0]*M[2][1]*M[3][1] + M[0][0]*M[2][1]*M[2][1]*M[3][0] + M[0][1]*M[2][0]*M[2][0]*M[3][1] + 2*M[0][1]*M[2][0]*M[2][1]*M[3][0];
    C(23,1) = 2*M[1][0]*M[2][0]*M[2][1]*M[3][1] + M[1][0]*M[2][1]*M[2][1]*M[3][0] + M[1][1]*M[2][0]*M[2][0]*M[3][1] + 2*M[1][1]*M[2][0]*M[2][1]*M[3][0];
    C(24,1) = 3*M[2][0]*M[2][0]*M[2][1]*M[3][1] + 3*M[2][0]*M[2][1]*M[2][1]*M[3][0];
    C(25,1) = M[0][0]* M[0][0]*M[3][1]*M[3][1]+ 4*M[0][0]*M[0][1]*M[3][0]*M[3][1] + M[0][1]*M[0][1]*M[3][0]*M[3][0];
    C(26,1) = M[0][0]*M[1][0]*M[3][1]*M[3][1]+ 2*M[0][0]*M[1][1]*M[3][0]*M[3][1] + 2*M[0][1]*M[1][0]*M[3][0]*M[3][1] + M[0][1]*M[1][1]*M[3][0]*M[3][0];
    C(27,1) = M[1][0]*M[1][0]*M[3][1]*M[3][1]+ 4*M[1][0]*M[1][1]*M[3][0]*M[3][1] + M[1][1]*M[1][1]*M[3][0]*M[3][0];
    C(28,1) = M[0][0]*M[2][0]*M[3][1]*M[3][1]+ 2*M[0][0]*M[2][1]*M[3][0]*M[3][1] + 2*M[0][1]*M[2][0]*M[3][0]*M[3][1] + M[0][1]*M[2][1]*M[3][0]*M[3][0];
    C(29,1) = M[1][0]*M[2][0]*M[3][1]*M[3][1]+ 2*M[1][0]*M[2][1]*M[3][0]*M[3][1] + 2*M[1][1]*M[2][0]*M[3][0]*M[3][1] + M[1][1]*M[2][1]*M[3][0]*M[3][0];
    C(30,1) = M[2][0]*M[2][0]*M[3][1]*M[3][1]+ 4*M[2][0]*M[2][1]*M[3][0]*M[3][1] + M[2][1]*M[2][1]*M[3][0]*M[3][0];
    C(31,1) = 3*M[0][0]*M[3][0]*M[3][1]*M[3][1]+ 3*M[0][1]*M[3][0]*M[3][0]*M[3][1];
    C(32,1) = 3*M[1][0]*M[3][0]*M[3][1]*M[3][1]+ 3*M[1][1]*M[3][0]*M[3][0]*M[3][1];
    C(33,1) = 3*M[2][0]*M[3][0]*M[3][1]*M[3][1]+ 3*M[2][1]*M[3][0]*M[3][0]*M[3][1];
    C(34,1) = 6*M[3][0]*M[3][0]*M[3][1]*M[3][1];
    C(0,2) = 6*M[0][0]*M[0][0]*M[0][2]*M[0][2];
    C(1,2) = 3*M[0][0]*M[0][0]*M[0][2]*M[1][2] + 3*M[0][0]*M[0][2]*M[0][2]*M[1][0];
    C(2,2) = M[0][0]* M[0][0]*M[1][2]*M[1][2]+ 4*M[0][0]*M[0][2]*M[1][0]*M[1][2] + M[0][2]*M[0][2]*M[1][0]*M[1][0];
    C(3,2) = 3*M[0][0]*M[1][0]*M[1][2]*M[1][2]+ 3*M[0][2]*M[1][0]*M[1][0]*M[1][2];
    C(4,2) = 6*M[1][0]*M[1][0]*M[1][2]*M[1][2];
    C(5,2) = 3*M[0][0]*M[0][0]*M[0][2]*M[2][2] + 3*M[0][0]*M[0][2]*M[0][2]*M[2][0];
    C(6,2) = M[0][0]* M[0][0]*M[1][2]*M[2][2] + 2*M[0][0]*M[0][2]*M[1][0]*M[2][2] + 2*M[0][0]*M[0][2]*M[1][2]*M[2][0] + M[0][2]*M[0][2]*M[1][0]*M[2][0];
    C(7,2) = 2*M[0][0]*M[1][0]*M[1][2]*M[2][2] + M[0][0]*M[1][2]*M[1][2]*M[2][0] + M[0][2]*M[1][0]*M[1][0]*M[2][2] + 2*M[0][2]*M[1][0]*M[1][2]*M[2][0];
    C(8,2) = 3*M[1][0]*M[1][0]*M[1][2]*M[2][2] + 3*M[1][0]*M[1][2]*M[1][2]*M[2][0];
    C(9,2) = M[0][0]* M[0][0]*M[2][2]*M[2][2]+ 4*M[0][0]*M[0][2]*M[2][0]*M[2][2] + M[0][2]*M[0][2]*M[2][0]*M[2][0];
    C(10,2) = M[0][0]*M[1][0]*M[2][2]*M[2][2]+ 2*M[0][0]*M[1][2]*M[2][0]*M[2][2] + 2*M[0][2]*M[1][0]*M[2][0]*M[2][2] + M[0][2]*M[1][2]*M[2][0]*M[2][0];
    C(11,2) = M[1][0]*M[1][0]*M[2][2]*M[2][2]+ 4*M[1][0]*M[1][2]*M[2][0]*M[2][2] + M[1][2]*M[1][2]*M[2][0]*M[2][0];
    C(12,2) = 3*M[0][0]*M[2][0]*M[2][2]*M[2][2]+ 3*M[0][2]*M[2][0]*M[2][0]*M[2][2];
    C(13,2) = 3*M[1][0]*M[2][0]*M[2][2]*M[2][2]+ 3*M[1][2]*M[2][0]*M[2][0]*M[2][2];
    C(14,2) = 6*M[2][0]*M[2][0]*M[2][2]*M[2][2];
    C(15,2) = 3*M[0][0]*M[0][0]*M[0][2]*M[3][2] + 3*M[0][0]*M[0][2]*M[0][2]*M[3][0];
    C(16,2) = M[0][0]* M[0][0]*M[1][2]*M[3][2] + 2*M[0][0]*M[0][2]*M[1][0]*M[3][2] + 2*M[0][0]*M[0][2]*M[1][2]*M[3][0] + M[0][2]*M[0][2]*M[1][0]*M[3][0];
    C(17,2) = 2*M[0][0]*M[1][0]*M[1][2]*M[3][2] + M[0][0]*M[1][2]*M[1][2]*M[3][0] + M[0][2]*M[1][0]*M[1][0]*M[3][2] + 2*M[0][2]*M[1][0]*M[1][2]*M[3][0];
    C(18,2) = 3*M[1][0]*M[1][0]*M[1][2]*M[3][2] + 3*M[1][0]*M[1][2]*M[1][2]*M[3][0];
    C(19,2) = M[0][0]* M[0][0]*M[2][2]*M[3][2] + 2*M[0][0]*M[0][2]*M[2][0]*M[3][2] + 2*M[0][0]*M[0][2]*M[2][2]*M[3][0] + M[0][2]*M[0][2]*M[2][0]*M[3][0];
    C(20,2) = M[0][0]*M[1][0]*M[2][2]*M[3][2] + M[0][0]*M[1][2]*M[2][0]*M[3][2] + M[0][0]*M[1][2]*M[2][2]*M[3][0] + M[0][2]*M[1][0]*M[2][0]*M[3][2] + M[0][2]*M[1][0]*M[2][2]*M[3][0] + M[0][2]*M[1][2]*M[2][0]*M[3][0];
    C(21,2) = M[1][0]*M[1][0]*M[2][2]*M[3][2] + 2*M[1][0]*M[1][2]*M[2][0]*M[3][2] + 2*M[1][0]*M[1][2]*M[2][2]*M[3][0] + M[1][2]*M[1][2]*M[2][0]*M[3][0];
    C(22,2) = 2*M[0][0]*M[2][0]*M[2][2]*M[3][2] + M[0][0]*M[2][2]*M[2][2]*M[3][0] + M[0][2]*M[2][0]*M[2][0]*M[3][2] + 2*M[0][2]*M[2][0]*M[2][2]*M[3][0];
    C(23,2) = 2*M[1][0]*M[2][0]*M[2][2]*M[3][2] + M[1][0]*M[2][2]*M[2][2]*M[3][0] + M[1][2]*M[2][0]*M[2][0]*M[3][2] + 2*M[1][2]*M[2][0]*M[2][2]*M[3][0];
    C(24,2) = 3*M[2][0]*M[2][0]*M[2][2]*M[3][2] + 3*M[2][0]*M[2][2]*M[2][2]*M[3][0];
    C(25,2) = M[0][0]* M[0][0]*M[3][2]*M[3][2]+ 4*M[0][0]*M[0][2]*M[3][0]*M[3][2] + M[0][2]*M[0][2]*M[3][0]*M[3][0];
    C(26,2) = M[0][0]*M[1][0]*M[3][2]*M[3][2]+ 2*M[0][0]*M[1][2]*M[3][0]*M[3][2] + 2*M[0][2]*M[1][0]*M[3][0]*M[3][2] + M[0][2]*M[1][2]*M[3][0]*M[3][0];
    C(27,2) = M[1][0]*M[1][0]*M[3][2]*M[3][2]+ 4*M[1][0]*M[1][2]*M[3][0]*M[3][2] + M[1][2]*M[1][2]*M[3][0]*M[3][0];
    C(28,2) = M[0][0]*M[2][0]*M[3][2]*M[3][2]+ 2*M[0][0]*M[2][2]*M[3][0]*M[3][2] + 2*M[0][2]*M[2][0]*M[3][0]*M[3][2] + M[0][2]*M[2][2]*M[3][0]*M[3][0];
    C(29,2) = M[1][0]*M[2][0]*M[3][2]*M[3][2]+ 2*M[1][0]*M[2][2]*M[3][0]*M[3][2] + 2*M[1][2]*M[2][0]*M[3][0]*M[3][2] + M[1][2]*M[2][2]*M[3][0]*M[3][0];
    C(30,2) = M[2][0]*M[2][0]*M[3][2]*M[3][2]+ 4*M[2][0]*M[2][2]*M[3][0]*M[3][2] + M[2][2]*M[2][2]*M[3][0]*M[3][0];
    C(31,2) = 3*M[0][0]*M[3][0]*M[3][2]*M[3][2]+ 3*M[0][2]*M[3][0]*M[3][0]*M[3][2];
    C(32,2) = 3*M[1][0]*M[3][0]*M[3][2]*M[3][2]+ 3*M[1][2]*M[3][0]*M[3][0]*M[3][2];
    C(33,2) = 3*M[2][0]*M[3][0]*M[3][2]*M[3][2]+ 3*M[2][2]*M[3][0]*M[3][0]*M[3][2];
    C(34,2) = 6*M[3][0]*M[3][0]*M[3][2]*M[3][2];
    C(0,3) = 6*M[0][0]*M[0][0]*M[0][3]*M[0][3];
    C(1,3) = 3*M[0][0]*M[0][0]*M[0][3]*M[1][3] + 3*M[0][0]*M[0][3]*M[0][3]*M[1][0];
    C(2,3) = M[0][0]* M[0][0]*M[1][3]*M[1][3]+ 4*M[0][0]*M[0][3]*M[1][0]*M[1][3] + M[0][3]*M[0][3]*M[1][0]*M[1][0];
    C(3,3) = 3*M[0][0]*M[1][0]*M[1][3]*M[1][3]+ 3*M[0][3]*M[1][0]*M[1][0]*M[1][3];
    C(4,3) = 6*M[1][0]*M[1][0]*M[1][3]*M[1][3];
    C(5,3) = 3*M[0][0]*M[0][0]*M[0][3]*M[2][3] + 3*M[0][0]*M[0][3]*M[0][3]*M[2][0];
    C(6,3) = M[0][0]* M[0][0]*M[1][3]*M[2][3] + 2*M[0][0]*M[0][3]*M[1][0]*M[2][3] + 2*M[0][0]*M[0][3]*M[1][3]*M[2][0] + M[0][3]*M[0][3]*M[1][0]*M[2][0];
    C(7,3) = 2*M[0][0]*M[1][0]*M[1][3]*M[2][3] + M[0][0]*M[1][3]*M[1][3]*M[2][0] + M[0][3]*M[1][0]*M[1][0]*M[2][3] + 2*M[0][3]*M[1][0]*M[1][3]*M[2][0];
    C(8,3) = 3*M[1][0]*M[1][0]*M[1][3]*M[2][3] + 3*M[1][0]*M[1][3]*M[1][3]*M[2][0];
    C(9,3) = M[0][0]* M[0][0]*M[2][3]*M[2][3]+ 4*M[0][0]*M[0][3]*M[2][0]*M[2][3] + M[0][3]*M[0][3]*M[2][0]*M[2][0];
    C(10,3) = M[0][0]*M[1][0]*M[2][3]*M[2][3]+ 2*M[0][0]*M[1][3]*M[2][0]*M[2][3] + 2*M[0][3]*M[1][0]*M[2][0]*M[2][3] + M[0][3]*M[1][3]*M[2][0]*M[2][0];
    C(11,3) = M[1][0]*M[1][0]*M[2][3]*M[2][3]+ 4*M[1][0]*M[1][3]*M[2][0]*M[2][3] + M[1][3]*M[1][3]*M[2][0]*M[2][0];
    C(12,3) = 3*M[0][0]*M[2][0]*M[2][3]*M[2][3]+ 3*M[0][3]*M[2][0]*M[2][0]*M[2][3];
    C(13,3) = 3*M[1][0]*M[2][0]*M[2][3]*M[2][3]+ 3*M[1][3]*M[2][0]*M[2][0]*M[2][3];
    C(14,3) = 6*M[2][0]*M[2][0]*M[2][3]*M[2][3];
    C(15,3) = 3*M[0][0]*M[0][0]*M[0][3]*M[3][3] + 3*M[0][0]*M[0][3]*M[0][3]*M[3][0];
    C(16,3) = M[0][0]* M[0][0]*M[1][3]*M[3][3] + 2*M[0][0]*M[0][3]*M[1][0]*M[3][3] + 2*M[0][0]*M[0][3]*M[1][3]*M[3][0] + M[0][3]*M[0][3]*M[1][0]*M[3][0];
    C(17,3) = 2*M[0][0]*M[1][0]*M[1][3]*M[3][3] + M[0][0]*M[1][3]*M[1][3]*M[3][0] + M[0][3]*M[1][0]*M[1][0]*M[3][3] + 2*M[0][3]*M[1][0]*M[1][3]*M[3][0];
    C(18,3) = 3*M[1][0]*M[1][0]*M[1][3]*M[3][3] + 3*M[1][0]*M[1][3]*M[1][3]*M[3][0];
    C(19,3) = M[0][0]* M[0][0]*M[2][3]*M[3][3] + 2*M[0][0]*M[0][3]*M[2][0]*M[3][3] + 2*M[0][0]*M[0][3]*M[2][3]*M[3][0] + M[0][3]*M[0][3]*M[2][0]*M[3][0];
    C(20,3) = M[0][0]*M[1][0]*M[2][3]*M[3][3] + M[0][0]*M[1][3]*M[2][0]*M[3][3] + M[0][0]*M[1][3]*M[2][3]*M[3][0] + M[0][3]*M[1][0]*M[2][0]*M[3][3] + M[0][3]*M[1][0]*M[2][3]*M[3][0] + M[0][3]*M[1][3]*M[2][0]*M[3][0];
    C(21,3) = M[1][0]*M[1][0]*M[2][3]*M[3][3] + 2*M[1][0]*M[1][3]*M[2][0]*M[3][3] + 2*M[1][0]*M[1][3]*M[2][3]*M[3][0] + M[1][3]*M[1][3]*M[2][0]*M[3][0];
    C(22,3) = 2*M[0][0]*M[2][0]*M[2][3]*M[3][3] + M[0][0]*M[2][3]*M[2][3]*M[3][0] + M[0][3]*M[2][0]*M[2][0]*M[3][3] + 2*M[0][3]*M[2][0]*M[2][3]*M[3][0];
    C(23,3) = 2*M[1][0]*M[2][0]*M[2][3]*M[3][3] + M[1][0]*M[2][3]*M[2][3]*M[3][0] + M[1][3]*M[2][0]*M[2][0]*M[3][3] + 2*M[1][3]*M[2][0]*M[2][3]*M[3][0];
    C(24,3) = 3*M[2][0]*M[2][0]*M[2][3]*M[3][3] + 3*M[2][0]*M[2][3]*M[2][3]*M[3][0];
    C(25,3) = M[0][0]* M[0][0]*M[3][3]*M[3][3]+ 4*M[0][0]*M[0][3]*M[3][0]*M[3][3] + M[0][3]*M[0][3]*M[3][0]*M[3][0];
    C(26,3) = M[0][0]*M[1][0]*M[3][3]*M[3][3]+ 2*M[0][0]*M[1][3]*M[3][0]*M[3][3] + 2*M[0][3]*M[1][0]*M[3][0]*M[3][3] + M[0][3]*M[1][3]*M[3][0]*M[3][0];
    C(27,3) = M[1][0]*M[1][0]*M[3][3]*M[3][3]+ 4*M[1][0]*M[1][3]*M[3][0]*M[3][3] + M[1][3]*M[1][3]*M[3][0]*M[3][0];
    C(28,3) = M[0][0]*M[2][0]*M[3][3]*M[3][3]+ 2*M[0][0]*M[2][3]*M[3][0]*M[3][3] + 2*M[0][3]*M[2][0]*M[3][0]*M[3][3] + M[0][3]*M[2][3]*M[3][0]*M[3][0];
    C(29,3) = M[1][0]*M[2][0]*M[3][3]*M[3][3]+ 2*M[1][0]*M[2][3]*M[3][0]*M[3][3] + 2*M[1][3]*M[2][0]*M[3][0]*M[3][3] + M[1][3]*M[2][3]*M[3][0]*M[3][0];
    C(30,3) = M[2][0]*M[2][0]*M[3][3]*M[3][3]+ 4*M[2][0]*M[2][3]*M[3][0]*M[3][3] + M[2][3]*M[2][3]*M[3][0]*M[3][0];
    C(31,3) = 3*M[0][0]*M[3][0]*M[3][3]*M[3][3]+ 3*M[0][3]*M[3][0]*M[3][0]*M[3][3];
    C(32,3) = 3*M[1][0]*M[3][0]*M[3][3]*M[3][3]+ 3*M[1][3]*M[3][0]*M[3][0]*M[3][3];
    C(33,3) = 3*M[2][0]*M[3][0]*M[3][3]*M[3][3]+ 3*M[2][3]*M[3][0]*M[3][0]*M[3][3];
    C(34,3) = 6*M[3][0]*M[3][0]*M[3][3]*M[3][3];
    C(0,4) = M[0][1]* M[0][1]* M[0][1]* M[0][1];
    C(1,4) = M[0][1]* M[0][1]* M[0][1]*M[1][1];
    C(2,4) = M[0][1]*M[0][1]*M[1][1]*M[1][1];
    C(3,4) = M[0][1]*M[1][1]*M[1][1]*M[1][1];
    C(4,4) = M[1][1]* M[1][1]* M[1][1]* M[1][1];
    C(5,4) = M[0][1]* M[0][1]* M[0][1]*M[2][1];
    C(6,4) = M[0][1]*M[0][1]*M[1][1]*M[2][1];
    C(7,4) = M[0][1]*M[1][1]*M[1][1]*M[2][1];
    C(8,4) = M[1][1]*M[1][1]*M[1][1]*M[2][1];
    C(9,4) = M[0][1]*M[0][1]*M[2][1]*M[2][1];
    C(10,4) = M[0][1]*M[1][1]*M[2][1]*M[2][1];
    C(11,4) = M[1][1]*M[1][1]*M[2][1]*M[2][1];
    C(12,4) = M[0][1]*M[2][1]*M[2][1]*M[2][1];
    C(13,4) = M[1][1]*M[2][1]*M[2][1]*M[2][1];
    C(14,4) = M[2][1]* M[2][1]* M[2][1]* M[2][1];
    C(15,4) = M[0][1]* M[0][1]* M[0][1]*M[3][1];
    C(16,4) = M[0][1]*M[0][1]*M[1][1]*M[3][1];
    C(17,4) = M[0][1]*M[1][1]*M[1][1]*M[3][1];
    C(18,4) = M[1][1]*M[1][1]*M[1][1]*M[3][1];
    C(19,4) = M[0][1]*M[0][1]*M[2][1]*M[3][1];
    C(20,4) = M[0][1]*M[1][1]*M[2][1]*M[3][1];
    C(21,4) = M[1][1]*M[1][1]*M[2][1]*M[3][1];
    C(22,4) = M[0][1]*M[2][1]*M[2][1]*M[3][1];
    C(23,4) = M[1][1]*M[2][1]*M[2][1]*M[3][1];
    C(24,4) = M[2][1]*M[2][1]*M[2][1]*M[3][1];
    C(25,4) = M[0][1]*M[0][1]*M[3][1]*M[3][1];
    C(26,4) = M[0][1]*M[1][1]*M[3][1]*M[3][1];
    C(27,4) = M[1][1]*M[1][1]*M[3][1]*M[3][1];
    C(28,4) = M[0][1]*M[2][1]*M[3][1]*M[3][1];
    C(29,4) = M[1][1]*M[2][1]*M[3][1]*M[3][1];
    C(30,4) = M[2][1]*M[2][1]*M[3][1]*M[3][1];
    C(31,4) = M[0][1]*M[3][1]*M[3][1]*M[3][1];
    C(32,4) = M[1][1]*M[3][1]*M[3][1]*M[3][1];
    C(33,4) = M[2][1]*M[3][1]*M[3][1]*M[3][1];
    C(34,4) = M[3][1]* M[3][1]* M[3][1]* M[3][1];
    C(0,5) = 6*M[0][1]*M[0][1]*M[0][2]*M[0][2];
    C(1,5) = 3*M[0][1]*M[0][1]*M[0][2]*M[1][2] + 3*M[0][1]*M[0][2]*M[0][2]*M[1][1];
    C(2,5) = M[0][1]*M[0][1]*M[1][2]*M[1][2]+ 4*M[0][1]*M[0][2]*M[1][1]*M[1][2] + M[0][2]*M[0][2]*M[1][1]*M[1][1];
    C(3,5) = 3*M[0][1]*M[1][1]*M[1][2]*M[1][2]+ 3*M[0][2]*M[1][1]*M[1][1]*M[1][2];
    C(4,5) = 6*M[1][1]*M[1][1]*M[1][2]*M[1][2];
    C(5,5) = 3*M[0][1]*M[0][1]*M[0][2]*M[2][2] + 3*M[0][1]*M[0][2]*M[0][2]*M[2][1];
    C(6,5) = M[0][1]*M[0][1]*M[1][2]*M[2][2] + 2*M[0][1]*M[0][2]*M[1][1]*M[2][2] + 2*M[0][1]*M[0][2]*M[1][2]*M[2][1] + M[0][2]*M[0][2]*M[1][1]*M[2][1];
    C(7,5) = 2*M[0][1]*M[1][1]*M[1][2]*M[2][2] + M[0][1]*M[1][2]*M[1][2]*M[2][1] + M[0][2]*M[1][1]*M[1][1]*M[2][2] + 2*M[0][2]*M[1][1]*M[1][2]*M[2][1];
    C(8,5) = 3*M[1][1]*M[1][1]*M[1][2]*M[2][2] + 3*M[1][1]*M[1][2]*M[1][2]*M[2][1];
    C(9,5) = M[0][1]*M[0][1]*M[2][2]*M[2][2]+ 4*M[0][1]*M[0][2]*M[2][1]*M[2][2] + M[0][2]*M[0][2]*M[2][1]*M[2][1];
    C(10,5) = M[0][1]*M[1][1]*M[2][2]*M[2][2]+ 2*M[0][1]*M[1][2]*M[2][1]*M[2][2] + 2*M[0][2]*M[1][1]*M[2][1]*M[2][2] + M[0][2]*M[1][2]*M[2][1]*M[2][1];
    C(11,5) = M[1][1]*M[1][1]*M[2][2]*M[2][2]+ 4*M[1][1]*M[1][2]*M[2][1]*M[2][2] + M[1][2]*M[1][2]*M[2][1]*M[2][1];
    C(12,5) = 3*M[0][1]*M[2][1]*M[2][2]*M[2][2]+ 3*M[0][2]*M[2][1]*M[2][1]*M[2][2];
    C(13,5) = 3*M[1][1]*M[2][1]*M[2][2]*M[2][2]+ 3*M[1][2]*M[2][1]*M[2][1]*M[2][2];
    C(14,5) = 6*M[2][1]*M[2][1]*M[2][2]*M[2][2];
    C(15,5) = 3*M[0][1]*M[0][1]*M[0][2]*M[3][2] + 3*M[0][1]*M[0][2]*M[0][2]*M[3][1];
    C(16,5) = M[0][1]*M[0][1]*M[1][2]*M[3][2] + 2*M[0][1]*M[0][2]*M[1][1]*M[3][2] + 2*M[0][1]*M[0][2]*M[1][2]*M[3][1] + M[0][2]*M[0][2]*M[1][1]*M[3][1];
    C(17,5) = 2*M[0][1]*M[1][1]*M[1][2]*M[3][2] + M[0][1]*M[1][2]*M[1][2]*M[3][1] + M[0][2]*M[1][1]*M[1][1]*M[3][2] + 2*M[0][2]*M[1][1]*M[1][2]*M[3][1];
    C(18,5) = 3*M[1][1]*M[1][1]*M[1][2]*M[3][2] + 3*M[1][1]*M[1][2]*M[1][2]*M[3][1];
    C(19,5) = M[0][1]*M[0][1]*M[2][2]*M[3][2] + 2*M[0][1]*M[0][2]*M[2][1]*M[3][2] + 2*M[0][1]*M[0][2]*M[2][2]*M[3][1] + M[0][2]*M[0][2]*M[2][1]*M[3][1];
    C(20,5) = M[0][1]*M[1][1]*M[2][2]*M[3][2] + M[0][1]*M[1][2]*M[2][1]*M[3][2] + M[0][1]*M[1][2]*M[2][2]*M[3][1] + M[0][2]*M[1][1]*M[2][1]*M[3][2] + M[0][2]*M[1][1]*M[2][2]*M[3][1] + M[0][2]*M[1][2]*M[2][1]*M[3][1];
    C(21,5) = M[1][1]*M[1][1]*M[2][2]*M[3][2] + 2*M[1][1]*M[1][2]*M[2][1]*M[3][2] + 2*M[1][1]*M[1][2]*M[2][2]*M[3][1] + M[1][2]*M[1][2]*M[2][1]*M[3][1];
    C(22,5) = 2*M[0][1]*M[2][1]*M[2][2]*M[3][2] + M[0][1]*M[2][2]*M[2][2]*M[3][1] + M[0][2]*M[2][1]*M[2][1]*M[3][2] + 2*M[0][2]*M[2][1]*M[2][2]*M[3][1];
    C(23,5) = 2*M[1][1]*M[2][1]*M[2][2]*M[3][2] + M[1][1]*M[2][2]*M[2][2]*M[3][1] + M[1][2]*M[2][1]*M[2][1]*M[3][2] + 2*M[1][2]*M[2][1]*M[2][2]*M[3][1];
    C(24,5) = 3*M[2][1]*M[2][1]*M[2][2]*M[3][2] + 3*M[2][1]*M[2][2]*M[2][2]*M[3][1];
    C(25,5) = M[0][1]*M[0][1]*M[3][2]*M[3][2]+ 4*M[0][1]*M[0][2]*M[3][1]*M[3][2] + M[0][2]*M[0][2]*M[3][1]*M[3][1];
    C(26,5) = M[0][1]*M[1][1]*M[3][2]*M[3][2]+ 2*M[0][1]*M[1][2]*M[3][1]*M[3][2] + 2*M[0][2]*M[1][1]*M[3][1]*M[3][2] + M[0][2]*M[1][2]*M[3][1]*M[3][1];
    C(27,5) = M[1][1]*M[1][1]*M[3][2]*M[3][2]+ 4*M[1][1]*M[1][2]*M[3][1]*M[3][2] + M[1][2]*M[1][2]*M[3][1]*M[3][1];
    C(28,5) = M[0][1]*M[2][1]*M[3][2]*M[3][2]+ 2*M[0][1]*M[2][2]*M[3][1]*M[3][2] + 2*M[0][2]*M[2][1]*M[3][1]*M[3][2] + M[0][2]*M[2][2]*M[3][1]*M[3][1];
    C(29,5) = M[1][1]*M[2][1]*M[3][2]*M[3][2]+ 2*M[1][1]*M[2][2]*M[3][1]*M[3][2] + 2*M[1][2]*M[2][1]*M[3][1]*M[3][2] + M[1][2]*M[2][2]*M[3][1]*M[3][1];
    C(30,5) = M[2][1]*M[2][1]*M[3][2]*M[3][2]+ 4*M[2][1]*M[2][2]*M[3][1]*M[3][2] + M[2][2]*M[2][2]*M[3][1]*M[3][1];
    C(31,5) = 3*M[0][1]*M[3][1]*M[3][2]*M[3][2]+ 3*M[0][2]*M[3][1]*M[3][1]*M[3][2];
    C(32,5) = 3*M[1][1]*M[3][1]*M[3][2]*M[3][2]+ 3*M[1][2]*M[3][1]*M[3][1]*M[3][2];
    C(33,5) = 3*M[2][1]*M[3][1]*M[3][2]*M[3][2]+ 3*M[2][2]*M[3][1]*M[3][1]*M[3][2];
    C(34,5) = 6*M[3][1]*M[3][1]*M[3][2]*M[3][2];
    C(0,6) = 6*M[0][1]*M[0][1]*M[0][3]*M[0][3];
    C(1,6) = 3*M[0][1]*M[0][1]*M[0][3]*M[1][3] + 3*M[0][1]*M[0][3]*M[0][3]*M[1][1];
    C(2,6) = M[0][1]*M[0][1]*M[1][3]*M[1][3]+ 4*M[0][1]*M[0][3]*M[1][1]*M[1][3] + M[0][3]*M[0][3]*M[1][1]*M[1][1];
    C(3,6) = 3*M[0][1]*M[1][1]*M[1][3]*M[1][3]+ 3*M[0][3]*M[1][1]*M[1][1]*M[1][3];
    C(4,6) = 6*M[1][1]*M[1][1]*M[1][3]*M[1][3];
    C(5,6) = 3*M[0][1]*M[0][1]*M[0][3]*M[2][3] + 3*M[0][1]*M[0][3]*M[0][3]*M[2][1];
    C(6,6) = M[0][1]*M[0][1]*M[1][3]*M[2][3] + 2*M[0][1]*M[0][3]*M[1][1]*M[2][3] + 2*M[0][1]*M[0][3]*M[1][3]*M[2][1] + M[0][3]*M[0][3]*M[1][1]*M[2][1];
    C(7,6) = 2*M[0][1]*M[1][1]*M[1][3]*M[2][3] + M[0][1]*M[1][3]*M[1][3]*M[2][1] + M[0][3]*M[1][1]*M[1][1]*M[2][3] + 2*M[0][3]*M[1][1]*M[1][3]*M[2][1];
    C(8,6) = 3*M[1][1]*M[1][1]*M[1][3]*M[2][3] + 3*M[1][1]*M[1][3]*M[1][3]*M[2][1];
    C(9,6) = M[0][1]*M[0][1]*M[2][3]*M[2][3]+ 4*M[0][1]*M[0][3]*M[2][1]*M[2][3] + M[0][3]*M[0][3]*M[2][1]*M[2][1];
    C(10,6) = M[0][1]*M[1][1]*M[2][3]*M[2][3]+ 2*M[0][1]*M[1][3]*M[2][1]*M[2][3] + 2*M[0][3]*M[1][1]*M[2][1]*M[2][3] + M[0][3]*M[1][3]*M[2][1]*M[2][1];
    C(11,6) = M[1][1]*M[1][1]*M[2][3]*M[2][3]+ 4*M[1][1]*M[1][3]*M[2][1]*M[2][3] + M[1][3]*M[1][3]*M[2][1]*M[2][1];
    C(12,6) = 3*M[0][1]*M[2][1]*M[2][3]*M[2][3]+ 3*M[0][3]*M[2][1]*M[2][1]*M[2][3];
    C(13,6) = 3*M[1][1]*M[2][1]*M[2][3]*M[2][3]+ 3*M[1][3]*M[2][1]*M[2][1]*M[2][3];
    C(14,6) = 6*M[2][1]*M[2][1]*M[2][3]*M[2][3];
    C(15,6) = 3*M[0][1]*M[0][1]*M[0][3]*M[3][3] + 3*M[0][1]*M[0][3]*M[0][3]*M[3][1];
    C(16,6) = M[0][1]*M[0][1]*M[1][3]*M[3][3] + 2*M[0][1]*M[0][3]*M[1][1]*M[3][3] + 2*M[0][1]*M[0][3]*M[1][3]*M[3][1] + M[0][3]*M[0][3]*M[1][1]*M[3][1];
    C(17,6) = 2*M[0][1]*M[1][1]*M[1][3]*M[3][3] + M[0][1]*M[1][3]*M[1][3]*M[3][1] + M[0][3]*M[1][1]*M[1][1]*M[3][3] + 2*M[0][3]*M[1][1]*M[1][3]*M[3][1];
    C(18,6) = 3*M[1][1]*M[1][1]*M[1][3]*M[3][3] + 3*M[1][1]*M[1][3]*M[1][3]*M[3][1];
    C(19,6) = M[0][1]*M[0][1]*M[2][3]*M[3][3] + 2*M[0][1]*M[0][3]*M[2][1]*M[3][3] + 2*M[0][1]*M[0][3]*M[2][3]*M[3][1] + M[0][3]*M[0][3]*M[2][1]*M[3][1];
    C(20,6) = M[0][1]*M[1][1]*M[2][3]*M[3][3] + M[0][1]*M[1][3]*M[2][1]*M[3][3] + M[0][1]*M[1][3]*M[2][3]*M[3][1] + M[0][3]*M[1][1]*M[2][1]*M[3][3] + M[0][3]*M[1][1]*M[2][3]*M[3][1] + M[0][3]*M[1][3]*M[2][1]*M[3][1];
    C(21,6) = M[1][1]*M[1][1]*M[2][3]*M[3][3] + 2*M[1][1]*M[1][3]*M[2][1]*M[3][3] + 2*M[1][1]*M[1][3]*M[2][3]*M[3][1] + M[1][3]*M[1][3]*M[2][1]*M[3][1];
    C(22,6) = 2*M[0][1]*M[2][1]*M[2][3]*M[3][3] + M[0][1]*M[2][3]*M[2][3]*M[3][1] + M[0][3]*M[2][1]*M[2][1]*M[3][3] + 2*M[0][3]*M[2][1]*M[2][3]*M[3][1];
    C(23,6) = 2*M[1][1]*M[2][1]*M[2][3]*M[3][3] + M[1][1]*M[2][3]*M[2][3]*M[3][1] + M[1][3]*M[2][1]*M[2][1]*M[3][3] + 2*M[1][3]*M[2][1]*M[2][3]*M[3][1];
    C(24,6) = 3*M[2][1]*M[2][1]*M[2][3]*M[3][3] + 3*M[2][1]*M[2][3]*M[2][3]*M[3][1];
    C(25,6) = M[0][1]*M[0][1]*M[3][3]*M[3][3]+ 4*M[0][1]*M[0][3]*M[3][1]*M[3][3] + M[0][3]*M[0][3]*M[3][1]*M[3][1];
    C(26,6) = M[0][1]*M[1][1]*M[3][3]*M[3][3]+ 2*M[0][1]*M[1][3]*M[3][1]*M[3][3] + 2*M[0][3]*M[1][1]*M[3][1]*M[3][3] + M[0][3]*M[1][3]*M[3][1]*M[3][1];
    C(27,6) = M[1][1]*M[1][1]*M[3][3]*M[3][3]+ 4*M[1][1]*M[1][3]*M[3][1]*M[3][3] + M[1][3]*M[1][3]*M[3][1]*M[3][1];
    C(28,6) = M[0][1]*M[2][1]*M[3][3]*M[3][3]+ 2*M[0][1]*M[2][3]*M[3][1]*M[3][3] + 2*M[0][3]*M[2][1]*M[3][1]*M[3][3] + M[0][3]*M[2][3]*M[3][1]*M[3][1];
    C(29,6) = M[1][1]*M[2][1]*M[3][3]*M[3][3]+ 2*M[1][1]*M[2][3]*M[3][1]*M[3][3] + 2*M[1][3]*M[2][1]*M[3][1]*M[3][3] + M[1][3]*M[2][3]*M[3][1]*M[3][1];
    C(30,6) = M[2][1]*M[2][1]*M[3][3]*M[3][3]+ 4*M[2][1]*M[2][3]*M[3][1]*M[3][3] + M[2][3]*M[2][3]*M[3][1]*M[3][1];
    C(31,6) = 3*M[0][1]*M[3][1]*M[3][3]*M[3][3]+ 3*M[0][3]*M[3][1]*M[3][1]*M[3][3];
    C(32,6) = 3*M[1][1]*M[3][1]*M[3][3]*M[3][3]+ 3*M[1][3]*M[3][1]*M[3][1]*M[3][3];
    C(33,6) = 3*M[2][1]*M[3][1]*M[3][3]*M[3][3]+ 3*M[2][3]*M[3][1]*M[3][1]*M[3][3];
    C(34,6) = 6*M[3][1]*M[3][1]*M[3][3]*M[3][3];
    C(0,7) = M[0][2]* M[0][2]* M[0][2]* M[0][2];
    C(1,7) = M[0][2]* M[0][2]* M[0][2]*M[1][2];
    C(2,7) = M[0][2]*M[0][2]*M[1][2]*M[1][2];
    C(3,7) = M[0][2]*M[1][2]*M[1][2]*M[1][2];
    C(4,7) = M[1][2]* M[1][2]* M[1][2]* M[1][2];
    C(5,7) = M[0][2]* M[0][2]* M[0][2]*M[2][2];
    C(6,7) = M[0][2]*M[0][2]*M[1][2]*M[2][2];
    C(7,7) = M[0][2]*M[1][2]*M[1][2]*M[2][2];
    C(8,7) = M[1][2]*M[1][2]*M[1][2]*M[2][2];
    C(9,7) = M[0][2]*M[0][2]*M[2][2]*M[2][2];
    C(10,7) = M[0][2]*M[1][2]*M[2][2]*M[2][2];
    C(11,7) = M[1][2]*M[1][2]*M[2][2]*M[2][2];
    C(12,7) = M[0][2]*M[2][2]*M[2][2]*M[2][2];
    C(13,7) = M[1][2]*M[2][2]*M[2][2]*M[2][2];
    C(14,7) = M[2][2]* M[2][2]* M[2][2]* M[2][2];
    C(15,7) = M[0][2]* M[0][2]* M[0][2]*M[3][2];
    C(16,7) = M[0][2]*M[0][2]*M[1][2]*M[3][2];
    C(17,7) = M[0][2]*M[1][2]*M[1][2]*M[3][2];
    C(18,7) = M[1][2]*M[1][2]*M[1][2]*M[3][2];
    C(19,7) = M[0][2]*M[0][2]*M[2][2]*M[3][2];
    C(20,7) = M[0][2]*M[1][2]*M[2][2]*M[3][2];
    C(21,7) = M[1][2]*M[1][2]*M[2][2]*M[3][2];
    C(22,7) = M[0][2]*M[2][2]*M[2][2]*M[3][2];
    C(23,7) = M[1][2]*M[2][2]*M[2][2]*M[3][2];
    C(24,7) = M[2][2]*M[2][2]*M[2][2]*M[3][2];
    C(25,7) = M[0][2]*M[0][2]*M[3][2]*M[3][2];
    C(26,7) = M[0][2]*M[1][2]*M[3][2]*M[3][2];
    C(27,7) = M[1][2]*M[1][2]*M[3][2]*M[3][2];
    C(28,7) = M[0][2]*M[2][2]*M[3][2]*M[3][2];
    C(29,7) = M[1][2]*M[2][2]*M[3][2]*M[3][2];
    C(30,7) = M[2][2]*M[2][2]*M[3][2]*M[3][2];
    C(31,7) = M[0][2]*M[3][2]*M[3][2]*M[3][2];
    C(32,7) = M[1][2]*M[3][2]*M[3][2]*M[3][2];
    C(33,7) = M[2][2]*M[3][2]*M[3][2]*M[3][2];
    C(34,7) = M[3][2]* M[3][2]* M[3][2]* M[3][2];
    C(0,8) = 6*M[0][2]*M[0][2]*M[0][3]*M[0][3];
    C(1,8) = 3*M[0][2]*M[0][2]*M[0][3]*M[1][3] + 3*M[0][2]*M[0][3]*M[0][3]*M[1][2];
    C(2,8) = M[0][2]*M[0][2]*M[1][3]*M[1][3]+ 4*M[0][2]*M[0][3]*M[1][2]*M[1][3] + M[0][3]*M[0][3]*M[1][2]*M[1][2];
    C(3,8) = 3*M[0][2]*M[1][2]*M[1][3]*M[1][3]+ 3*M[0][3]*M[1][2]*M[1][2]*M[1][3];
    C(4,8) = 6*M[1][2]*M[1][2]*M[1][3]*M[1][3];
    C(5,8) = 3*M[0][2]*M[0][2]*M[0][3]*M[2][3] + 3*M[0][2]*M[0][3]*M[0][3]*M[2][2];
    C(6,8) = M[0][2]*M[0][2]*M[1][3]*M[2][3] + 2*M[0][2]*M[0][3]*M[1][2]*M[2][3] + 2*M[0][2]*M[0][3]*M[1][3]*M[2][2] + M[0][3]*M[0][3]*M[1][2]*M[2][2];
    C(7,8) = 2*M[0][2]*M[1][2]*M[1][3]*M[2][3] + M[0][2]*M[1][3]*M[1][3]*M[2][2] + M[0][3]*M[1][2]*M[1][2]*M[2][3] + 2*M[0][3]*M[1][2]*M[1][3]*M[2][2];
    C(8,8) = 3*M[1][2]*M[1][2]*M[1][3]*M[2][3] + 3*M[1][2]*M[1][3]*M[1][3]*M[2][2];
    C(9,8) = M[0][2]*M[0][2]*M[2][3]*M[2][3]+ 4*M[0][2]*M[0][3]*M[2][2]*M[2][3] + M[0][3]*M[0][3]*M[2][2]*M[2][2];
    C(10,8) = M[0][2]*M[1][2]*M[2][3]*M[2][3]+ 2*M[0][2]*M[1][3]*M[2][2]*M[2][3] + 2*M[0][3]*M[1][2]*M[2][2]*M[2][3] + M[0][3]*M[1][3]*M[2][2]*M[2][2];
    C(11,8) = M[1][2]*M[1][2]*M[2][3]*M[2][3]+ 4*M[1][2]*M[1][3]*M[2][2]*M[2][3] + M[1][3]*M[1][3]*M[2][2]*M[2][2];
    C(12,8) = 3*M[0][2]*M[2][2]*M[2][3]*M[2][3]+ 3*M[0][3]*M[2][2]*M[2][2]*M[2][3];
    C(13,8) = 3*M[1][2]*M[2][2]*M[2][3]*M[2][3]+ 3*M[1][3]*M[2][2]*M[2][2]*M[2][3];
    C(14,8) = 6*M[2][2]*M[2][2]*M[2][3]*M[2][3];
    C(15,8) = 3*M[0][2]*M[0][2]*M[0][3]*M[3][3] + 3*M[0][2]*M[0][3]*M[0][3]*M[3][2];
    C(16,8) = M[0][2]*M[0][2]*M[1][3]*M[3][3] + 2*M[0][2]*M[0][3]*M[1][2]*M[3][3] + 2*M[0][2]*M[0][3]*M[1][3]*M[3][2] + M[0][3]*M[0][3]*M[1][2]*M[3][2];
    C(17,8) = 2*M[0][2]*M[1][2]*M[1][3]*M[3][3] + M[0][2]*M[1][3]*M[1][3]*M[3][2] + M[0][3]*M[1][2]*M[1][2]*M[3][3] + 2*M[0][3]*M[1][2]*M[1][3]*M[3][2];
    C(18,8) = 3*M[1][2]*M[1][2]*M[1][3]*M[3][3] + 3*M[1][2]*M[1][3]*M[1][3]*M[3][2];
    C(19,8) = M[0][2]*M[0][2]*M[2][3]*M[3][3] + 2*M[0][2]*M[0][3]*M[2][2]*M[3][3] + 2*M[0][2]*M[0][3]*M[2][3]*M[3][2] + M[0][3]*M[0][3]*M[2][2]*M[3][2];
    C(20,8) = M[0][2]*M[1][2]*M[2][3]*M[3][3] + M[0][2]*M[1][3]*M[2][2]*M[3][3] + M[0][2]*M[1][3]*M[2][3]*M[3][2] + M[0][3]*M[1][2]*M[2][2]*M[3][3] + M[0][3]*M[1][2]*M[2][3]*M[3][2] + M[0][3]*M[1][3]*M[2][2]*M[3][2];
    C(21,8) = M[1][2]*M[1][2]*M[2][3]*M[3][3] + 2*M[1][2]*M[1][3]*M[2][2]*M[3][3] + 2*M[1][2]*M[1][3]*M[2][3]*M[3][2] + M[1][3]*M[1][3]*M[2][2]*M[3][2];
    C(22,8) = 2*M[0][2]*M[2][2]*M[2][3]*M[3][3] + M[0][2]*M[2][3]*M[2][3]*M[3][2] + M[0][3]*M[2][2]*M[2][2]*M[3][3] + 2*M[0][3]*M[2][2]*M[2][3]*M[3][2];
    C(23,8) = 2*M[1][2]*M[2][2]*M[2][3]*M[3][3] + M[1][2]*M[2][3]*M[2][3]*M[3][2] + M[1][3]*M[2][2]*M[2][2]*M[3][3] + 2*M[1][3]*M[2][2]*M[2][3]*M[3][2];
    C(24,8) = 3*M[2][2]*M[2][2]*M[2][3]*M[3][3] + 3*M[2][2]*M[2][3]*M[2][3]*M[3][2];
    C(25,8) = M[0][2]*M[0][2]*M[3][3]*M[3][3]+ 4*M[0][2]*M[0][3]*M[3][2]*M[3][3] + M[0][3]*M[0][3]*M[3][2]*M[3][2];
    C(26,8) = M[0][2]*M[1][2]*M[3][3]*M[3][3]+ 2*M[0][2]*M[1][3]*M[3][2]*M[3][3] + 2*M[0][3]*M[1][2]*M[3][2]*M[3][3] + M[0][3]*M[1][3]*M[3][2]*M[3][2];
    C(27,8) = M[1][2]*M[1][2]*M[3][3]*M[3][3]+ 4*M[1][2]*M[1][3]*M[3][2]*M[3][3] + M[1][3]*M[1][3]*M[3][2]*M[3][2];
    C(28,8) = M[0][2]*M[2][2]*M[3][3]*M[3][3]+ 2*M[0][2]*M[2][3]*M[3][2]*M[3][3] + 2*M[0][3]*M[2][2]*M[3][2]*M[3][3] + M[0][3]*M[2][3]*M[3][2]*M[3][2];
    C(29,8) = M[1][2]*M[2][2]*M[3][3]*M[3][3]+ 2*M[1][2]*M[2][3]*M[3][2]*M[3][3] + 2*M[1][3]*M[2][2]*M[3][2]*M[3][3] + M[1][3]*M[2][3]*M[3][2]*M[3][2];
    C(30,8) = M[2][2]*M[2][2]*M[3][3]*M[3][3]+ 4*M[2][2]*M[2][3]*M[3][2]*M[3][3] + M[2][3]*M[2][3]*M[3][2]*M[3][2];
    C(31,8) = 3*M[0][2]*M[3][2]*M[3][3]*M[3][3]+ 3*M[0][3]*M[3][2]*M[3][2]*M[3][3];
    C(32,8) = 3*M[1][2]*M[3][2]*M[3][3]*M[3][3]+ 3*M[1][3]*M[3][2]*M[3][2]*M[3][3];
    C(33,8) = 3*M[2][2]*M[3][2]*M[3][3]*M[3][3]+ 3*M[2][3]*M[3][2]*M[3][2]*M[3][3];
    C(34,8) = 6*M[3][2]*M[3][2]*M[3][3]*M[3][3];
    C(0,9) = M[0][3]* M[0][3]* M[0][3]* M[0][3];
    C(1,9) = M[0][3]* M[0][3]* M[0][3]*M[1][3];
    C(2,9) = M[0][3]*M[0][3]*M[1][3]*M[1][3];
    C(3,9) = M[0][3]*M[1][3]*M[1][3]*M[1][3];
    C(4,9) = M[1][3]* M[1][3]* M[1][3]* M[1][3];
    C(5,9) = M[0][3]* M[0][3]* M[0][3]*M[2][3];
    C(6,9) = M[0][3]*M[0][3]*M[1][3]*M[2][3];
    C(7,9) = M[0][3]*M[1][3]*M[1][3]*M[2][3];
    C(8,9) = M[1][3]*M[1][3]*M[1][3]*M[2][3];
    C(9,9) = M[0][3]*M[0][3]*M[2][3]*M[2][3];
    C(10,9) = M[0][3]*M[1][3]*M[2][3]*M[2][3];
    C(11,9) = M[1][3]*M[1][3]*M[2][3]*M[2][3];
    C(12,9) = M[0][3]*M[2][3]*M[2][3]*M[2][3];
    C(13,9) = M[1][3]*M[2][3]*M[2][3]*M[2][3];
    C(14,9) = M[2][3]* M[2][3]* M[2][3]* M[2][3];
    C(15,9) = M[0][3]* M[0][3]* M[0][3]*M[3][3];
    C(16,9) = M[0][3]*M[0][3]*M[1][3]*M[3][3];
    C(17,9) = M[0][3]*M[1][3]*M[1][3]*M[3][3];
    C(18,9) = M[1][3]*M[1][3]*M[1][3]*M[3][3];
    C(19,9) = M[0][3]*M[0][3]*M[2][3]*M[3][3];
    C(20,9) = M[0][3]*M[1][3]*M[2][3]*M[3][3];
    C(21,9) = M[1][3]*M[1][3]*M[2][3]*M[3][3];
    C(22,9) = M[0][3]*M[2][3]*M[2][3]*M[3][3];
    C(23,9) = M[1][3]*M[2][3]*M[2][3]*M[3][3];
    C(24,9) = M[2][3]*M[2][3]*M[2][3]*M[3][3];
    C(25,9) = M[0][3]*M[0][3]*M[3][3]*M[3][3];
    C(26,9) = M[0][3]*M[1][3]*M[3][3]*M[3][3];
    C(27,9) = M[1][3]*M[1][3]*M[3][3]*M[3][3];
    C(28,9) = M[0][3]*M[2][3]*M[3][3]*M[3][3];
    C(29,9) = M[1][3]*M[2][3]*M[3][3]*M[3][3];
    C(30,9) = M[2][3]*M[2][3]*M[3][3]*M[3][3];
    C(31,9) = M[0][3]*M[3][3]*M[3][3]*M[3][3];
    C(32,9) = M[1][3]*M[3][3]*M[3][3]*M[3][3];
    C(33,9) = M[2][3]*M[3][3]*M[3][3]*M[3][3];
    C(34,9) = M[3][3]* M[3][3]* M[3][3]* M[3][3];

    return _C;
}


// func definition
py::array_t<double> calc_Bingham_4thMoment(py::array_t<double> binghamparam_orthomat, 
                                           py::array_t<double> ddnc){
    // eigenvalues to ddnc
    // std::array<double, 4> eigvals = {*binghamparam_eigvals.data(0),
    //                                  *binghamparam_eigvals.data(1),
    //                                  *binghamparam_eigvals.data(2),
    //                                  *binghamparam_eigvals.data(3)};
    // py::array_t<double> ddnc = calc_10D_ddnc(eigvals, N_nc);
    double nc = *ddnc.data(0) + *ddnc.data(4) + *ddnc.data(7) + *ddnc.data(9) + 2. * (*ddnc.data(1) + *ddnc.data(2) + *ddnc.data(3) + *ddnc.data(5) + *ddnc.data(6) + *ddnc.data(8));

    // coefficient matrix
    py::array_t<double> C = calc_4thmoment_coeff(binghamparam_orthomat);
    
    // calculate 4th moments
    py::array_t<double> _E_q4th(35);
    auto E_q4th = _E_q4th.mutable_unchecked<1>();
    double tmp;
    // dot product: C . ddnc
    for (int i=0; i<35; i++){
        tmp = 0;
        for (int j=0; j<10; j++){
            tmp += *C.data(i,j) * *ddnc.data(j);
        }
        E_q4th(i) = tmp / nc;
    }
    return _E_q4th;
}


// func definition
py::array_t<double> calc_covQ_from_4thmoment(py::array_t<double> E_q4th){
    // initialize;
    py::array_t<double> _Cov({4,4});
    auto Cov = _Cov.mutable_unchecked<2>();

    // expectation of quaternions;
    // fourth moments;
    double E_q4000 = *E_q4th.data(0);
    double E_q3100 = *E_q4th.data(1);
    double E_q2200 = *E_q4th.data(2);
    double E_q1300 = *E_q4th.data(3);
    double E_q0400 = *E_q4th.data(4);
    double E_q3010 = *E_q4th.data(5);
    double E_q2110 = *E_q4th.data(6);
    double E_q1210 = *E_q4th.data(7);
    double E_q0310 = *E_q4th.data(8);
    double E_q2020 = *E_q4th.data(9);
    double E_q1120 = *E_q4th.data(10);
    double E_q0220 = *E_q4th.data(11);
    double E_q1030 = *E_q4th.data(12);
    double E_q0130 = *E_q4th.data(13);
    double E_q0040 = *E_q4th.data(14);
    double E_q3001 = *E_q4th.data(15);
    double E_q2101 = *E_q4th.data(16);
    double E_q1201 = *E_q4th.data(17);
    double E_q0301 = *E_q4th.data(18);
    double E_q2011 = *E_q4th.data(19);
    double E_q1111 = *E_q4th.data(20);
    double E_q0211 = *E_q4th.data(21);
    double E_q1021 = *E_q4th.data(22);
    double E_q0121 = *E_q4th.data(23);
    double E_q0031 = *E_q4th.data(24);
    double E_q2002 = *E_q4th.data(25);
    double E_q1102 = *E_q4th.data(26);
    double E_q0202 = *E_q4th.data(27);
    double E_q1012 = *E_q4th.data(28);
    double E_q0112 = *E_q4th.data(29);
    double E_q0022 = *E_q4th.data(30);
    double E_q1003 = *E_q4th.data(31);
    double E_q0103 = *E_q4th.data(32);
    double E_q0013 = *E_q4th.data(33);
    double E_q0004 = *E_q4th.data(34);
    // second moments
    double trace = (E_q4000 + E_q2200 + E_q2020 + E_q2002)  // Cov[0,0]
                 + (E_q2200 + E_q0400 + E_q0220 + E_q0202)  // Cov[1,1]
                 + (E_q2020 + E_q0220 + E_q0040 + E_q0022)  // Cov[2,2]
                 + (E_q2002 + E_q0202 + E_q0022 + E_q0004); // Cov[3,3]
    Cov(0,0) = (E_q4000 + E_q2200 + E_q2020 + E_q2002) / trace;
    Cov(0,1) = (E_q3100 + E_q1300 + E_q1120 + E_q1102) / trace;
    Cov(1,1) = (E_q2200 + E_q0400 + E_q0220 + E_q0202) / trace;
    Cov(0,2) = (E_q3010 + E_q1210 + E_q1030 + E_q1012) / trace;
    Cov(1,2) = (E_q2110 + E_q0310 + E_q0130 + E_q0112) / trace;
    Cov(2,2) = (E_q2020 + E_q0220 + E_q0040 + E_q0022) / trace;
    Cov(0,3) = (E_q3001 + E_q1201 + E_q1021 + E_q1003) / trace;
    Cov(1,3) = (E_q2101 + E_q0301 + E_q0121 + E_q0103) / trace;
    Cov(2,3) = (E_q2011 + E_q0211 + E_q0031 + E_q0013) / trace;
    Cov(3,3) = (E_q2002 + E_q0202 + E_q0022 + E_q0004) / trace;

    // set lower-triangular values
    Cov(1,0) = Cov(0,1);
    Cov(2,0) = Cov(0,2);
    Cov(3,0) = Cov(0,3);
    Cov(2,1) = Cov(1,2);
    Cov(3,1) = Cov(1,3);
    Cov(3,2) = Cov(2,3);

    return _Cov;
}


// func definition
py::array_t<double> calc_nextq_Cov(py::array_t<double> Cov_currentq, py::array_t<double> Cov_noise){
    // alias
    std::array<std::array<double, 4>, 4> Cq;
    std::array<std::array<double, 4>, 4> Cv;
    for (int i=0; i<4; i++){
        for (int j=0; j<4; j++){
            Cq[i][j] = *Cov_currentq.data(i,j);
            Cv[i][j] = *Cov_noise.data(i,j);
        }
    }

    // initialize;
    py::array_t<double> _Cnextq({4,4});
    auto Cnextq = _Cnextq.mutable_unchecked<2>();

    // set diagonal elements;
    Cnextq(0,0) = Cq[0][0]*Cv[0][0] - 2*Cq[1][0]*Cv[1][0] + Cq[1][1]*Cv[1][1] - 2*Cq[2][0]*Cv[2][0] + 2*Cq[2][1]*Cv[2][1] + Cq[2][2]*Cv[2][2] - 2*Cq[3][0]*Cv[3][0] + 2*Cq[3][1]*Cv[3][1] + 2*Cq[3][2]*Cv[3][2] + Cq[3][3]*Cv[3][3];
    Cnextq(1,1) = Cq[0][0]*Cv[1][1] + 2*Cq[1][0]*Cv[1][0] + Cq[1][1]*Cv[0][0] + 2*Cq[2][0]*Cv[3][1] + 2*Cq[2][1]*Cv[3][0] + Cq[2][2]*Cv[3][3] - 2*Cq[3][0]*Cv[2][1] - 2*Cq[3][1]*Cv[2][0] - 2*Cq[3][2]*Cv[3][2] + Cq[3][3]*Cv[2][2];
    Cnextq(2,2) = Cq[0][0]*Cv[2][2] - 2*Cq[1][0]*Cv[3][2] + Cq[1][1]*Cv[3][3] + 2*Cq[2][0]*Cv[2][0] - 2*Cq[2][1]*Cv[3][0] + Cq[2][2]*Cv[0][0] + 2*Cq[3][0]*Cv[2][1] - 2*Cq[3][1]*Cv[3][1] + 2*Cq[3][2]*Cv[1][0] + Cq[3][3]*Cv[1][1];
    Cnextq(3,3) = Cq[0][0]*Cv[3][3] + 2*Cq[1][0]*Cv[3][2] + Cq[1][1]*Cv[2][2] - 2*Cq[2][0]*Cv[3][1] - 2*Cq[2][1]*Cv[2][1] + Cq[2][2]*Cv[1][1] + 2*Cq[3][0]*Cv[3][0] + 2*Cq[3][1]*Cv[2][0] - 2*Cq[3][2]*Cv[1][0] + Cq[3][3]*Cv[0][0];

    // set non-diagonal elements;
    Cnextq(0,1) = Cq[0][0]*Cv[1][0] + Cq[1][0]*Cv[0][0] - Cq[1][0]*Cv[1][1] - Cq[1][1]*Cv[1][0] - Cq[2][0]*Cv[2][1] + Cq[2][0]*Cv[3][0] - Cq[2][1]*Cv[2][0] - Cq[2][1]*Cv[3][1] - Cq[2][2]*Cv[3][2] - Cq[3][0]*Cv[2][0] - Cq[3][0]*Cv[3][1] + Cq[3][1]*Cv[2][1] - Cq[3][1]*Cv[3][0] + Cq[3][2]*Cv[2][2] - Cq[3][2]*Cv[3][3] + Cq[3][3]*Cv[3][2];
    Cnextq(0,2) = Cq[0][0]*Cv[2][0] - Cq[1][0]*Cv[2][1] - Cq[1][0]*Cv[3][0] + Cq[1][1]*Cv[3][1] + Cq[2][0]*Cv[0][0] - Cq[2][0]*Cv[2][2] - Cq[2][1]*Cv[1][0] + Cq[2][1]*Cv[3][2] - Cq[2][2]*Cv[2][0] + Cq[3][0]*Cv[1][0] - Cq[3][0]*Cv[3][2] - Cq[3][1]*Cv[1][1] + Cq[3][1]*Cv[3][3] - Cq[3][2]*Cv[2][1] - Cq[3][2]*Cv[3][0] - Cq[3][3]*Cv[3][1];
    Cnextq(0,3) = Cq[0][0]*Cv[3][0] + Cq[1][0]*Cv[2][0] - Cq[1][0]*Cv[3][1] - Cq[1][1]*Cv[2][1] - Cq[2][0]*Cv[1][0] - Cq[2][0]*Cv[3][2] + Cq[2][1]*Cv[1][1] - Cq[2][1]*Cv[2][2] + Cq[2][2]*Cv[2][1] + Cq[3][0]*Cv[0][0] - Cq[3][0]*Cv[3][3] - Cq[3][1]*Cv[1][0] - Cq[3][1]*Cv[3][2] - Cq[3][2]*Cv[2][0] + Cq[3][2]*Cv[3][1] - Cq[3][3]*Cv[3][0];
    Cnextq(1,2) = Cq[0][0]*Cv[2][1] + Cq[1][0]*Cv[2][0] - Cq[1][0]*Cv[3][1] - Cq[1][1]*Cv[3][0] + Cq[2][0]*Cv[1][0] + Cq[2][0]*Cv[3][2] + Cq[2][1]*Cv[0][0] - Cq[2][1]*Cv[3][3] + Cq[2][2]*Cv[3][0] + Cq[3][0]*Cv[1][1] - Cq[3][0]*Cv[2][2] + Cq[3][1]*Cv[1][0] + Cq[3][1]*Cv[3][2] - Cq[3][2]*Cv[2][0] + Cq[3][2]*Cv[3][1] - Cq[3][3]*Cv[2][1];
    Cnextq(1,3) = Cq[0][0]*Cv[3][1] + Cq[1][0]*Cv[2][1] + Cq[1][0]*Cv[3][0] + Cq[1][1]*Cv[2][0] - Cq[2][0]*Cv[1][1] + Cq[2][0]*Cv[3][3] - Cq[2][1]*Cv[1][0] + Cq[2][1]*Cv[3][2] - Cq[2][2]*Cv[3][1] + Cq[3][0]*Cv[1][0] - Cq[3][0]*Cv[3][2] + Cq[3][1]*Cv[0][0] - Cq[3][1]*Cv[2][2] + Cq[3][2]*Cv[2][1] + Cq[3][2]*Cv[3][0] - Cq[3][3]*Cv[2][0];
    Cnextq(2,3) = Cq[0][0]*Cv[3][2] + Cq[1][0]*Cv[2][2] - Cq[1][0]*Cv[3][3] - Cq[1][1]*Cv[3][2] - Cq[2][0]*Cv[2][1] + Cq[2][0]*Cv[3][0] + Cq[2][1]*Cv[2][0] + Cq[2][1]*Cv[3][1] - Cq[2][2]*Cv[1][0] + Cq[3][0]*Cv[2][0] + Cq[3][0]*Cv[3][1] + Cq[3][1]*Cv[2][1] - Cq[3][1]*Cv[3][0] + Cq[3][2]*Cv[0][0] - Cq[3][2]*Cv[1][1] + Cq[3][3]*Cv[1][0];

    // set symmetry elements;
    Cnextq(1,0) = Cnextq(0,1);
    Cnextq(2,0) = Cnextq(0,2);
    Cnextq(3,0) = Cnextq(0,3);
    Cnextq(2,1) = Cnextq(1,2);
    Cnextq(3,1) = Cnextq(1,3);
    Cnextq(3,2) = Cnextq(2,3);

    return _Cnextq;
}


// func definition
py::array_t<double> calc_rotation_prediction_noise(
    py::array_t<double> E_q4th,
    py::array_t<double> gyro_i,
    py::array_t<double> gyro_j,
    py::array_t<double> gyro_noisecov_i,
    py::array_t<double> gyro_noisecov_j,
    double dt){

    // expectation of gyro
    std::array<double, 3> E_wi;
    std::array<double, 3> E_wj;
    std::array<std::array<double, 3>, 3> E_wiwiT;
    std::array<std::array<double, 3>, 3> E_wjwjT;

    for (int k=0; k<3; k++){
        E_wi[k] = *gyro_i.data(k);
        E_wj[k] = *gyro_j.data(k);
        for (int l=0; l<3; l++){
            E_wiwiT[k][l] = *gyro_noisecov_i.data(k,l) + *gyro_i.data(k) * *gyro_i.data(l);
            E_wjwjT[k][l] = *gyro_noisecov_j.data(k,l) + *gyro_j.data(k) * *gyro_j.data(l);
        }
    }

    // expectation of quaternions;
    // fourth moments;
    double E_q4000 = *E_q4th.data(0);
    double E_q3100 = *E_q4th.data(1);
    double E_q2200 = *E_q4th.data(2);
    double E_q1300 = *E_q4th.data(3);
    double E_q0400 = *E_q4th.data(4);
    double E_q3010 = *E_q4th.data(5);
    double E_q2110 = *E_q4th.data(6);
    double E_q1210 = *E_q4th.data(7);
    double E_q0310 = *E_q4th.data(8);
    double E_q2020 = *E_q4th.data(9);
    double E_q1120 = *E_q4th.data(10);
    double E_q0220 = *E_q4th.data(11);
    double E_q1030 = *E_q4th.data(12);
    double E_q0130 = *E_q4th.data(13);
    double E_q0040 = *E_q4th.data(14);
    double E_q3001 = *E_q4th.data(15);
    double E_q2101 = *E_q4th.data(16);
    double E_q1201 = *E_q4th.data(17);
    double E_q0301 = *E_q4th.data(18);
    double E_q2011 = *E_q4th.data(19);
    double E_q1111 = *E_q4th.data(20);
    double E_q0211 = *E_q4th.data(21);
    double E_q1021 = *E_q4th.data(22);
    double E_q0121 = *E_q4th.data(23);
    double E_q0031 = *E_q4th.data(24);
    double E_q2002 = *E_q4th.data(25);
    double E_q1102 = *E_q4th.data(26);
    double E_q0202 = *E_q4th.data(27);
    double E_q1012 = *E_q4th.data(28);
    double E_q0112 = *E_q4th.data(29);
    double E_q0022 = *E_q4th.data(30);
    double E_q1003 = *E_q4th.data(31);
    double E_q0103 = *E_q4th.data(32);
    double E_q0013 = *E_q4th.data(33);
    double E_q0004 = *E_q4th.data(34);
    // second moments;
    py::array_t<double> covQ = calc_covQ_from_4thmoment(E_q4th);
    double E_q2000 = *covQ.data(0,0);
    double E_q1100 = *covQ.data(0,1);
    double E_q0200 = *covQ.data(1,1);
    double E_q1010 = *covQ.data(0,2);
    double E_q0110 = *covQ.data(1,2);
    double E_q0020 = *covQ.data(2,2);
    double E_q1001 = *covQ.data(0,3);
    double E_q0101 = *covQ.data(1,3);
    double E_q0011 = *covQ.data(2,3);
    double E_q0002 = *covQ.data(3,3);

    // moments
    std::array<double, 3> Ci;
    std::array<std::array<double, 3>, 3> Cij;

    // first moment
    Ci[0] = E_q0002*E_wi[0] + E_q0020*E_wi[0] - 2*E_q0101*E_wi[2] - 2*E_q0110*E_wi[1] - E_q0200*E_wi[0] - 2*E_q1001*E_wi[1] + 2*E_q1010*E_wi[2] - E_q2000*E_wi[0] + E_wj[0];
    Ci[1] = E_q0002*E_wi[1] - 2*E_q0011*E_wi[2] - E_q0020*E_wi[1] - 2*E_q0110*E_wi[0] + E_q0200*E_wi[1] + 2*E_q1001*E_wi[0] - 2*E_q1100*E_wi[2] - E_q2000*E_wi[1] + E_wj[1];
    Ci[2] = -E_q0002*E_wi[2] - 2*E_q0011*E_wi[1] + E_q0020*E_wi[2] - 2*E_q0101*E_wi[0] + E_q0200*E_wi[2] - 2*E_q1010*E_wi[0] + 2*E_q1100*E_wi[1] - E_q2000*E_wi[2] + E_wj[2];

    // second moment
    Cij[0][0] = 2*E_q0002*E_wi[0]*E_wj[0] + E_q0004*E_wiwiT[0][0] + 2*E_q0020*E_wi[0]*E_wj[0] + 2*E_q0022*E_wiwiT[0][0] + E_q0040*E_wiwiT[0][0] - 4*E_q0101*E_wi[2]*E_wj[0] - 4*E_q0103*E_wiwiT[0][2] - 4*E_q0110*E_wi[1]*E_wj[0] - 4*E_q0112*E_wiwiT[0][1] - 4*E_q0121*E_wiwiT[0][2] - 4*E_q0130*E_wiwiT[0][1] - 2*E_q0200*E_wi[0]*E_wj[0] - 2*E_q0202*E_wiwiT[0][0] + 4*E_q0202*E_wiwiT[2][2] + 8*E_q0211*E_wiwiT[1][2] - 2*E_q0220*E_wiwiT[0][0] + 4*E_q0220*E_wiwiT[1][1] + 4*E_q0301*E_wiwiT[0][2] + 4*E_q0310*E_wiwiT[0][1] + E_q0400*E_wiwiT[0][0] - 4*E_q1001*E_wi[1]*E_wj[0] - 4*E_q1003*E_wiwiT[0][1] + 4*E_q1010*E_wi[2]*E_wj[0] + 4*E_q1012*E_wiwiT[0][2] - 4*E_q1021*E_wiwiT[0][1] + 4*E_q1030*E_wiwiT[0][2] + 8*E_q1102*E_wiwiT[1][2] + 8*E_q1111*E_wiwiT[1][1] - 8*E_q1111*E_wiwiT[2][2] - 8*E_q1120*E_wiwiT[1][2] + 4*E_q1201*E_wiwiT[0][1] - 4*E_q1210*E_wiwiT[0][2] - 2*E_q2000*E_wi[0]*E_wj[0] - 2*E_q2002*E_wiwiT[0][0] + 4*E_q2002*E_wiwiT[1][1] - 8*E_q2011*E_wiwiT[1][2] - 2*E_q2020*E_wiwiT[0][0] + 4*E_q2020*E_wiwiT[2][2] + 4*E_q2101*E_wiwiT[0][2] + 4*E_q2110*E_wiwiT[0][1] + 2*E_q2200*E_wiwiT[0][0] + 4*E_q3001*E_wiwiT[0][1] - 4*E_q3010*E_wiwiT[0][2] + E_q4000*E_wiwiT[0][0] + E_wjwjT[0][0];
    Cij[0][1] = E_q0002*E_wi[0]*E_wj[1] + E_q0002*E_wi[1]*E_wj[0] + E_q0004*E_wiwiT[0][1] - 2*E_q0011*E_wi[2]*E_wj[0] - 2*E_q0013*E_wiwiT[0][2] + E_q0020*E_wi[0]*E_wj[1] - E_q0020*E_wi[1]*E_wj[0] - 2*E_q0031*E_wiwiT[0][2] - E_q0040*E_wiwiT[0][1] - 2*E_q0101*E_wi[2]*E_wj[1] - 2*E_q0103*E_wiwiT[1][2] - 2*E_q0110*E_wi[0]*E_wj[0] - 2*E_q0110*E_wi[1]*E_wj[1] - 2*E_q0112*E_wiwiT[0][0] - 2*E_q0112*E_wiwiT[1][1] + 4*E_q0112*E_wiwiT[2][2] + 6*E_q0121*E_wiwiT[1][2] - 2*E_q0130*E_wiwiT[0][0] + 2*E_q0130*E_wiwiT[1][1] - E_q0200*E_wi[0]*E_wj[1] + E_q0200*E_wi[1]*E_wj[0] + 6*E_q0211*E_wiwiT[0][2] + 6*E_q0220*E_wiwiT[0][1] - 2*E_q0301*E_wiwiT[1][2] + 2*E_q0310*E_wiwiT[0][0] - 2*E_q0310*E_wiwiT[1][1] - E_q0400*E_wiwiT[0][1] + 2*E_q1001*E_wi[0]*E_wj[0] - 2*E_q1001*E_wi[1]*E_wj[1] + 2*E_q1003*E_wiwiT[0][0] - 2*E_q1003*E_wiwiT[1][1] + 2*E_q1010*E_wi[2]*E_wj[1] + 6*E_q1012*E_wiwiT[1][2] + 2*E_q1021*E_wiwiT[0][0] + 2*E_q1021*E_wiwiT[1][1] - 4*E_q1021*E_wiwiT[2][2] - 2*E_q1030*E_wiwiT[1][2] - 2*E_q1100*E_wi[2]*E_wj[0] - 6*E_q1102*E_wiwiT[0][2] - 6*E_q1120*E_wiwiT[0][2] - 2*E_q1201*E_wiwiT[0][0] - 2*E_q1201*E_wiwiT[1][1] + 4*E_q1201*E_wiwiT[2][2] + 6*E_q1210*E_wiwiT[1][2] + 2*E_q1300*E_wiwiT[0][2] - E_q2000*E_wi[0]*E_wj[1] - E_q2000*E_wi[1]*E_wj[0] - 6*E_q2002*E_wiwiT[0][1] + 6*E_q2011*E_wiwiT[0][2] + 6*E_q2101*E_wiwiT[1][2] + 2*E_q2110*E_wiwiT[0][0] + 2*E_q2110*E_wiwiT[1][1] - 4*E_q2110*E_wiwiT[2][2] - 2*E_q3001*E_wiwiT[0][0] + 2*E_q3001*E_wiwiT[1][1] - 2*E_q3010*E_wiwiT[1][2] + 2*E_q3100*E_wiwiT[0][2] + E_q4000*E_wiwiT[0][1] + E_wjwjT[0][1];
    Cij[0][2] = E_q0002*E_wi[0]*E_wj[2] - E_q0002*E_wi[2]*E_wj[0] - E_q0004*E_wiwiT[0][2] - 2*E_q0011*E_wi[1]*E_wj[0] - 2*E_q0013*E_wiwiT[0][1] + E_q0020*E_wi[0]*E_wj[2] + E_q0020*E_wi[2]*E_wj[0] - 2*E_q0031*E_wiwiT[0][1] + E_q0040*E_wiwiT[0][2] - 2*E_q0101*E_wi[0]*E_wj[0] - 2*E_q0101*E_wi[2]*E_wj[2] - 2*E_q0103*E_wiwiT[0][0] + 2*E_q0103*E_wiwiT[2][2] - 2*E_q0110*E_wi[1]*E_wj[2] + 6*E_q0112*E_wiwiT[1][2] - 2*E_q0121*E_wiwiT[0][0] + 4*E_q0121*E_wiwiT[1][1] - 2*E_q0121*E_wiwiT[2][2] - 2*E_q0130*E_wiwiT[1][2] - E_q0200*E_wi[0]*E_wj[2] + E_q0200*E_wi[2]*E_wj[0] + 6*E_q0202*E_wiwiT[0][2] + 6*E_q0211*E_wiwiT[0][1] + 2*E_q0301*E_wiwiT[0][0] - 2*E_q0301*E_wiwiT[2][2] - 2*E_q0310*E_wiwiT[1][2] - E_q0400*E_wiwiT[0][2] - 2*E_q1001*E_wi[1]*E_wj[2] + 2*E_q1003*E_wiwiT[1][2] - 2*E_q1010*E_wi[0]*E_wj[0] + 2*E_q1010*E_wi[2]*E_wj[2] - 2*E_q1012*E_wiwiT[0][0] + 4*E_q1012*E_wiwiT[1][1] - 2*E_q1012*E_wiwiT[2][2] - 6*E_q1021*E_wiwiT[1][2] - 2*E_q1030*E_wiwiT[0][0] + 2*E_q1030*E_wiwiT[2][2] + 2*E_q1100*E_wi[1]*E_wj[0] + 6*E_q1102*E_wiwiT[0][1] + 6*E_q1120*E_wiwiT[0][1] - 6*E_q1201*E_wiwiT[1][2] + 2*E_q1210*E_wiwiT[0][0] - 4*E_q1210*E_wiwiT[1][1] + 2*E_q1210*E_wiwiT[2][2] - 2*E_q1300*E_wiwiT[0][1] - E_q2000*E_wi[0]*E_wj[2] - E_q2000*E_wi[2]*E_wj[0] + 6*E_q2011*E_wiwiT[0][1] - 6*E_q2020*E_wiwiT[0][2] + 2*E_q2101*E_wiwiT[0][0] - 4*E_q2101*E_wiwiT[1][1] + 2*E_q2101*E_wiwiT[2][2] + 6*E_q2110*E_wiwiT[1][2] + 2*E_q3001*E_wiwiT[1][2] + 2*E_q3010*E_wiwiT[0][0] - 2*E_q3010*E_wiwiT[2][2] - 2*E_q3100*E_wiwiT[0][1] + E_q4000*E_wiwiT[0][2] + E_wjwjT[0][2];
    Cij[1][1] = 2*E_q0002*E_wi[1]*E_wj[1] + E_q0004*E_wiwiT[1][1] - 4*E_q0011*E_wi[2]*E_wj[1] - 4*E_q0013*E_wiwiT[1][2] - 2*E_q0020*E_wi[1]*E_wj[1] - 2*E_q0022*E_wiwiT[1][1] + 4*E_q0022*E_wiwiT[2][2] + 4*E_q0031*E_wiwiT[1][2] + E_q0040*E_wiwiT[1][1] - 4*E_q0110*E_wi[0]*E_wj[1] - 4*E_q0112*E_wiwiT[0][1] + 8*E_q0121*E_wiwiT[0][2] + 4*E_q0130*E_wiwiT[0][1] + 2*E_q0200*E_wi[1]*E_wj[1] + 2*E_q0202*E_wiwiT[1][1] - 4*E_q0211*E_wiwiT[1][2] + 4*E_q0220*E_wiwiT[0][0] - 2*E_q0220*E_wiwiT[1][1] - 4*E_q0310*E_wiwiT[0][1] + E_q0400*E_wiwiT[1][1] + 4*E_q1001*E_wi[0]*E_wj[1] + 4*E_q1003*E_wiwiT[0][1] - 8*E_q1012*E_wiwiT[0][2] - 4*E_q1021*E_wiwiT[0][1] - 4*E_q1100*E_wi[2]*E_wj[1] - 4*E_q1102*E_wiwiT[1][2] - 8*E_q1111*E_wiwiT[0][0] + 8*E_q1111*E_wiwiT[2][2] + 4*E_q1120*E_wiwiT[1][2] + 4*E_q1201*E_wiwiT[0][1] + 8*E_q1210*E_wiwiT[0][2] - 4*E_q1300*E_wiwiT[1][2] - 2*E_q2000*E_wi[1]*E_wj[1] + 4*E_q2002*E_wiwiT[0][0] - 2*E_q2002*E_wiwiT[1][1] + 4*E_q2011*E_wiwiT[1][2] + 2*E_q2020*E_wiwiT[1][1] - 8*E_q2101*E_wiwiT[0][2] + 4*E_q2110*E_wiwiT[0][1] - 2*E_q2200*E_wiwiT[1][1] + 4*E_q2200*E_wiwiT[2][2] - 4*E_q3001*E_wiwiT[0][1] + 4*E_q3100*E_wiwiT[1][2] + E_q4000*E_wiwiT[1][1] + E_wjwjT[1][1];
    Cij[1][2] = E_q0002*E_wi[1]*E_wj[2] - E_q0002*E_wi[2]*E_wj[1] - E_q0004*E_wiwiT[1][2] - 2*E_q0011*E_wi[1]*E_wj[1] - 2*E_q0011*E_wi[2]*E_wj[2] - 2*E_q0013*E_wiwiT[1][1] + 2*E_q0013*E_wiwiT[2][2] - E_q0020*E_wi[1]*E_wj[2] + E_q0020*E_wi[2]*E_wj[1] + 6*E_q0022*E_wiwiT[1][2] + 2*E_q0031*E_wiwiT[1][1] - 2*E_q0031*E_wiwiT[2][2] - E_q0040*E_wiwiT[1][2] - 2*E_q0101*E_wi[0]*E_wj[1] - 2*E_q0103*E_wiwiT[0][1] - 2*E_q0110*E_wi[0]*E_wj[2] + 6*E_q0112*E_wiwiT[0][2] + 6*E_q0121*E_wiwiT[0][1] - 2*E_q0130*E_wiwiT[0][2] + E_q0200*E_wi[1]*E_wj[2] + E_q0200*E_wi[2]*E_wj[1] + 4*E_q0211*E_wiwiT[0][0] - 2*E_q0211*E_wiwiT[1][1] - 2*E_q0211*E_wiwiT[2][2] - 2*E_q0301*E_wiwiT[0][1] - 2*E_q0310*E_wiwiT[0][2] + E_q0400*E_wiwiT[1][2] + 2*E_q1001*E_wi[0]*E_wj[2] - 2*E_q1003*E_wiwiT[0][2] - 2*E_q1010*E_wi[0]*E_wj[1] - 6*E_q1012*E_wiwiT[0][1] + 6*E_q1021*E_wiwiT[0][2] + 2*E_q1030*E_wiwiT[0][1] + 2*E_q1100*E_wi[1]*E_wj[1] - 2*E_q1100*E_wi[2]*E_wj[2] - 4*E_q1102*E_wiwiT[0][0] + 2*E_q1102*E_wiwiT[1][1] + 2*E_q1102*E_wiwiT[2][2] + 4*E_q1120*E_wiwiT[0][0] - 2*E_q1120*E_wiwiT[1][1] - 2*E_q1120*E_wiwiT[2][2] + 6*E_q1201*E_wiwiT[0][2] - 6*E_q1210*E_wiwiT[0][1] + 2*E_q1300*E_wiwiT[1][1] - 2*E_q1300*E_wiwiT[2][2] - E_q2000*E_wi[1]*E_wj[2] - E_q2000*E_wi[2]*E_wj[1] - 4*E_q2011*E_wiwiT[0][0] + 2*E_q2011*E_wiwiT[1][1] + 2*E_q2011*E_wiwiT[2][2] + 6*E_q2101*E_wiwiT[0][1] + 6*E_q2110*E_wiwiT[0][2] - 6*E_q2200*E_wiwiT[1][2] - 2*E_q3001*E_wiwiT[0][2] + 2*E_q3010*E_wiwiT[0][1] - 2*E_q3100*E_wiwiT[1][1] + 2*E_q3100*E_wiwiT[2][2] + E_q4000*E_wiwiT[1][2] + E_wjwjT[1][2];
    Cij[2][2] = -2*E_q0002*E_wi[2]*E_wj[2] + E_q0004*E_wiwiT[2][2] - 4*E_q0011*E_wi[1]*E_wj[2] + 4*E_q0013*E_wiwiT[1][2] + 2*E_q0020*E_wi[2]*E_wj[2] + 4*E_q0022*E_wiwiT[1][1] - 2*E_q0022*E_wiwiT[2][2] - 4*E_q0031*E_wiwiT[1][2] + E_q0040*E_wiwiT[2][2] - 4*E_q0101*E_wi[0]*E_wj[2] + 4*E_q0103*E_wiwiT[0][2] + 8*E_q0112*E_wiwiT[0][1] - 4*E_q0121*E_wiwiT[0][2] + 2*E_q0200*E_wi[2]*E_wj[2] + 4*E_q0202*E_wiwiT[0][0] - 2*E_q0202*E_wiwiT[2][2] - 4*E_q0211*E_wiwiT[1][2] + 2*E_q0220*E_wiwiT[2][2] - 4*E_q0301*E_wiwiT[0][2] + E_q0400*E_wiwiT[2][2] - 4*E_q1010*E_wi[0]*E_wj[2] + 4*E_q1012*E_wiwiT[0][2] + 8*E_q1021*E_wiwiT[0][1] - 4*E_q1030*E_wiwiT[0][2] + 4*E_q1100*E_wi[1]*E_wj[2] - 4*E_q1102*E_wiwiT[1][2] + 8*E_q1111*E_wiwiT[0][0] - 8*E_q1111*E_wiwiT[1][1] + 4*E_q1120*E_wiwiT[1][2] - 8*E_q1201*E_wiwiT[0][1] - 4*E_q1210*E_wiwiT[0][2] + 4*E_q1300*E_wiwiT[1][2] - 2*E_q2000*E_wi[2]*E_wj[2] + 2*E_q2002*E_wiwiT[2][2] + 4*E_q2011*E_wiwiT[1][2] + 4*E_q2020*E_wiwiT[0][0] - 2*E_q2020*E_wiwiT[2][2] + 4*E_q2101*E_wiwiT[0][2] - 8*E_q2110*E_wiwiT[0][1] + 4*E_q2200*E_wiwiT[1][1] - 2*E_q2200*E_wiwiT[2][2] + 4*E_q3010*E_wiwiT[0][2] - 4*E_q3100*E_wiwiT[1][2] + E_q4000*E_wiwiT[2][2] + E_wjwjT[2][2];

    // scale so that the trace becomes 1.
    double cov_trace = 1. + (Cij[0][0] + Cij[1][1] + Cij[2][2]) * (0.25 * dt * dt);

    // set to the resulting matrix;
    py::array_t<double> _CovMat({4,4});
    auto CovMat = _CovMat.mutable_unchecked<2>();

    CovMat(0,0) = 1. / cov_trace;
    for (int i=0; i<3; i++){
        CovMat(0,i+1) = Ci[i] * (0.5 * dt) / cov_trace;
        for (int j=i; j<3; j++){
            CovMat(i+1,j+1) = Cij[i][j] * (0.25 * dt * dt) / cov_trace;
        }
    }

    // set lower-triangular elements;
    CovMat(1,0) = CovMat(0,1);
    CovMat(2,0) = CovMat(0,2);
    CovMat(3,0) = CovMat(0,3);
    CovMat(2,1) = CovMat(1,2);
    CovMat(3,1) = CovMat(1,3);
    CovMat(3,2) = CovMat(2,3);

    return _CovMat;
}


// func definition
py::array_t<double> calc_E_R(py::array_t<double> E_q4th){
    // fourth moments of quaternion;
    double E_q4000 = *E_q4th.data(0);
    double E_q3100 = *E_q4th.data(1);
    double E_q2200 = *E_q4th.data(2);
    double E_q1300 = *E_q4th.data(3);
    double E_q0400 = *E_q4th.data(4);
    double E_q3010 = *E_q4th.data(5);
    double E_q2110 = *E_q4th.data(6);
    double E_q1210 = *E_q4th.data(7);
    double E_q0310 = *E_q4th.data(8);
    double E_q2020 = *E_q4th.data(9);
    double E_q1120 = *E_q4th.data(10);
    double E_q0220 = *E_q4th.data(11);
    double E_q1030 = *E_q4th.data(12);
    double E_q0130 = *E_q4th.data(13);
    double E_q0040 = *E_q4th.data(14);
    double E_q3001 = *E_q4th.data(15);
    double E_q2101 = *E_q4th.data(16);
    double E_q1201 = *E_q4th.data(17);
    double E_q0301 = *E_q4th.data(18);
    double E_q2011 = *E_q4th.data(19);
    double E_q1111 = *E_q4th.data(20);
    double E_q0211 = *E_q4th.data(21);
    double E_q1021 = *E_q4th.data(22);
    double E_q0121 = *E_q4th.data(23);
    double E_q0031 = *E_q4th.data(24);
    double E_q2002 = *E_q4th.data(25);
    double E_q1102 = *E_q4th.data(26);
    double E_q0202 = *E_q4th.data(27);
    double E_q1012 = *E_q4th.data(28);
    double E_q0112 = *E_q4th.data(29);
    double E_q0022 = *E_q4th.data(30);
    double E_q1003 = *E_q4th.data(31);
    double E_q0103 = *E_q4th.data(32);
    double E_q0013 = *E_q4th.data(33);
    double E_q0004 = *E_q4th.data(34);

    // initialize
    py::array_t<double> _E_R({3,3});
    auto E_R = _E_R.mutable_unchecked<2>();

    E_R(0,0) = -E_q0004 - 2*E_q0022 - E_q0040 + E_q0400 + 2*E_q2200 + E_q4000;
    E_R(0,1) = 2*E_q0112 + 2*E_q0130 + 2*E_q0310 - 2*E_q1003 - 2*E_q1021 - 2*E_q1201 + 2*E_q2110 - 2*E_q3001;
    E_R(0,2) = 2*E_q0103 + 2*E_q0121 + 2*E_q0301 + 2*E_q1012 + 2*E_q1030 + 2*E_q1210 + 2*E_q2101 + 2*E_q3010;
    E_R(1,0) = 2*E_q0112 + 2*E_q0130 + 2*E_q0310 + 2*E_q1003 + 2*E_q1021 + 2*E_q1201 + 2*E_q2110 + 2*E_q3001;
    E_R(1,1) = -E_q0004 + E_q0040 - 2*E_q0202 - E_q0400 + 2*E_q2020 + E_q4000;
    E_R(1,2) = 2*E_q0013 + 2*E_q0031 + 2*E_q0211 - 2*E_q1102 - 2*E_q1120 - 2*E_q1300 + 2*E_q2011 - 2*E_q3100;
    E_R(2,0) = 2*E_q0103 + 2*E_q0121 + 2*E_q0301 - 2*E_q1012 - 2*E_q1030 - 2*E_q1210 + 2*E_q2101 - 2*E_q3010;
    E_R(2,1) = 2*E_q0013 + 2*E_q0031 + 2*E_q0211 + 2*E_q1102 + 2*E_q1120 + 2*E_q1300 + 2*E_q2011 + 2*E_q3100;
    E_R(2,2) = E_q0004 - E_q0040 - 2*E_q0220 - E_q0400 + 2*E_q2002 + E_q4000;

    return _E_R;
}


// func definition
py::array_t<double> calc_E_R_kron_R(py::array_t<double> E_q4th){
    // fourth moments;
    double E_q4000 = *E_q4th.data(0);
    double E_q3100 = *E_q4th.data(1);
    double E_q2200 = *E_q4th.data(2);
    double E_q1300 = *E_q4th.data(3);
    double E_q0400 = *E_q4th.data(4);
    double E_q3010 = *E_q4th.data(5);
    double E_q2110 = *E_q4th.data(6);
    double E_q1210 = *E_q4th.data(7);
    double E_q0310 = *E_q4th.data(8);
    double E_q2020 = *E_q4th.data(9);
    double E_q1120 = *E_q4th.data(10);
    double E_q0220 = *E_q4th.data(11);
    double E_q1030 = *E_q4th.data(12);
    double E_q0130 = *E_q4th.data(13);
    double E_q0040 = *E_q4th.data(14);
    double E_q3001 = *E_q4th.data(15);
    double E_q2101 = *E_q4th.data(16);
    double E_q1201 = *E_q4th.data(17);
    double E_q0301 = *E_q4th.data(18);
    double E_q2011 = *E_q4th.data(19);
    double E_q1111 = *E_q4th.data(20);
    double E_q0211 = *E_q4th.data(21);
    double E_q1021 = *E_q4th.data(22);
    double E_q0121 = *E_q4th.data(23);
    double E_q0031 = *E_q4th.data(24);
    double E_q2002 = *E_q4th.data(25);
    double E_q1102 = *E_q4th.data(26);
    double E_q0202 = *E_q4th.data(27);
    double E_q1012 = *E_q4th.data(28);
    double E_q0112 = *E_q4th.data(29);
    double E_q0022 = *E_q4th.data(30);
    double E_q1003 = *E_q4th.data(31);
    double E_q0103 = *E_q4th.data(32);
    double E_q0013 = *E_q4th.data(33);
    double E_q0004 = *E_q4th.data(34);

    // initialize
    py::array_t<double> _E_RkronR({9,9});
    auto E_RkronR = _E_RkronR.mutable_unchecked<2>();

    // set elements
    E_RkronR(0,0) = E_q0004 + 2*E_q0022 + E_q0040 - 2*E_q0202 - 2*E_q0220 + E_q0400 - 2*E_q2002 - 2*E_q2020 + 2*E_q2200 + E_q4000;
    E_RkronR(0,1) = -2*E_q0112 - 2*E_q0130 + 2*E_q0310 + 2*E_q1003 + 2*E_q1021 - 2*E_q1201 + 2*E_q2110 - 2*E_q3001;
    E_RkronR(0,2) = -2*E_q0103 - 2*E_q0121 + 2*E_q0301 - 2*E_q1012 - 2*E_q1030 + 2*E_q1210 + 2*E_q2101 + 2*E_q3010;
    E_RkronR(0,3) = -2*E_q0112 - 2*E_q0130 + 2*E_q0310 + 2*E_q1003 + 2*E_q1021 - 2*E_q1201 + 2*E_q2110 - 2*E_q3001;
    E_RkronR(0,4) = 4*E_q0220 - 8*E_q1111 + 4*E_q2002;
    E_RkronR(0,5) = 4*E_q0211 - 4*E_q1102 + 4*E_q1120 - 4*E_q2011;
    E_RkronR(0,6) = -2*E_q0103 - 2*E_q0121 + 2*E_q0301 - 2*E_q1012 - 2*E_q1030 + 2*E_q1210 + 2*E_q2101 + 2*E_q3010;
    E_RkronR(0,7) = 4*E_q0211 - 4*E_q1102 + 4*E_q1120 - 4*E_q2011;
    E_RkronR(0,8) = 4*E_q0202 + 8*E_q1111 + 4*E_q2020;
    E_RkronR(1,0) = -2*E_q0112 - 2*E_q0130 + 2*E_q0310 - 2*E_q1003 - 2*E_q1021 + 2*E_q1201 + 2*E_q2110 + 2*E_q3001;
    E_RkronR(1,1) = E_q0004 - E_q0040 + 2*E_q0220 - E_q0400 - 2*E_q2002 + E_q4000;
    E_RkronR(1,2) = -2*E_q0013 - 2*E_q0031 + 2*E_q0211 + 2*E_q1102 + 2*E_q1120 - 2*E_q1300 + 2*E_q2011 - 2*E_q3100;
    E_RkronR(1,3) = 4*E_q0220 - 4*E_q2002;
    E_RkronR(1,4) = -2*E_q0112 + 2*E_q0130 - 2*E_q0310 + 2*E_q1003 - 2*E_q1021 + 2*E_q1201 + 2*E_q2110 - 2*E_q3001;
    E_RkronR(1,5) = 4*E_q0121 - 4*E_q1012 - 4*E_q1210 + 4*E_q2101;
    E_RkronR(1,6) = 4*E_q0211 + 4*E_q1102 + 4*E_q1120 + 4*E_q2011;
    E_RkronR(1,7) = -2*E_q0103 + 2*E_q0121 - 2*E_q0301 - 2*E_q1012 + 2*E_q1030 - 2*E_q1210 + 2*E_q2101 + 2*E_q3010;
    E_RkronR(1,8) = 4*E_q0112 + 4*E_q1021 - 4*E_q1201 - 4*E_q2110;
    E_RkronR(2,0) = -2*E_q0103 - 2*E_q0121 + 2*E_q0301 + 2*E_q1012 + 2*E_q1030 - 2*E_q1210 + 2*E_q2101 - 2*E_q3010;
    E_RkronR(2,1) = -2*E_q0013 - 2*E_q0031 + 2*E_q0211 - 2*E_q1102 - 2*E_q1120 + 2*E_q1300 + 2*E_q2011 + 2*E_q3100;
    E_RkronR(2,2) = -E_q0004 + E_q0040 + 2*E_q0202 - E_q0400 - 2*E_q2020 + E_q4000;
    E_RkronR(2,3) = 4*E_q0211 - 4*E_q1102 - 4*E_q1120 + 4*E_q2011;
    E_RkronR(2,4) = 4*E_q0121 - 4*E_q1012 + 4*E_q1210 - 4*E_q2101;
    E_RkronR(2,5) = 2*E_q0112 - 2*E_q0130 - 2*E_q0310 - 2*E_q1003 + 2*E_q1021 + 2*E_q1201 + 2*E_q2110 - 2*E_q3001;
    E_RkronR(2,6) = 4*E_q0202 - 4*E_q2020;
    E_RkronR(2,7) = 4*E_q0112 + 4*E_q1021 + 4*E_q1201 + 4*E_q2110;
    E_RkronR(2,8) = 2*E_q0103 - 2*E_q0121 - 2*E_q0301 + 2*E_q1012 - 2*E_q1030 - 2*E_q1210 + 2*E_q2101 + 2*E_q3010;
    E_RkronR(3,0) = -2*E_q0112 - 2*E_q0130 + 2*E_q0310 - 2*E_q1003 - 2*E_q1021 + 2*E_q1201 + 2*E_q2110 + 2*E_q3001;
    E_RkronR(3,1) = 4*E_q0220 - 4*E_q2002;
    E_RkronR(3,2) = 4*E_q0211 + 4*E_q1102 + 4*E_q1120 + 4*E_q2011;
    E_RkronR(3,3) = E_q0004 - E_q0040 + 2*E_q0220 - E_q0400 - 2*E_q2002 + E_q4000;
    E_RkronR(3,4) = -2*E_q0112 + 2*E_q0130 - 2*E_q0310 + 2*E_q1003 - 2*E_q1021 + 2*E_q1201 + 2*E_q2110 - 2*E_q3001;
    E_RkronR(3,5) = -2*E_q0103 + 2*E_q0121 - 2*E_q0301 - 2*E_q1012 + 2*E_q1030 - 2*E_q1210 + 2*E_q2101 + 2*E_q3010;
    E_RkronR(3,6) = -2*E_q0013 - 2*E_q0031 + 2*E_q0211 + 2*E_q1102 + 2*E_q1120 - 2*E_q1300 + 2*E_q2011 - 2*E_q3100;
    E_RkronR(3,7) = 4*E_q0121 - 4*E_q1012 - 4*E_q1210 + 4*E_q2101;
    E_RkronR(3,8) = 4*E_q0112 + 4*E_q1021 - 4*E_q1201 - 4*E_q2110;
    E_RkronR(4,0) = 4*E_q0220 + 8*E_q1111 + 4*E_q2002;
    E_RkronR(4,1) = -2*E_q0112 + 2*E_q0130 - 2*E_q0310 - 2*E_q1003 + 2*E_q1021 - 2*E_q1201 + 2*E_q2110 + 2*E_q3001;
    E_RkronR(4,2) = 4*E_q0121 + 4*E_q1012 - 4*E_q1210 - 4*E_q2101;
    E_RkronR(4,3) = -2*E_q0112 + 2*E_q0130 - 2*E_q0310 - 2*E_q1003 + 2*E_q1021 - 2*E_q1201 + 2*E_q2110 + 2*E_q3001;
    E_RkronR(4,4) = E_q0004 - 2*E_q0022 + E_q0040 + 2*E_q0202 - 2*E_q0220 + E_q0400 - 2*E_q2002 + 2*E_q2020 - 2*E_q2200 + E_q4000;
    E_RkronR(4,5) = -2*E_q0013 + 2*E_q0031 - 2*E_q0211 + 2*E_q1102 - 2*E_q1120 + 2*E_q1300 + 2*E_q2011 - 2*E_q3100;
    E_RkronR(4,6) = 4*E_q0121 + 4*E_q1012 - 4*E_q1210 - 4*E_q2101;
    E_RkronR(4,7) = -2*E_q0013 + 2*E_q0031 - 2*E_q0211 + 2*E_q1102 - 2*E_q1120 + 2*E_q1300 + 2*E_q2011 - 2*E_q3100;
    E_RkronR(4,8) = 4*E_q0022 - 8*E_q1111 + 4*E_q2200;
    E_RkronR(5,0) = 4*E_q0211 + 4*E_q1102 - 4*E_q1120 - 4*E_q2011;
    E_RkronR(5,1) = 4*E_q0121 + 4*E_q1012 + 4*E_q1210 + 4*E_q2101;
    E_RkronR(5,2) = 2*E_q0112 - 2*E_q0130 - 2*E_q0310 + 2*E_q1003 - 2*E_q1021 - 2*E_q1201 + 2*E_q2110 + 2*E_q3001;
    E_RkronR(5,3) = -2*E_q0103 + 2*E_q0121 - 2*E_q0301 + 2*E_q1012 - 2*E_q1030 + 2*E_q1210 + 2*E_q2101 - 2*E_q3010;
    E_RkronR(5,4) = -2*E_q0013 + 2*E_q0031 - 2*E_q0211 - 2*E_q1102 + 2*E_q1120 - 2*E_q1300 + 2*E_q2011 + 2*E_q3100;
    E_RkronR(5,5) = -E_q0004 + 2*E_q0022 - E_q0040 + E_q0400 - 2*E_q2200 + E_q4000;
    E_RkronR(5,6) = 4*E_q0112 - 4*E_q1021 - 4*E_q1201 + 4*E_q2110;
    E_RkronR(5,7) = 4*E_q0022 - 4*E_q2200;
    E_RkronR(5,8) = 2*E_q0013 - 2*E_q0031 - 2*E_q0211 - 2*E_q1102 + 2*E_q1120 + 2*E_q1300 + 2*E_q2011 - 2*E_q3100;
    E_RkronR(6,0) = -2*E_q0103 - 2*E_q0121 + 2*E_q0301 + 2*E_q1012 + 2*E_q1030 - 2*E_q1210 + 2*E_q2101 - 2*E_q3010;
    E_RkronR(6,1) = 4*E_q0211 - 4*E_q1102 - 4*E_q1120 + 4*E_q2011;
    E_RkronR(6,2) = 4*E_q0202 - 4*E_q2020;
    E_RkronR(6,3) = -2*E_q0013 - 2*E_q0031 + 2*E_q0211 - 2*E_q1102 - 2*E_q1120 + 2*E_q1300 + 2*E_q2011 + 2*E_q3100;
    E_RkronR(6,4) = 4*E_q0121 - 4*E_q1012 + 4*E_q1210 - 4*E_q2101;
    E_RkronR(6,5) = 4*E_q0112 + 4*E_q1021 + 4*E_q1201 + 4*E_q2110;
    E_RkronR(6,6) = -E_q0004 + E_q0040 + 2*E_q0202 - E_q0400 - 2*E_q2020 + E_q4000;
    E_RkronR(6,7) = 2*E_q0112 - 2*E_q0130 - 2*E_q0310 - 2*E_q1003 + 2*E_q1021 + 2*E_q1201 + 2*E_q2110 - 2*E_q3001;
    E_RkronR(6,8) = 2*E_q0103 - 2*E_q0121 - 2*E_q0301 + 2*E_q1012 - 2*E_q1030 - 2*E_q1210 + 2*E_q2101 + 2*E_q3010;
    E_RkronR(7,0) = 4*E_q0211 + 4*E_q1102 - 4*E_q1120 - 4*E_q2011;
    E_RkronR(7,1) = -2*E_q0103 + 2*E_q0121 - 2*E_q0301 + 2*E_q1012 - 2*E_q1030 + 2*E_q1210 + 2*E_q2101 - 2*E_q3010;
    E_RkronR(7,2) = 4*E_q0112 - 4*E_q1021 - 4*E_q1201 + 4*E_q2110;
    E_RkronR(7,3) = 4*E_q0121 + 4*E_q1012 + 4*E_q1210 + 4*E_q2101;
    E_RkronR(7,4) = -2*E_q0013 + 2*E_q0031 - 2*E_q0211 - 2*E_q1102 + 2*E_q1120 - 2*E_q1300 + 2*E_q2011 + 2*E_q3100;
    E_RkronR(7,5) = 4*E_q0022 - 4*E_q2200;
    E_RkronR(7,6) = 2*E_q0112 - 2*E_q0130 - 2*E_q0310 + 2*E_q1003 - 2*E_q1021 - 2*E_q1201 + 2*E_q2110 + 2*E_q3001;
    E_RkronR(7,7) = -E_q0004 + 2*E_q0022 - E_q0040 + E_q0400 - 2*E_q2200 + E_q4000;
    E_RkronR(7,8) = 2*E_q0013 - 2*E_q0031 - 2*E_q0211 - 2*E_q1102 + 2*E_q1120 + 2*E_q1300 + 2*E_q2011 - 2*E_q3100;
    E_RkronR(8,0) = 4*E_q0202 - 8*E_q1111 + 4*E_q2020;
    E_RkronR(8,1) = 4*E_q0112 - 4*E_q1021 + 4*E_q1201 - 4*E_q2110;
    E_RkronR(8,2) = 2*E_q0103 - 2*E_q0121 - 2*E_q0301 - 2*E_q1012 + 2*E_q1030 + 2*E_q1210 + 2*E_q2101 - 2*E_q3010;
    E_RkronR(8,3) = 4*E_q0112 - 4*E_q1021 + 4*E_q1201 - 4*E_q2110;
    E_RkronR(8,4) = 4*E_q0022 + 8*E_q1111 + 4*E_q2200;
    E_RkronR(8,5) = 2*E_q0013 - 2*E_q0031 - 2*E_q0211 + 2*E_q1102 - 2*E_q1120 - 2*E_q1300 + 2*E_q2011 + 2*E_q3100;
    E_RkronR(8,6) = 2*E_q0103 - 2*E_q0121 - 2*E_q0301 - 2*E_q1012 + 2*E_q1030 + 2*E_q1210 + 2*E_q2101 - 2*E_q3010;
    E_RkronR(8,7) = 2*E_q0013 - 2*E_q0031 - 2*E_q0211 + 2*E_q1102 - 2*E_q1120 - 2*E_q1300 + 2*E_q2011 + 2*E_q3100;
    E_RkronR(8,8) = E_q0004 - 2*E_q0022 + E_q0040 - 2*E_q0202 + 2*E_q0220 + E_q0400 + 2*E_q2002 - 2*E_q2020 - 2*E_q2200 + E_q4000;

    return _E_RkronR;
}

// func definition
py::array_t<double> calc_E_vCMcb_kron_vCMcb(py::array_t<double> v, py::array_t<double> cov_v){
    // initialize
    py::array_t<double> _E_wcbKrwcb({9,9});
    auto E_wcbKrwcb = _E_wcbKrwcb.mutable_unchecked<2>();
    for (int i=0; i<9; i++){
        for (int j=0; j<9; j++){
            E_wcbKrwcb(i,j) = 0.;
        }
    }
    // convert into std::array
    std::array<double, 3> Ew;
    std::array<std::array<double, 3>, 3> Cw;
    for (int i=0; i<3; i++){
        Ew[i] = *v.data(i);
        for (int j=0; j<3; j++){
            Cw[i][j] = *cov_v.data(i,j);
        }
    }

    // 4th and 6th moments are already converted into linear combinations of 2nd moments.
    E_wcbKrwcb(0,4) = 3*Cw[0][0]*Cw[0][0]*Cw[2][2] + 3*Cw[0][0]*Cw[0][0]*Ew[2]*Ew[2] + 12*Cw[0][0]*Cw[0][2]*Cw[0][2] + 24*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[2] + 2*Cw[0][0]*Cw[1][1]*Cw[2][2] + 2*Cw[0][0]*Cw[1][1]*Ew[2]*Ew[2] + 4*Cw[0][0]*Cw[1][2]*Cw[1][2] + 8*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[2] + 6*Cw[0][0]*Cw[2][2]*Cw[2][2] + 6*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[0] + 2*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[1] + 12*Cw[0][0]*Cw[2][2]*Ew[2]*Ew[2] + 6*Cw[0][0]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 2*Cw[0][0]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 4*Cw[0][1]*Cw[0][1]*Cw[2][2] + 4*Cw[0][1]*Cw[0][1]*Ew[2]*Ew[2] + 16*Cw[0][1]*Cw[0][2]*Cw[1][2] + 16*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[2] + 16*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[2] + 8*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[1] + 8*Cw[0][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 4*Cw[0][2]*Cw[0][2]*Cw[1][1] + 24*Cw[0][2]*Cw[0][2]*Cw[2][2] + 12*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[0] + 4*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[1] + 24*Cw[0][2]*Cw[0][2]*Ew[2]*Ew[2] + 8*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[2] + 16*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[1] + 48*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[2] + 8*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 8*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 16*Cw[0][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 3*Cw[1][1]*Cw[1][1]*Cw[2][2] + 3*Cw[1][1]*Cw[1][1]*Ew[2]*Ew[2] + 12*Cw[1][1]*Cw[1][2]*Cw[1][2] + 24*Cw[1][1]*Cw[1][2]*Ew[1]*Ew[2] + 6*Cw[1][1]*Cw[2][2]*Cw[2][2] + 2*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[0] + 6*Cw[1][1]*Cw[2][2]*Ew[1]*Ew[1] + 12*Cw[1][1]*Cw[2][2]*Ew[2]*Ew[2] + 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + 6*Cw[1][1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 2*Cw[1][1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 24*Cw[1][2]*Cw[1][2]*Cw[2][2] + 4*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[0] + 12*Cw[1][2]*Cw[1][2]*Ew[1]*Ew[1] + 24*Cw[1][2]*Cw[1][2]*Ew[2]*Ew[2] + 48*Cw[1][2]*Cw[2][2]*Ew[1]*Ew[2] + 8*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 8*Cw[1][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 16*Cw[1][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 15*Cw[2][2]*Cw[2][2]*Cw[2][2] + 6*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[0] + 6*Cw[2][2]*Cw[2][2]*Ew[1]*Ew[1] + 45*Cw[2][2]*Cw[2][2]*Ew[2]*Ew[2] + Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 12*Cw[2][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + Cw[2][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 12*Cw[2][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 15*Cw[2][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 2*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(0,5) = -3*Cw[0][0]*Cw[0][0]*Cw[1][2] - 3*Cw[0][0]*Cw[0][0]*Ew[1]*Ew[2] - 12*Cw[0][0]*Cw[0][1]*Cw[0][2] - 12*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[2] - 12*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[1] - 6*Cw[0][0]*Cw[1][1]*Cw[1][2] - 6*Cw[0][0]*Cw[1][1]*Ew[1]*Ew[2] - 6*Cw[0][0]*Cw[1][2]*Cw[2][2] - 6*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[0] - 6*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[1] - 6*Cw[0][0]*Cw[1][2]*Ew[2]*Ew[2] - 6*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[2] - 6*Cw[0][0]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 2*Cw[0][0]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[0][1]*Cw[1][2] - 12*Cw[0][1]*Cw[0][1]*Ew[1]*Ew[2] - 12*Cw[0][1]*Cw[0][2]*Cw[1][1] - 12*Cw[0][1]*Cw[0][2]*Cw[2][2] - 12*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[0] - 12*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[1] - 12*Cw[0][1]*Cw[0][2]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[2] - 24*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[1] - 12*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[2] - 4*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 12*Cw[0][1]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 4*Cw[0][1]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[0][2]*Cw[1][2] - 12*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[2] - 12*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[1] - 24*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[2] - 12*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[1] - 4*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 4*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 12*Cw[0][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 15*Cw[1][1]*Cw[1][1]*Cw[1][2] - 15*Cw[1][1]*Cw[1][1]*Ew[1]*Ew[2] - 18*Cw[1][1]*Cw[1][2]*Cw[2][2] - 6*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[0] - 30*Cw[1][1]*Cw[1][2]*Ew[1]*Ew[1] - 18*Cw[1][1]*Cw[1][2]*Ew[2]*Ew[2] - 18*Cw[1][1]*Cw[2][2]*Ew[1]*Ew[2] - 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 10*Cw[1][1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 6*Cw[1][1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[1][2]*Cw[1][2]*Cw[1][2] - 36*Cw[1][2]*Cw[1][2]*Ew[1]*Ew[2] - 15*Cw[1][2]*Cw[2][2]*Cw[2][2] - 6*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[0] - 18*Cw[1][2]*Cw[2][2]*Ew[1]*Ew[1] - 30*Cw[1][2]*Cw[2][2]*Ew[2]*Ew[2] - Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 6*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 6*Cw[1][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - 5*Cw[1][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 18*Cw[1][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 5*Cw[1][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 15*Cw[2][2]*Cw[2][2]*Ew[1]*Ew[2] - 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 6*Cw[2][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 10*Cw[2][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 2*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(0,7) = -3*Cw[0][0]*Cw[0][0]*Cw[1][2] - 3*Cw[0][0]*Cw[0][0]*Ew[1]*Ew[2] - 12*Cw[0][0]*Cw[0][1]*Cw[0][2] - 12*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[2] - 12*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[1] - 6*Cw[0][0]*Cw[1][1]*Cw[1][2] - 6*Cw[0][0]*Cw[1][1]*Ew[1]*Ew[2] - 6*Cw[0][0]*Cw[1][2]*Cw[2][2] - 6*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[0] - 6*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[1] - 6*Cw[0][0]*Cw[1][2]*Ew[2]*Ew[2] - 6*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[2] - 6*Cw[0][0]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 2*Cw[0][0]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[0][1]*Cw[1][2] - 12*Cw[0][1]*Cw[0][1]*Ew[1]*Ew[2] - 12*Cw[0][1]*Cw[0][2]*Cw[1][1] - 12*Cw[0][1]*Cw[0][2]*Cw[2][2] - 12*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[0] - 12*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[1] - 12*Cw[0][1]*Cw[0][2]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[2] - 24*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[1] - 12*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[2] - 4*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 12*Cw[0][1]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 4*Cw[0][1]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[0][2]*Cw[1][2] - 12*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[2] - 12*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[1] - 24*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[2] - 12*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[1] - 4*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 4*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 12*Cw[0][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 15*Cw[1][1]*Cw[1][1]*Cw[1][2] - 15*Cw[1][1]*Cw[1][1]*Ew[1]*Ew[2] - 18*Cw[1][1]*Cw[1][2]*Cw[2][2] - 6*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[0] - 30*Cw[1][1]*Cw[1][2]*Ew[1]*Ew[1] - 18*Cw[1][1]*Cw[1][2]*Ew[2]*Ew[2] - 18*Cw[1][1]*Cw[2][2]*Ew[1]*Ew[2] - 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 10*Cw[1][1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 6*Cw[1][1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[1][2]*Cw[1][2]*Cw[1][2] - 36*Cw[1][2]*Cw[1][2]*Ew[1]*Ew[2] - 15*Cw[1][2]*Cw[2][2]*Cw[2][2] - 6*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[0] - 18*Cw[1][2]*Cw[2][2]*Ew[1]*Ew[1] - 30*Cw[1][2]*Cw[2][2]*Ew[2]*Ew[2] - Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 6*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 6*Cw[1][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - 5*Cw[1][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 18*Cw[1][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 5*Cw[1][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 15*Cw[2][2]*Cw[2][2]*Ew[1]*Ew[2] - 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 6*Cw[2][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 10*Cw[2][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 2*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(0,8) = 3*Cw[0][0]*Cw[0][0]*Cw[1][1] + 3*Cw[0][0]*Cw[0][0]*Ew[1]*Ew[1] + 12*Cw[0][0]*Cw[0][1]*Cw[0][1] + 24*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[1] + 6*Cw[0][0]*Cw[1][1]*Cw[1][1] + 2*Cw[0][0]*Cw[1][1]*Cw[2][2] + 6*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[0] + 12*Cw[0][0]*Cw[1][1]*Ew[1]*Ew[1] + 2*Cw[0][0]*Cw[1][1]*Ew[2]*Ew[2] + 4*Cw[0][0]*Cw[1][2]*Cw[1][2] + 8*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[2] + 2*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[1] + 6*Cw[0][0]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 24*Cw[0][1]*Cw[0][1]*Cw[1][1] + 4*Cw[0][1]*Cw[0][1]*Cw[2][2] + 12*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[0] + 24*Cw[0][1]*Cw[0][1]*Ew[1]*Ew[1] + 4*Cw[0][1]*Cw[0][1]*Ew[2]*Ew[2] + 16*Cw[0][1]*Cw[0][2]*Cw[1][2] + 16*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[2] + 48*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[1] + 16*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[2] + 8*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[1] + 8*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 16*Cw[0][1]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 8*Cw[0][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 4*Cw[0][2]*Cw[0][2]*Cw[1][1] + 4*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[1] + 8*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[2] + 16*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[1] + 8*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 15*Cw[1][1]*Cw[1][1]*Cw[1][1] + 6*Cw[1][1]*Cw[1][1]*Cw[2][2] + 6*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[0] + 45*Cw[1][1]*Cw[1][1]*Ew[1]*Ew[1] + 6*Cw[1][1]*Cw[1][1]*Ew[2]*Ew[2] + 24*Cw[1][1]*Cw[1][2]*Cw[1][2] + 48*Cw[1][1]*Cw[1][2]*Ew[1]*Ew[2] + 3*Cw[1][1]*Cw[2][2]*Cw[2][2] + 2*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[0] + 12*Cw[1][1]*Cw[2][2]*Ew[1]*Ew[1] + 6*Cw[1][1]*Cw[2][2]*Ew[2]*Ew[2] + Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 12*Cw[1][1]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + 15*Cw[1][1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 12*Cw[1][1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Cw[1][1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[1][2]*Cw[1][2]*Cw[2][2] + 4*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[0] + 24*Cw[1][2]*Cw[1][2]*Ew[1]*Ew[1] + 12*Cw[1][2]*Cw[1][2]*Ew[2]*Ew[2] + 24*Cw[1][2]*Cw[2][2]*Ew[1]*Ew[2] + 8*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 16*Cw[1][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 8*Cw[1][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 3*Cw[2][2]*Cw[2][2]*Ew[1]*Ew[1] + 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 2*Cw[2][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[2][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 2*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(1,3) = -3*Cw[0][0]*Cw[0][0]*Cw[2][2] - 3*Cw[0][0]*Cw[0][0]*Ew[2]*Ew[2] - 12*Cw[0][0]*Cw[0][2]*Cw[0][2] - 24*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[2] - 2*Cw[0][0]*Cw[1][1]*Cw[2][2] - 2*Cw[0][0]*Cw[1][1]*Ew[2]*Ew[2] - 4*Cw[0][0]*Cw[1][2]*Cw[1][2] - 8*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[2] - 6*Cw[0][0]*Cw[2][2]*Cw[2][2] - 6*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[0] - 2*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[1] - 12*Cw[0][0]*Cw[2][2]*Ew[2]*Ew[2] - 6*Cw[0][0]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 2*Cw[0][0]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 4*Cw[0][1]*Cw[0][1]*Cw[2][2] - 4*Cw[0][1]*Cw[0][1]*Ew[2]*Ew[2] - 16*Cw[0][1]*Cw[0][2]*Cw[1][2] - 16*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[2] - 16*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[2] - 8*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[1] - 8*Cw[0][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 4*Cw[0][2]*Cw[0][2]*Cw[1][1] - 24*Cw[0][2]*Cw[0][2]*Cw[2][2] - 12*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[0] - 4*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[1] - 24*Cw[0][2]*Cw[0][2]*Ew[2]*Ew[2] - 8*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[2] - 16*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[1] - 48*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[2] - 8*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 8*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 16*Cw[0][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 3*Cw[1][1]*Cw[1][1]*Cw[2][2] - 3*Cw[1][1]*Cw[1][1]*Ew[2]*Ew[2] - 12*Cw[1][1]*Cw[1][2]*Cw[1][2] - 24*Cw[1][1]*Cw[1][2]*Ew[1]*Ew[2] - 6*Cw[1][1]*Cw[2][2]*Cw[2][2] - 2*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[0] - 6*Cw[1][1]*Cw[2][2]*Ew[1]*Ew[1] - 12*Cw[1][1]*Cw[2][2]*Ew[2]*Ew[2] - 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - 6*Cw[1][1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 2*Cw[1][1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 24*Cw[1][2]*Cw[1][2]*Cw[2][2] - 4*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[0] - 12*Cw[1][2]*Cw[1][2]*Ew[1]*Ew[1] - 24*Cw[1][2]*Cw[1][2]*Ew[2]*Ew[2] - 48*Cw[1][2]*Cw[2][2]*Ew[1]*Ew[2] - 8*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 8*Cw[1][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 16*Cw[1][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 15*Cw[2][2]*Cw[2][2]*Cw[2][2] - 6*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[0] - 6*Cw[2][2]*Cw[2][2]*Ew[1]*Ew[1] - 45*Cw[2][2]*Cw[2][2]*Ew[2]*Ew[2] - Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 12*Cw[2][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - Cw[2][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 12*Cw[2][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 15*Cw[2][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 2*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(1,5) = 15*Cw[0][0]*Cw[0][0]*Cw[0][2] + 15*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[2] + 12*Cw[0][0]*Cw[0][1]*Cw[1][2] + 12*Cw[0][0]*Cw[0][1]*Ew[1]*Ew[2] + 6*Cw[0][0]*Cw[0][2]*Cw[1][1] + 18*Cw[0][0]*Cw[0][2]*Cw[2][2] + 30*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[0] + 6*Cw[0][0]*Cw[0][2]*Ew[1]*Ew[1] + 18*Cw[0][0]*Cw[0][2]*Ew[2]*Ew[2] + 6*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[2] + 12*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[1] + 18*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[2] + 10*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 6*Cw[0][0]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[0][1]*Cw[0][2] + 12*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[2] + 24*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[1] + 12*Cw[0][1]*Cw[1][1]*Cw[1][2] + 12*Cw[0][1]*Cw[1][1]*Ew[1]*Ew[2] + 12*Cw[0][1]*Cw[1][2]*Cw[2][2] + 12*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[0] + 12*Cw[0][1]*Cw[1][2]*Ew[1]*Ew[1] + 12*Cw[0][1]*Cw[1][2]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[2][2]*Ew[1]*Ew[2] + 12*Cw[0][1]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 4*Cw[0][1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 4*Cw[0][1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[0][2]*Cw[0][2] + 36*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[2] + 3*Cw[0][2]*Cw[1][1]*Cw[1][1] + 6*Cw[0][2]*Cw[1][1]*Cw[2][2] + 6*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[0] + 6*Cw[0][2]*Cw[1][1]*Ew[1]*Ew[1] + 6*Cw[0][2]*Cw[1][1]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[1][2]*Cw[1][2] + 24*Cw[0][2]*Cw[1][2]*Ew[1]*Ew[2] + 15*Cw[0][2]*Cw[2][2]*Cw[2][2] + 18*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[0] + 6*Cw[0][2]*Cw[2][2]*Ew[1]*Ew[1] + 30*Cw[0][2]*Cw[2][2]*Ew[2]*Ew[2] + 5*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 6*Cw[0][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 18*Cw[0][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + Cw[0][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[0][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 5*Cw[0][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 3*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[2] + 12*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[1] + 6*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[2] + 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 6*Cw[1][1]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 2*Cw[1][1]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[2] + 12*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[1] + 4*Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 4*Cw[1][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 12*Cw[1][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 15*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[2] + 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 6*Cw[2][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 10*Cw[2][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 2*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + Ew[0]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(1,6) = 3*Cw[0][0]*Cw[0][0]*Cw[1][2] + 3*Cw[0][0]*Cw[0][0]*Ew[1]*Ew[2] + 12*Cw[0][0]*Cw[0][1]*Cw[0][2] + 12*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[2] + 12*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[1] + 6*Cw[0][0]*Cw[1][1]*Cw[1][2] + 6*Cw[0][0]*Cw[1][1]*Ew[1]*Ew[2] + 6*Cw[0][0]*Cw[1][2]*Cw[2][2] + 6*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[0] + 6*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[1] + 6*Cw[0][0]*Cw[1][2]*Ew[2]*Ew[2] + 6*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[2] + 6*Cw[0][0]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 2*Cw[0][0]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[0][1]*Cw[1][2] + 12*Cw[0][1]*Cw[0][1]*Ew[1]*Ew[2] + 12*Cw[0][1]*Cw[0][2]*Cw[1][1] + 12*Cw[0][1]*Cw[0][2]*Cw[2][2] + 12*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[0] + 12*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[1] + 12*Cw[0][1]*Cw[0][2]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[2] + 24*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[1] + 12*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[2] + 4*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 12*Cw[0][1]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 4*Cw[0][1]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[0][2]*Cw[1][2] + 12*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[2] + 12*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[1] + 24*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[2] + 12*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[1] + 4*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 4*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 12*Cw[0][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 15*Cw[1][1]*Cw[1][1]*Cw[1][2] + 15*Cw[1][1]*Cw[1][1]*Ew[1]*Ew[2] + 18*Cw[1][1]*Cw[1][2]*Cw[2][2] + 6*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[0] + 30*Cw[1][1]*Cw[1][2]*Ew[1]*Ew[1] + 18*Cw[1][1]*Cw[1][2]*Ew[2]*Ew[2] + 18*Cw[1][1]*Cw[2][2]*Ew[1]*Ew[2] + 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 10*Cw[1][1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 6*Cw[1][1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[1][2]*Cw[1][2]*Cw[1][2] + 36*Cw[1][2]*Cw[1][2]*Ew[1]*Ew[2] + 15*Cw[1][2]*Cw[2][2]*Cw[2][2] + 6*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[0] + 18*Cw[1][2]*Cw[2][2]*Ew[1]*Ew[1] + 30*Cw[1][2]*Cw[2][2]*Ew[2]*Ew[2] + Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 6*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 6*Cw[1][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + 5*Cw[1][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 18*Cw[1][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 5*Cw[1][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 15*Cw[2][2]*Cw[2][2]*Ew[1]*Ew[2] + 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 6*Cw[2][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 10*Cw[2][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 2*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(1,8) = -15*Cw[0][0]*Cw[0][0]*Cw[0][1] - 15*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[1] - 18*Cw[0][0]*Cw[0][1]*Cw[1][1] - 6*Cw[0][0]*Cw[0][1]*Cw[2][2] - 30*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[0] - 18*Cw[0][0]*Cw[0][1]*Ew[1]*Ew[1] - 6*Cw[0][0]*Cw[0][1]*Ew[2]*Ew[2] - 12*Cw[0][0]*Cw[0][2]*Cw[1][2] - 12*Cw[0][0]*Cw[0][2]*Ew[1]*Ew[2] - 18*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[1] - 12*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[2] - 6*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[1] - 10*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[0][1]*Cw[0][1] - 36*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[1] - 12*Cw[0][1]*Cw[0][2]*Cw[0][2] - 24*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[2] - 15*Cw[0][1]*Cw[1][1]*Cw[1][1] - 6*Cw[0][1]*Cw[1][1]*Cw[2][2] - 18*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[0] - 30*Cw[0][1]*Cw[1][1]*Ew[1]*Ew[1] - 6*Cw[0][1]*Cw[1][1]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[1][2]*Cw[1][2] - 24*Cw[0][1]*Cw[1][2]*Ew[1]*Ew[2] - 3*Cw[0][1]*Cw[2][2]*Cw[2][2] - 6*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[0] - 6*Cw[0][1]*Cw[2][2]*Ew[1]*Ew[1] - 6*Cw[0][1]*Cw[2][2]*Ew[2]*Ew[2] - 5*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 18*Cw[0][1]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 6*Cw[0][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - 5*Cw[0][1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[0][1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Cw[0][1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[1] - 12*Cw[0][2]*Cw[1][1]*Cw[1][2] - 12*Cw[0][2]*Cw[1][1]*Ew[1]*Ew[2] - 12*Cw[0][2]*Cw[1][2]*Cw[2][2] - 12*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[0] - 12*Cw[0][2]*Cw[1][2]*Ew[1]*Ew[1] - 12*Cw[0][2]*Cw[1][2]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[2][2]*Ew[1]*Ew[2] - 12*Cw[0][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 4*Cw[0][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 4*Cw[0][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 15*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[1] - 12*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[2] - 6*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[1] - 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 10*Cw[1][1]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[1][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 12*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[1] - 12*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[2] - 4*Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 12*Cw[1][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 4*Cw[1][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 3*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[1] - 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 2*Cw[2][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[2][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 2*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Ew[0]*Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(2,3) = 3*Cw[0][0]*Cw[0][0]*Cw[1][2] + 3*Cw[0][0]*Cw[0][0]*Ew[1]*Ew[2] + 12*Cw[0][0]*Cw[0][1]*Cw[0][2] + 12*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[2] + 12*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[1] + 6*Cw[0][0]*Cw[1][1]*Cw[1][2] + 6*Cw[0][0]*Cw[1][1]*Ew[1]*Ew[2] + 6*Cw[0][0]*Cw[1][2]*Cw[2][2] + 6*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[0] + 6*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[1] + 6*Cw[0][0]*Cw[1][2]*Ew[2]*Ew[2] + 6*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[2] + 6*Cw[0][0]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 2*Cw[0][0]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[0][1]*Cw[1][2] + 12*Cw[0][1]*Cw[0][1]*Ew[1]*Ew[2] + 12*Cw[0][1]*Cw[0][2]*Cw[1][1] + 12*Cw[0][1]*Cw[0][2]*Cw[2][2] + 12*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[0] + 12*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[1] + 12*Cw[0][1]*Cw[0][2]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[2] + 24*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[1] + 12*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[2] + 4*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 12*Cw[0][1]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 4*Cw[0][1]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[0][2]*Cw[1][2] + 12*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[2] + 12*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[1] + 24*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[2] + 12*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[1] + 4*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 4*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 12*Cw[0][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 15*Cw[1][1]*Cw[1][1]*Cw[1][2] + 15*Cw[1][1]*Cw[1][1]*Ew[1]*Ew[2] + 18*Cw[1][1]*Cw[1][2]*Cw[2][2] + 6*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[0] + 30*Cw[1][1]*Cw[1][2]*Ew[1]*Ew[1] + 18*Cw[1][1]*Cw[1][2]*Ew[2]*Ew[2] + 18*Cw[1][1]*Cw[2][2]*Ew[1]*Ew[2] + 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 10*Cw[1][1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 6*Cw[1][1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[1][2]*Cw[1][2]*Cw[1][2] + 36*Cw[1][2]*Cw[1][2]*Ew[1]*Ew[2] + 15*Cw[1][2]*Cw[2][2]*Cw[2][2] + 6*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[0] + 18*Cw[1][2]*Cw[2][2]*Ew[1]*Ew[1] + 30*Cw[1][2]*Cw[2][2]*Ew[2]*Ew[2] + Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 6*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 6*Cw[1][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + 5*Cw[1][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 18*Cw[1][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 5*Cw[1][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 15*Cw[2][2]*Cw[2][2]*Ew[1]*Ew[2] + 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 6*Cw[2][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 10*Cw[2][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 2*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(2,4) = -15*Cw[0][0]*Cw[0][0]*Cw[0][2] - 15*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[2] - 12*Cw[0][0]*Cw[0][1]*Cw[1][2] - 12*Cw[0][0]*Cw[0][1]*Ew[1]*Ew[2] - 6*Cw[0][0]*Cw[0][2]*Cw[1][1] - 18*Cw[0][0]*Cw[0][2]*Cw[2][2] - 30*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[0] - 6*Cw[0][0]*Cw[0][2]*Ew[1]*Ew[1] - 18*Cw[0][0]*Cw[0][2]*Ew[2]*Ew[2] - 6*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[2] - 12*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[1] - 18*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[2] - 10*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 6*Cw[0][0]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[0][1]*Cw[0][2] - 12*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[2] - 24*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[1] - 12*Cw[0][1]*Cw[1][1]*Cw[1][2] - 12*Cw[0][1]*Cw[1][1]*Ew[1]*Ew[2] - 12*Cw[0][1]*Cw[1][2]*Cw[2][2] - 12*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[0] - 12*Cw[0][1]*Cw[1][2]*Ew[1]*Ew[1] - 12*Cw[0][1]*Cw[1][2]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[2][2]*Ew[1]*Ew[2] - 12*Cw[0][1]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 4*Cw[0][1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 4*Cw[0][1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[0][2]*Cw[0][2] - 36*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[2] - 3*Cw[0][2]*Cw[1][1]*Cw[1][1] - 6*Cw[0][2]*Cw[1][1]*Cw[2][2] - 6*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[0] - 6*Cw[0][2]*Cw[1][1]*Ew[1]*Ew[1] - 6*Cw[0][2]*Cw[1][1]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[1][2]*Cw[1][2] - 24*Cw[0][2]*Cw[1][2]*Ew[1]*Ew[2] - 15*Cw[0][2]*Cw[2][2]*Cw[2][2] - 18*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[0] - 6*Cw[0][2]*Cw[2][2]*Ew[1]*Ew[1] - 30*Cw[0][2]*Cw[2][2]*Ew[2]*Ew[2] - 5*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 6*Cw[0][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 18*Cw[0][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - Cw[0][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[0][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 5*Cw[0][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 3*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[2] - 12*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[1] - 6*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[2] - 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 6*Cw[1][1]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 2*Cw[1][1]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[2] - 12*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[1] - 4*Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 4*Cw[1][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 12*Cw[1][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 15*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[2] - 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 6*Cw[2][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 10*Cw[2][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 2*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - Ew[0]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(2,6) = -3*Cw[0][0]*Cw[0][0]*Cw[1][1] - 3*Cw[0][0]*Cw[0][0]*Ew[1]*Ew[1] - 12*Cw[0][0]*Cw[0][1]*Cw[0][1] - 24*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[1] - 6*Cw[0][0]*Cw[1][1]*Cw[1][1] - 2*Cw[0][0]*Cw[1][1]*Cw[2][2] - 6*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[0] - 12*Cw[0][0]*Cw[1][1]*Ew[1]*Ew[1] - 2*Cw[0][0]*Cw[1][1]*Ew[2]*Ew[2] - 4*Cw[0][0]*Cw[1][2]*Cw[1][2] - 8*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[2] - 2*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[1] - 6*Cw[0][0]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 24*Cw[0][1]*Cw[0][1]*Cw[1][1] - 4*Cw[0][1]*Cw[0][1]*Cw[2][2] - 12*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[0] - 24*Cw[0][1]*Cw[0][1]*Ew[1]*Ew[1] - 4*Cw[0][1]*Cw[0][1]*Ew[2]*Ew[2] - 16*Cw[0][1]*Cw[0][2]*Cw[1][2] - 16*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[2] - 48*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[1] - 16*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[2] - 8*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[1] - 8*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 16*Cw[0][1]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 8*Cw[0][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 4*Cw[0][2]*Cw[0][2]*Cw[1][1] - 4*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[1] - 8*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[2] - 16*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[1] - 8*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 15*Cw[1][1]*Cw[1][1]*Cw[1][1] - 6*Cw[1][1]*Cw[1][1]*Cw[2][2] - 6*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[0] - 45*Cw[1][1]*Cw[1][1]*Ew[1]*Ew[1] - 6*Cw[1][1]*Cw[1][1]*Ew[2]*Ew[2] - 24*Cw[1][1]*Cw[1][2]*Cw[1][2] - 48*Cw[1][1]*Cw[1][2]*Ew[1]*Ew[2] - 3*Cw[1][1]*Cw[2][2]*Cw[2][2] - 2*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[0] - 12*Cw[1][1]*Cw[2][2]*Ew[1]*Ew[1] - 6*Cw[1][1]*Cw[2][2]*Ew[2]*Ew[2] - Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 12*Cw[1][1]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - 15*Cw[1][1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 12*Cw[1][1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Cw[1][1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[1][2]*Cw[1][2]*Cw[2][2] - 4*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[0] - 24*Cw[1][2]*Cw[1][2]*Ew[1]*Ew[1] - 12*Cw[1][2]*Cw[1][2]*Ew[2]*Ew[2] - 24*Cw[1][2]*Cw[2][2]*Ew[1]*Ew[2] - 8*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 16*Cw[1][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 8*Cw[1][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 3*Cw[2][2]*Cw[2][2]*Ew[1]*Ew[1] - 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 2*Cw[2][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[2][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 2*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(2,7) = 15*Cw[0][0]*Cw[0][0]*Cw[0][1] + 15*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[1] + 18*Cw[0][0]*Cw[0][1]*Cw[1][1] + 6*Cw[0][0]*Cw[0][1]*Cw[2][2] + 30*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[0] + 18*Cw[0][0]*Cw[0][1]*Ew[1]*Ew[1] + 6*Cw[0][0]*Cw[0][1]*Ew[2]*Ew[2] + 12*Cw[0][0]*Cw[0][2]*Cw[1][2] + 12*Cw[0][0]*Cw[0][2]*Ew[1]*Ew[2] + 18*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[1] + 12*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[2] + 6*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[1] + 10*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[0][1]*Cw[0][1] + 36*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[1] + 12*Cw[0][1]*Cw[0][2]*Cw[0][2] + 24*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[2] + 15*Cw[0][1]*Cw[1][1]*Cw[1][1] + 6*Cw[0][1]*Cw[1][1]*Cw[2][2] + 18*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[0] + 30*Cw[0][1]*Cw[1][1]*Ew[1]*Ew[1] + 6*Cw[0][1]*Cw[1][1]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[1][2]*Cw[1][2] + 24*Cw[0][1]*Cw[1][2]*Ew[1]*Ew[2] + 3*Cw[0][1]*Cw[2][2]*Cw[2][2] + 6*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[0] + 6*Cw[0][1]*Cw[2][2]*Ew[1]*Ew[1] + 6*Cw[0][1]*Cw[2][2]*Ew[2]*Ew[2] + 5*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 18*Cw[0][1]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 6*Cw[0][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + 5*Cw[0][1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[0][1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Cw[0][1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[1] + 12*Cw[0][2]*Cw[1][1]*Cw[1][2] + 12*Cw[0][2]*Cw[1][1]*Ew[1]*Ew[2] + 12*Cw[0][2]*Cw[1][2]*Cw[2][2] + 12*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[0] + 12*Cw[0][2]*Cw[1][2]*Ew[1]*Ew[1] + 12*Cw[0][2]*Cw[1][2]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[2][2]*Ew[1]*Ew[2] + 12*Cw[0][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 4*Cw[0][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 4*Cw[0][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 15*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[1] + 12*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[2] + 6*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[1] + 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 10*Cw[1][1]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[1][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 12*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[1] + 12*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[2] + 4*Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 12*Cw[1][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 4*Cw[1][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 3*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[1] + 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 2*Cw[2][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[2][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 2*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Ew[0]*Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(3,7) = 15*Cw[0][0]*Cw[0][0]*Cw[0][2] + 15*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[2] + 12*Cw[0][0]*Cw[0][1]*Cw[1][2] + 12*Cw[0][0]*Cw[0][1]*Ew[1]*Ew[2] + 6*Cw[0][0]*Cw[0][2]*Cw[1][1] + 18*Cw[0][0]*Cw[0][2]*Cw[2][2] + 30*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[0] + 6*Cw[0][0]*Cw[0][2]*Ew[1]*Ew[1] + 18*Cw[0][0]*Cw[0][2]*Ew[2]*Ew[2] + 6*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[2] + 12*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[1] + 18*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[2] + 10*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 6*Cw[0][0]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[0][1]*Cw[0][2] + 12*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[2] + 24*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[1] + 12*Cw[0][1]*Cw[1][1]*Cw[1][2] + 12*Cw[0][1]*Cw[1][1]*Ew[1]*Ew[2] + 12*Cw[0][1]*Cw[1][2]*Cw[2][2] + 12*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[0] + 12*Cw[0][1]*Cw[1][2]*Ew[1]*Ew[1] + 12*Cw[0][1]*Cw[1][2]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[2][2]*Ew[1]*Ew[2] + 12*Cw[0][1]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 4*Cw[0][1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 4*Cw[0][1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[0][2]*Cw[0][2] + 36*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[2] + 3*Cw[0][2]*Cw[1][1]*Cw[1][1] + 6*Cw[0][2]*Cw[1][1]*Cw[2][2] + 6*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[0] + 6*Cw[0][2]*Cw[1][1]*Ew[1]*Ew[1] + 6*Cw[0][2]*Cw[1][1]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[1][2]*Cw[1][2] + 24*Cw[0][2]*Cw[1][2]*Ew[1]*Ew[2] + 15*Cw[0][2]*Cw[2][2]*Cw[2][2] + 18*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[0] + 6*Cw[0][2]*Cw[2][2]*Ew[1]*Ew[1] + 30*Cw[0][2]*Cw[2][2]*Ew[2]*Ew[2] + 5*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 6*Cw[0][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 18*Cw[0][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + Cw[0][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[0][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + 5*Cw[0][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 3*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[2] + 12*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[1] + 6*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[2] + 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 6*Cw[1][1]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 2*Cw[1][1]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[2] + 12*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[1] + 4*Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 4*Cw[1][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 12*Cw[1][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 15*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[2] + 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 6*Cw[2][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 10*Cw[2][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 2*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + Ew[0]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(3,8) = -15*Cw[0][0]*Cw[0][0]*Cw[0][1] - 15*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[1] - 18*Cw[0][0]*Cw[0][1]*Cw[1][1] - 6*Cw[0][0]*Cw[0][1]*Cw[2][2] - 30*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[0] - 18*Cw[0][0]*Cw[0][1]*Ew[1]*Ew[1] - 6*Cw[0][0]*Cw[0][1]*Ew[2]*Ew[2] - 12*Cw[0][0]*Cw[0][2]*Cw[1][2] - 12*Cw[0][0]*Cw[0][2]*Ew[1]*Ew[2] - 18*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[1] - 12*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[2] - 6*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[1] - 10*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[0][1]*Cw[0][1] - 36*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[1] - 12*Cw[0][1]*Cw[0][2]*Cw[0][2] - 24*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[2] - 15*Cw[0][1]*Cw[1][1]*Cw[1][1] - 6*Cw[0][1]*Cw[1][1]*Cw[2][2] - 18*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[0] - 30*Cw[0][1]*Cw[1][1]*Ew[1]*Ew[1] - 6*Cw[0][1]*Cw[1][1]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[1][2]*Cw[1][2] - 24*Cw[0][1]*Cw[1][2]*Ew[1]*Ew[2] - 3*Cw[0][1]*Cw[2][2]*Cw[2][2] - 6*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[0] - 6*Cw[0][1]*Cw[2][2]*Ew[1]*Ew[1] - 6*Cw[0][1]*Cw[2][2]*Ew[2]*Ew[2] - 5*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 18*Cw[0][1]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 6*Cw[0][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - 5*Cw[0][1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[0][1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Cw[0][1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[1] - 12*Cw[0][2]*Cw[1][1]*Cw[1][2] - 12*Cw[0][2]*Cw[1][1]*Ew[1]*Ew[2] - 12*Cw[0][2]*Cw[1][2]*Cw[2][2] - 12*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[0] - 12*Cw[0][2]*Cw[1][2]*Ew[1]*Ew[1] - 12*Cw[0][2]*Cw[1][2]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[2][2]*Ew[1]*Ew[2] - 12*Cw[0][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 4*Cw[0][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 4*Cw[0][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 15*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[1] - 12*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[2] - 6*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[1] - 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 10*Cw[1][1]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[1][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 12*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[1] - 12*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[2] - 4*Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 12*Cw[1][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 4*Cw[1][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 3*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[1] - 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 2*Cw[2][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[2][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 2*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Ew[0]*Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(4,6) = -15*Cw[0][0]*Cw[0][0]*Cw[0][2] - 15*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[2] - 12*Cw[0][0]*Cw[0][1]*Cw[1][2] - 12*Cw[0][0]*Cw[0][1]*Ew[1]*Ew[2] - 6*Cw[0][0]*Cw[0][2]*Cw[1][1] - 18*Cw[0][0]*Cw[0][2]*Cw[2][2] - 30*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[0] - 6*Cw[0][0]*Cw[0][2]*Ew[1]*Ew[1] - 18*Cw[0][0]*Cw[0][2]*Ew[2]*Ew[2] - 6*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[2] - 12*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[1] - 18*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[2] - 10*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 6*Cw[0][0]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[0][1]*Cw[0][2] - 12*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[2] - 24*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[1] - 12*Cw[0][1]*Cw[1][1]*Cw[1][2] - 12*Cw[0][1]*Cw[1][1]*Ew[1]*Ew[2] - 12*Cw[0][1]*Cw[1][2]*Cw[2][2] - 12*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[0] - 12*Cw[0][1]*Cw[1][2]*Ew[1]*Ew[1] - 12*Cw[0][1]*Cw[1][2]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[2][2]*Ew[1]*Ew[2] - 12*Cw[0][1]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 4*Cw[0][1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 4*Cw[0][1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[0][2]*Cw[0][2] - 36*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[2] - 3*Cw[0][2]*Cw[1][1]*Cw[1][1] - 6*Cw[0][2]*Cw[1][1]*Cw[2][2] - 6*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[0] - 6*Cw[0][2]*Cw[1][1]*Ew[1]*Ew[1] - 6*Cw[0][2]*Cw[1][1]*Ew[2]*Ew[2] - 12*Cw[0][2]*Cw[1][2]*Cw[1][2] - 24*Cw[0][2]*Cw[1][2]*Ew[1]*Ew[2] - 15*Cw[0][2]*Cw[2][2]*Cw[2][2] - 18*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[0] - 6*Cw[0][2]*Cw[2][2]*Ew[1]*Ew[1] - 30*Cw[0][2]*Cw[2][2]*Ew[2]*Ew[2] - 5*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 6*Cw[0][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 18*Cw[0][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - Cw[0][2]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 6*Cw[0][2]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - 5*Cw[0][2]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 3*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[2] - 12*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[1] - 6*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[2] - 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 6*Cw[1][1]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 2*Cw[1][1]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[2] - 12*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[1] - 4*Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 4*Cw[1][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 12*Cw[1][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 15*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[2] - 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 6*Cw[2][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 10*Cw[2][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[2] - 2*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2]*Ew[2] - Ew[0]*Ew[2]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(4,8) = 15*Cw[0][0]*Cw[0][0]*Cw[0][0] + 6*Cw[0][0]*Cw[0][0]*Cw[1][1] + 6*Cw[0][0]*Cw[0][0]*Cw[2][2] + 45*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[0] + 6*Cw[0][0]*Cw[0][0]*Ew[1]*Ew[1] + 6*Cw[0][0]*Cw[0][0]*Ew[2]*Ew[2] + 24*Cw[0][0]*Cw[0][1]*Cw[0][1] + 48*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[1] + 24*Cw[0][0]*Cw[0][2]*Cw[0][2] + 48*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[2] + 3*Cw[0][0]*Cw[1][1]*Cw[1][1] + 2*Cw[0][0]*Cw[1][1]*Cw[2][2] + 12*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[0] + 6*Cw[0][0]*Cw[1][1]*Ew[1]*Ew[1] + 2*Cw[0][0]*Cw[1][1]*Ew[2]*Ew[2] + 4*Cw[0][0]*Cw[1][2]*Cw[1][2] + 8*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[2] + 3*Cw[0][0]*Cw[2][2]*Cw[2][2] + 12*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[0] + 2*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[1] + 6*Cw[0][0]*Cw[2][2]*Ew[2]*Ew[2] + 15*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 12*Cw[0][0]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 12*Cw[0][0]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + Cw[0][0]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Cw[0][0]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[0][1]*Cw[1][1] + 4*Cw[0][1]*Cw[0][1]*Cw[2][2] + 24*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[0] + 12*Cw[0][1]*Cw[0][1]*Ew[1]*Ew[1] + 4*Cw[0][1]*Cw[0][1]*Ew[2]*Ew[2] + 16*Cw[0][1]*Cw[0][2]*Cw[1][2] + 16*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[2] + 24*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[1] + 16*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[2] + 8*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[1] + 16*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 8*Cw[0][1]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 8*Cw[0][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 4*Cw[0][2]*Cw[0][2]*Cw[1][1] + 12*Cw[0][2]*Cw[0][2]*Cw[2][2] + 24*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[0] + 4*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[1] + 12*Cw[0][2]*Cw[0][2]*Ew[2]*Ew[2] + 8*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[2] + 16*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[1] + 24*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[2] + 16*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 8*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 8*Cw[0][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 3*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[0] + 2*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[0] + 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + 4*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[0] + 8*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 3*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[0] + 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(5,6) = 15*Cw[0][0]*Cw[0][0]*Cw[0][1] + 15*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[1] + 18*Cw[0][0]*Cw[0][1]*Cw[1][1] + 6*Cw[0][0]*Cw[0][1]*Cw[2][2] + 30*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[0] + 18*Cw[0][0]*Cw[0][1]*Ew[1]*Ew[1] + 6*Cw[0][0]*Cw[0][1]*Ew[2]*Ew[2] + 12*Cw[0][0]*Cw[0][2]*Cw[1][2] + 12*Cw[0][0]*Cw[0][2]*Ew[1]*Ew[2] + 18*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[1] + 12*Cw[0][0]*Cw[1][2]*Ew[0]*Ew[2] + 6*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[1] + 10*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[0][0]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[0][1]*Cw[0][1] + 36*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[1] + 12*Cw[0][1]*Cw[0][2]*Cw[0][2] + 24*Cw[0][1]*Cw[0][2]*Ew[0]*Ew[2] + 15*Cw[0][1]*Cw[1][1]*Cw[1][1] + 6*Cw[0][1]*Cw[1][1]*Cw[2][2] + 18*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[0] + 30*Cw[0][1]*Cw[1][1]*Ew[1]*Ew[1] + 6*Cw[0][1]*Cw[1][1]*Ew[2]*Ew[2] + 12*Cw[0][1]*Cw[1][2]*Cw[1][2] + 24*Cw[0][1]*Cw[1][2]*Ew[1]*Ew[2] + 3*Cw[0][1]*Cw[2][2]*Cw[2][2] + 6*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[0] + 6*Cw[0][1]*Cw[2][2]*Ew[1]*Ew[1] + 6*Cw[0][1]*Cw[2][2]*Ew[2]*Ew[2] + 5*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[0] + 18*Cw[0][1]*Ew[0]*Ew[0]*Ew[1]*Ew[1] + 6*Cw[0][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] + 5*Cw[0][1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[0][1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Cw[0][1]*Ew[2]*Ew[2]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[1] + 12*Cw[0][2]*Cw[1][1]*Cw[1][2] + 12*Cw[0][2]*Cw[1][1]*Ew[1]*Ew[2] + 12*Cw[0][2]*Cw[1][2]*Cw[2][2] + 12*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[0] + 12*Cw[0][2]*Cw[1][2]*Ew[1]*Ew[1] + 12*Cw[0][2]*Cw[1][2]*Ew[2]*Ew[2] + 12*Cw[0][2]*Cw[2][2]*Ew[1]*Ew[2] + 12*Cw[0][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] + 4*Cw[0][2]*Ew[1]*Ew[1]*Ew[1]*Ew[2] + 4*Cw[0][2]*Ew[1]*Ew[2]*Ew[2]*Ew[2] + 15*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[1] + 12*Cw[1][1]*Cw[1][2]*Ew[0]*Ew[2] + 6*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[1] + 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 10*Cw[1][1]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[1][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + 12*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[1] + 12*Cw[1][2]*Cw[2][2]*Ew[0]*Ew[2] + 4*Cw[1][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] + 12*Cw[1][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] + 4*Cw[1][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] + 3*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[1] + 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 2*Cw[2][2]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 6*Cw[2][2]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1] + 2*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[2]*Ew[2] + Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1]*Ew[1] + 2*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[2]*Ew[2] + Ew[0]*Ew[1]*Ew[2]*Ew[2]*Ew[2]*Ew[2];
    E_wcbKrwcb(5,7) = -15*Cw[0][0]*Cw[0][0]*Cw[0][0] - 6*Cw[0][0]*Cw[0][0]*Cw[1][1] - 6*Cw[0][0]*Cw[0][0]*Cw[2][2] - 45*Cw[0][0]*Cw[0][0]*Ew[0]*Ew[0] - 6*Cw[0][0]*Cw[0][0]*Ew[1]*Ew[1] - 6*Cw[0][0]*Cw[0][0]*Ew[2]*Ew[2] - 24*Cw[0][0]*Cw[0][1]*Cw[0][1] - 48*Cw[0][0]*Cw[0][1]*Ew[0]*Ew[1] - 24*Cw[0][0]*Cw[0][2]*Cw[0][2] - 48*Cw[0][0]*Cw[0][2]*Ew[0]*Ew[2] - 3*Cw[0][0]*Cw[1][1]*Cw[1][1] - 2*Cw[0][0]*Cw[1][1]*Cw[2][2] - 12*Cw[0][0]*Cw[1][1]*Ew[0]*Ew[0] - 6*Cw[0][0]*Cw[1][1]*Ew[1]*Ew[1] - 2*Cw[0][0]*Cw[1][1]*Ew[2]*Ew[2] - 4*Cw[0][0]*Cw[1][2]*Cw[1][2] - 8*Cw[0][0]*Cw[1][2]*Ew[1]*Ew[2] - 3*Cw[0][0]*Cw[2][2]*Cw[2][2] - 12*Cw[0][0]*Cw[2][2]*Ew[0]*Ew[0] - 2*Cw[0][0]*Cw[2][2]*Ew[1]*Ew[1] - 6*Cw[0][0]*Cw[2][2]*Ew[2]*Ew[2] - 15*Cw[0][0]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 12*Cw[0][0]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 12*Cw[0][0]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - Cw[0][0]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 2*Cw[0][0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Cw[0][0]*Ew[2]*Ew[2]*Ew[2]*Ew[2] - 12*Cw[0][1]*Cw[0][1]*Cw[1][1] - 4*Cw[0][1]*Cw[0][1]*Cw[2][2] - 24*Cw[0][1]*Cw[0][1]*Ew[0]*Ew[0] - 12*Cw[0][1]*Cw[0][1]*Ew[1]*Ew[1] - 4*Cw[0][1]*Cw[0][1]*Ew[2]*Ew[2] - 16*Cw[0][1]*Cw[0][2]*Cw[1][2] - 16*Cw[0][1]*Cw[0][2]*Ew[1]*Ew[2] - 24*Cw[0][1]*Cw[1][1]*Ew[0]*Ew[1] - 16*Cw[0][1]*Cw[1][2]*Ew[0]*Ew[2] - 8*Cw[0][1]*Cw[2][2]*Ew[0]*Ew[1] - 16*Cw[0][1]*Ew[0]*Ew[0]*Ew[0]*Ew[1] - 8*Cw[0][1]*Ew[0]*Ew[1]*Ew[1]*Ew[1] - 8*Cw[0][1]*Ew[0]*Ew[1]*Ew[2]*Ew[2] - 4*Cw[0][2]*Cw[0][2]*Cw[1][1] - 12*Cw[0][2]*Cw[0][2]*Cw[2][2] - 24*Cw[0][2]*Cw[0][2]*Ew[0]*Ew[0] - 4*Cw[0][2]*Cw[0][2]*Ew[1]*Ew[1] - 12*Cw[0][2]*Cw[0][2]*Ew[2]*Ew[2] - 8*Cw[0][2]*Cw[1][1]*Ew[0]*Ew[2] - 16*Cw[0][2]*Cw[1][2]*Ew[0]*Ew[1] - 24*Cw[0][2]*Cw[2][2]*Ew[0]*Ew[2] - 16*Cw[0][2]*Ew[0]*Ew[0]*Ew[0]*Ew[2] - 8*Cw[0][2]*Ew[0]*Ew[1]*Ew[1]*Ew[2] - 8*Cw[0][2]*Ew[0]*Ew[2]*Ew[2]*Ew[2] - 3*Cw[1][1]*Cw[1][1]*Ew[0]*Ew[0] - 2*Cw[1][1]*Cw[2][2]*Ew[0]*Ew[0] - 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 6*Cw[1][1]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 2*Cw[1][1]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - 4*Cw[1][2]*Cw[1][2]*Ew[0]*Ew[0] - 8*Cw[1][2]*Ew[0]*Ew[0]*Ew[1]*Ew[2] - 3*Cw[2][2]*Cw[2][2]*Ew[0]*Ew[0] - 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 2*Cw[2][2]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 6*Cw[2][2]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[0] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[1]*Ew[1] - 2*Ew[0]*Ew[0]*Ew[0]*Ew[0]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[1]*Ew[1] - 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]*Ew[2]*Ew[2] - Ew[0]*Ew[0]*Ew[2]*Ew[2]*Ew[2]*Ew[2];

    E_wcbKrwcb(1,0) = E_wcbKrwcb(0,1);
    E_wcbKrwcb(2,0) = E_wcbKrwcb(0,2);
    E_wcbKrwcb(3,0) = E_wcbKrwcb(0,3);
    E_wcbKrwcb(4,0) = E_wcbKrwcb(0,4);
    E_wcbKrwcb(5,0) = E_wcbKrwcb(0,5);
    E_wcbKrwcb(6,0) = E_wcbKrwcb(0,6);
    E_wcbKrwcb(7,0) = E_wcbKrwcb(0,7);
    E_wcbKrwcb(8,0) = E_wcbKrwcb(0,8);
    E_wcbKrwcb(2,1) = E_wcbKrwcb(1,2);
    E_wcbKrwcb(3,1) = E_wcbKrwcb(1,3);
    E_wcbKrwcb(4,1) = E_wcbKrwcb(1,4);
    E_wcbKrwcb(5,1) = E_wcbKrwcb(1,5);
    E_wcbKrwcb(6,1) = E_wcbKrwcb(1,6);
    E_wcbKrwcb(7,1) = E_wcbKrwcb(1,7);
    E_wcbKrwcb(8,1) = E_wcbKrwcb(1,8);
    E_wcbKrwcb(3,2) = E_wcbKrwcb(2,3);
    E_wcbKrwcb(4,2) = E_wcbKrwcb(2,4);
    E_wcbKrwcb(5,2) = E_wcbKrwcb(2,5);
    E_wcbKrwcb(6,2) = E_wcbKrwcb(2,6);
    E_wcbKrwcb(7,2) = E_wcbKrwcb(2,7);
    E_wcbKrwcb(8,2) = E_wcbKrwcb(2,8);
    E_wcbKrwcb(4,3) = E_wcbKrwcb(3,4);
    E_wcbKrwcb(5,3) = E_wcbKrwcb(3,5);
    E_wcbKrwcb(6,3) = E_wcbKrwcb(3,6);
    E_wcbKrwcb(7,3) = E_wcbKrwcb(3,7);
    E_wcbKrwcb(8,3) = E_wcbKrwcb(3,8);
    E_wcbKrwcb(5,4) = E_wcbKrwcb(4,5);
    E_wcbKrwcb(6,4) = E_wcbKrwcb(4,6);
    E_wcbKrwcb(7,4) = E_wcbKrwcb(4,7);
    E_wcbKrwcb(8,4) = E_wcbKrwcb(4,8);
    E_wcbKrwcb(6,5) = E_wcbKrwcb(5,6);
    E_wcbKrwcb(7,5) = E_wcbKrwcb(5,7);
    E_wcbKrwcb(8,5) = E_wcbKrwcb(5,8);
    E_wcbKrwcb(7,6) = E_wcbKrwcb(6,7);
    E_wcbKrwcb(8,6) = E_wcbKrwcb(6,8);
    E_wcbKrwcb(8,7) = E_wcbKrwcb(7,8);

    return _E_wcbKrwcb;
}


// func definition
py::array_t<double> calc_E_vCMsq_kron_vCMsq(py::array_t<double> v, py::array_t<double> cov_v){
    // initialize
    py::array_t<double> _E_wsqKrwsq({9,9});
    auto E_wsqKrwsq = _E_wsqKrwsq.mutable_unchecked<2>();
    for (int i=0; i<9; i++){
        for (int j=0; j<9; j++){
            E_wsqKrwsq(i,j) = 0.;
        }
    }
    // convert into std::array
    std::array<double, 3> Ew;
    std::array<std::array<double, 3>, 3> Cw;
    for (int i=0; i<3; i++){
        Ew[i] = *v.data(i);
        for (int j=0; j<3; j++){
            Cw[i][j] = *cov_v.data(i,j);
        }
    }

    // 4th moments are already converted into linear combinations of 2nd moments.
    E_wsqKrwsq(0,0) = 3*Cw[1][1]*Cw[1][1]+ 2*Cw[1][1]*Cw[2][2] + 6*Cw[1][1]*Ew[1]*Ew[1]+ 2*Cw[1][1]*Ew[2]*Ew[2]+ 4*Cw[1][2]*Cw[1][2]+ 8*Cw[1][2]*Ew[1]*Ew[2] + 3*Cw[2][2]*Cw[2][2]+ 2*Cw[2][2]*Ew[1]*Ew[1]+ 6*Cw[2][2]*Ew[2]*Ew[2]+ Ew[1]* Ew[1]* Ew[1]* Ew[1]+ 2*Ew[1]*Ew[1]*Ew[2]*Ew[2]+ Ew[2]* Ew[2]* Ew[2]* Ew[2];
    E_wsqKrwsq(0,1) = -3*Cw[0][1]*Cw[1][1] - Cw[0][1]*Cw[2][2] - 3*Cw[0][1]*Ew[1]*Ew[1]- Cw[0][1]*Ew[2]*Ew[2]- 2*Cw[0][2]*Cw[1][2] - 2*Cw[0][2]*Ew[1]*Ew[2] - 3*Cw[1][1]*Ew[0]*Ew[1] - 2*Cw[1][2]*Ew[0]*Ew[2] - Cw[2][2]*Ew[0]*Ew[1] - Ew[0]*Ew[1]*Ew[1]*Ew[1]- Ew[0]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(0,2) = -2*Cw[0][1]*Cw[1][2] - 2*Cw[0][1]*Ew[1]*Ew[2] - Cw[0][2]*Cw[1][1] - 3*Cw[0][2]*Cw[2][2] - Cw[0][2]*Ew[1]*Ew[1]- 3*Cw[0][2]*Ew[2]*Ew[2]- Cw[1][1]*Ew[0]*Ew[2] - 2*Cw[1][2]*Ew[0]*Ew[1] - 3*Cw[2][2]*Ew[0]*Ew[2] - Ew[0]*Ew[1]*Ew[1]*Ew[2] - Ew[0]*Ew[2]*Ew[2]*Ew[2];
    E_wsqKrwsq(0,3) = -3*Cw[0][1]*Cw[1][1] - Cw[0][1]*Cw[2][2] - 3*Cw[0][1]*Ew[1]*Ew[1]- Cw[0][1]*Ew[2]*Ew[2]- 2*Cw[0][2]*Cw[1][2] - 2*Cw[0][2]*Ew[1]*Ew[2] - 3*Cw[1][1]*Ew[0]*Ew[1] - 2*Cw[1][2]*Ew[0]*Ew[2] - Cw[2][2]*Ew[0]*Ew[1] - Ew[0]*Ew[1]*Ew[1]*Ew[1]- Ew[0]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(0,4) = Cw[0][0]*Cw[1][1] + Cw[0][0]*Ew[1]*Ew[1]+ 2*Cw[0][1]*Cw[0][1]+ 4*Cw[0][1]*Ew[0]*Ew[1] + Cw[1][1]*Ew[0]*Ew[0]+ Ew[0]* Ew[0]*Ew[1]*Ew[1];
    E_wsqKrwsq(0,5) = Cw[0][0]*Cw[1][2] + Cw[0][0]*Ew[1]*Ew[2] + 2*Cw[0][1]*Cw[0][2] + 2*Cw[0][1]*Ew[0]*Ew[2] + 2*Cw[0][2]*Ew[0]*Ew[1] + Cw[1][2]*Ew[0]*Ew[0]+ Ew[0]* Ew[0]*Ew[1]*Ew[2];
    E_wsqKrwsq(0,6) = -2*Cw[0][1]*Cw[1][2] - 2*Cw[0][1]*Ew[1]*Ew[2] - Cw[0][2]*Cw[1][1] - 3*Cw[0][2]*Cw[2][2] - Cw[0][2]*Ew[1]*Ew[1]- 3*Cw[0][2]*Ew[2]*Ew[2]- Cw[1][1]*Ew[0]*Ew[2] - 2*Cw[1][2]*Ew[0]*Ew[1] - 3*Cw[2][2]*Ew[0]*Ew[2] - Ew[0]*Ew[1]*Ew[1]*Ew[2] - Ew[0]*Ew[2]*Ew[2]*Ew[2];
    E_wsqKrwsq(0,7) = Cw[0][0]*Cw[1][2] + Cw[0][0]*Ew[1]*Ew[2] + 2*Cw[0][1]*Cw[0][2] + 2*Cw[0][1]*Ew[0]*Ew[2] + 2*Cw[0][2]*Ew[0]*Ew[1] + Cw[1][2]*Ew[0]*Ew[0]+ Ew[0]* Ew[0]*Ew[1]*Ew[2];
    E_wsqKrwsq(0,8) = Cw[0][0]*Cw[2][2] + Cw[0][0]*Ew[2]*Ew[2]+ 2*Cw[0][2]*Cw[0][2]+ 4*Cw[0][2]*Ew[0]*Ew[2] + Cw[2][2]*Ew[0]*Ew[0]+ Ew[0]* Ew[0]*Ew[2]*Ew[2];
    E_wsqKrwsq(1,1) = Cw[0][0]*Cw[1][1] + Cw[0][0]*Cw[2][2] + Cw[0][0]*Ew[1]*Ew[1]+ Cw[0][0]*Ew[2]*Ew[2]+ 2*Cw[0][1]*Cw[0][1]+ 4*Cw[0][1]*Ew[0]*Ew[1] + 2*Cw[0][2]*Cw[0][2]+ 4*Cw[0][2]*Ew[0]*Ew[2] + Cw[1][1]*Cw[2][2] + Cw[1][1]*Ew[0]*Ew[0]+ Cw[1][1]*Ew[2]*Ew[2]+ 2*Cw[1][2]*Cw[1][2]+ 4*Cw[1][2]*Ew[1]*Ew[2] + 3*Cw[2][2]*Cw[2][2]+ Cw[2][2]*Ew[0]*Ew[0]+ Cw[2][2]*Ew[1]*Ew[1]+ 6*Cw[2][2]*Ew[2]*Ew[2]+ Ew[0]* Ew[0]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]*Ew[2]*Ew[2]+ Ew[1]*Ew[1]*Ew[2]*Ew[2]+ Ew[2]* Ew[2]* Ew[2]* Ew[2];
    E_wsqKrwsq(1,2) = -3*Cw[1][1]*Cw[1][2] - 3*Cw[1][1]*Ew[1]*Ew[2] - 3*Cw[1][2]*Cw[2][2] - 3*Cw[1][2]*Ew[1]*Ew[1]- 3*Cw[1][2]*Ew[2]*Ew[2]- 3*Cw[2][2]*Ew[1]*Ew[2] - Ew[1]* Ew[1]* Ew[1]*Ew[2] - Ew[1]*Ew[2]*Ew[2]*Ew[2];
    E_wsqKrwsq(1,3) = Cw[0][0]*Cw[1][1] + Cw[0][0]*Ew[1]*Ew[1]+ 2*Cw[0][1]*Cw[0][1]+ 4*Cw[0][1]*Ew[0]*Ew[1] + Cw[1][1]*Ew[0]*Ew[0]+ Ew[0]* Ew[0]*Ew[1]*Ew[1];
    E_wsqKrwsq(1,4) = -3*Cw[0][0]*Cw[0][1] - 3*Cw[0][0]*Ew[0]*Ew[1] - Cw[0][1]*Cw[2][2] - 3*Cw[0][1]*Ew[0]*Ew[0]- Cw[0][1]*Ew[2]*Ew[2]- 2*Cw[0][2]*Cw[1][2] - 2*Cw[0][2]*Ew[1]*Ew[2] - 2*Cw[1][2]*Ew[0]*Ew[2] - Cw[2][2]*Ew[0]*Ew[1] - Ew[0]* Ew[0]* Ew[0]*Ew[1] - Ew[0]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(1,5) = 2*Cw[0][1]*Cw[1][2] + 2*Cw[0][1]*Ew[1]*Ew[2] + Cw[0][2]*Cw[1][1] + Cw[0][2]*Ew[1]*Ew[1]+ Cw[1][1]*Ew[0]*Ew[2] + 2*Cw[1][2]*Ew[0]*Ew[1] + Ew[0]*Ew[1]*Ew[1]*Ew[2];
    E_wsqKrwsq(1,6) = Cw[0][0]*Cw[1][2] + Cw[0][0]*Ew[1]*Ew[2] + 2*Cw[0][1]*Cw[0][2] + 2*Cw[0][1]*Ew[0]*Ew[2] + 2*Cw[0][2]*Ew[0]*Ew[1] + Cw[1][2]*Ew[0]*Ew[0]+ Ew[0]* Ew[0]*Ew[1]*Ew[2];
    E_wsqKrwsq(1,7) = -3*Cw[0][0]*Cw[0][2] - 3*Cw[0][0]*Ew[0]*Ew[2] - 3*Cw[0][2]*Cw[2][2] - 3*Cw[0][2]*Ew[0]*Ew[0]- 3*Cw[0][2]*Ew[2]*Ew[2]- 3*Cw[2][2]*Ew[0]*Ew[2] - Ew[0]* Ew[0]* Ew[0]*Ew[2] - Ew[0]*Ew[2]*Ew[2]*Ew[2];
    E_wsqKrwsq(1,8) = Cw[0][1]*Cw[2][2] + Cw[0][1]*Ew[2]*Ew[2]+ 2*Cw[0][2]*Cw[1][2] + 2*Cw[0][2]*Ew[1]*Ew[2] + 2*Cw[1][2]*Ew[0]*Ew[2] + Cw[2][2]*Ew[0]*Ew[1] + Ew[0]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(2,2) = Cw[0][0]*Cw[1][1] + Cw[0][0]*Cw[2][2] + Cw[0][0]*Ew[1]*Ew[1]+ Cw[0][0]*Ew[2]*Ew[2]+ 2*Cw[0][1]*Cw[0][1]+ 4*Cw[0][1]*Ew[0]*Ew[1] + 2*Cw[0][2]*Cw[0][2]+ 4*Cw[0][2]*Ew[0]*Ew[2] + 3*Cw[1][1]*Cw[1][1]+ Cw[1][1]*Cw[2][2] + Cw[1][1]*Ew[0]*Ew[0]+ 6*Cw[1][1]*Ew[1]*Ew[1]+ Cw[1][1]*Ew[2]*Ew[2]+ 2*Cw[1][2]*Cw[1][2]+ 4*Cw[1][2]*Ew[1]*Ew[2] + Cw[2][2]*Ew[0]*Ew[0]+ Cw[2][2]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]*Ew[2]*Ew[2]+ Ew[1]* Ew[1]* Ew[1]* Ew[1]+ Ew[1]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(2,3) = Cw[0][0]*Cw[1][2] + Cw[0][0]*Ew[1]*Ew[2] + 2*Cw[0][1]*Cw[0][2] + 2*Cw[0][1]*Ew[0]*Ew[2] + 2*Cw[0][2]*Ew[0]*Ew[1] + Cw[1][2]*Ew[0]*Ew[0]+ Ew[0]* Ew[0]*Ew[1]*Ew[2];
    E_wsqKrwsq(2,4) = 2*Cw[0][1]*Cw[1][2] + 2*Cw[0][1]*Ew[1]*Ew[2] + Cw[0][2]*Cw[1][1] + Cw[0][2]*Ew[1]*Ew[1]+ Cw[1][1]*Ew[0]*Ew[2] + 2*Cw[1][2]*Ew[0]*Ew[1] + Ew[0]*Ew[1]*Ew[1]*Ew[2];
    E_wsqKrwsq(2,5) = -3*Cw[0][0]*Cw[0][1] - 3*Cw[0][0]*Ew[0]*Ew[1] - 3*Cw[0][1]*Cw[1][1] - 3*Cw[0][1]*Ew[0]*Ew[0]- 3*Cw[0][1]*Ew[1]*Ew[1]- 3*Cw[1][1]*Ew[0]*Ew[1] - Ew[0]* Ew[0]* Ew[0]*Ew[1] - Ew[0]*Ew[1]*Ew[1]*Ew[1];
    E_wsqKrwsq(2,6) = Cw[0][0]*Cw[2][2] + Cw[0][0]*Ew[2]*Ew[2]+ 2*Cw[0][2]*Cw[0][2]+ 4*Cw[0][2]*Ew[0]*Ew[2] + Cw[2][2]*Ew[0]*Ew[0]+ Ew[0]* Ew[0]*Ew[2]*Ew[2];
    E_wsqKrwsq(2,7) = Cw[0][1]*Cw[2][2] + Cw[0][1]*Ew[2]*Ew[2]+ 2*Cw[0][2]*Cw[1][2] + 2*Cw[0][2]*Ew[1]*Ew[2] + 2*Cw[1][2]*Ew[0]*Ew[2] + Cw[2][2]*Ew[0]*Ew[1] + Ew[0]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(2,8) = -3*Cw[0][0]*Cw[0][2] - 3*Cw[0][0]*Ew[0]*Ew[2] - 2*Cw[0][1]*Cw[1][2] - 2*Cw[0][1]*Ew[1]*Ew[2] - Cw[0][2]*Cw[1][1] - 3*Cw[0][2]*Ew[0]*Ew[0]- Cw[0][2]*Ew[1]*Ew[1]- Cw[1][1]*Ew[0]*Ew[2] - 2*Cw[1][2]*Ew[0]*Ew[1] - Ew[0]* Ew[0]* Ew[0]*Ew[2] - Ew[0]*Ew[1]*Ew[1]*Ew[2];
    E_wsqKrwsq(3,3) = Cw[0][0]*Cw[1][1] + Cw[0][0]*Cw[2][2] + Cw[0][0]*Ew[1]*Ew[1]+ Cw[0][0]*Ew[2]*Ew[2]+ 2*Cw[0][1]*Cw[0][1]+ 4*Cw[0][1]*Ew[0]*Ew[1] + 2*Cw[0][2]*Cw[0][2]+ 4*Cw[0][2]*Ew[0]*Ew[2] + Cw[1][1]*Cw[2][2] + Cw[1][1]*Ew[0]*Ew[0]+ Cw[1][1]*Ew[2]*Ew[2]+ 2*Cw[1][2]*Cw[1][2]+ 4*Cw[1][2]*Ew[1]*Ew[2] + 3*Cw[2][2]*Cw[2][2]+ Cw[2][2]*Ew[0]*Ew[0]+ Cw[2][2]*Ew[1]*Ew[1]+ 6*Cw[2][2]*Ew[2]*Ew[2]+ Ew[0]* Ew[0]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]*Ew[2]*Ew[2]+ Ew[1]*Ew[1]*Ew[2]*Ew[2]+ Ew[2]* Ew[2]* Ew[2]* Ew[2];
    E_wsqKrwsq(3,4) = -3*Cw[0][0]*Cw[0][1] - 3*Cw[0][0]*Ew[0]*Ew[1] - Cw[0][1]*Cw[2][2] - 3*Cw[0][1]*Ew[0]*Ew[0]- Cw[0][1]*Ew[2]*Ew[2]- 2*Cw[0][2]*Cw[1][2] - 2*Cw[0][2]*Ew[1]*Ew[2] - 2*Cw[1][2]*Ew[0]*Ew[2] - Cw[2][2]*Ew[0]*Ew[1] - Ew[0]* Ew[0]* Ew[0]*Ew[1] - Ew[0]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(3,5) = -3*Cw[0][0]*Cw[0][2] - 3*Cw[0][0]*Ew[0]*Ew[2] - 3*Cw[0][2]*Cw[2][2] - 3*Cw[0][2]*Ew[0]*Ew[0]- 3*Cw[0][2]*Ew[2]*Ew[2]- 3*Cw[2][2]*Ew[0]*Ew[2] - Ew[0]* Ew[0]* Ew[0]*Ew[2] - Ew[0]*Ew[2]*Ew[2]*Ew[2];
    E_wsqKrwsq(3,6) = -3*Cw[1][1]*Cw[1][2] - 3*Cw[1][1]*Ew[1]*Ew[2] - 3*Cw[1][2]*Cw[2][2] - 3*Cw[1][2]*Ew[1]*Ew[1]- 3*Cw[1][2]*Ew[2]*Ew[2]- 3*Cw[2][2]*Ew[1]*Ew[2] - Ew[1]* Ew[1]* Ew[1]*Ew[2] - Ew[1]*Ew[2]*Ew[2]*Ew[2];
    E_wsqKrwsq(3,7) = 2*Cw[0][1]*Cw[1][2] + 2*Cw[0][1]*Ew[1]*Ew[2] + Cw[0][2]*Cw[1][1] + Cw[0][2]*Ew[1]*Ew[1]+ Cw[1][1]*Ew[0]*Ew[2] + 2*Cw[1][2]*Ew[0]*Ew[1] + Ew[0]*Ew[1]*Ew[1]*Ew[2];
    E_wsqKrwsq(3,8) = Cw[0][1]*Cw[2][2] + Cw[0][1]*Ew[2]*Ew[2]+ 2*Cw[0][2]*Cw[1][2] + 2*Cw[0][2]*Ew[1]*Ew[2] + 2*Cw[1][2]*Ew[0]*Ew[2] + Cw[2][2]*Ew[0]*Ew[1] + Ew[0]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(4,4) = 3*Cw[0][0]*Cw[0][0]+ 2*Cw[0][0]*Cw[2][2] + 6*Cw[0][0]*Ew[0]*Ew[0]+ 2*Cw[0][0]*Ew[2]*Ew[2]+ 4*Cw[0][2]*Cw[0][2]+ 8*Cw[0][2]*Ew[0]*Ew[2] + 3*Cw[2][2]*Cw[2][2]+ 2*Cw[2][2]*Ew[0]*Ew[0]+ 6*Cw[2][2]*Ew[2]*Ew[2]+ Ew[0]* Ew[0]* Ew[0]* Ew[0]+ 2*Ew[0]*Ew[0]*Ew[2]*Ew[2]+ Ew[2]* Ew[2]* Ew[2]* Ew[2];
    E_wsqKrwsq(4,5) = -Cw[0][0]*Cw[1][2] - Cw[0][0]*Ew[1]*Ew[2] - 2*Cw[0][1]*Cw[0][2] - 2*Cw[0][1]*Ew[0]*Ew[2] - 2*Cw[0][2]*Ew[0]*Ew[1] - 3*Cw[1][2]*Cw[2][2] - Cw[1][2]*Ew[0]*Ew[0]- 3*Cw[1][2]*Ew[2]*Ew[2]- 3*Cw[2][2]*Ew[1]*Ew[2] - Ew[0]* Ew[0]*Ew[1]*Ew[2] - Ew[1]*Ew[2]*Ew[2]*Ew[2];
    E_wsqKrwsq(4,6) = 2*Cw[0][1]*Cw[1][2] + 2*Cw[0][1]*Ew[1]*Ew[2] + Cw[0][2]*Cw[1][1] + Cw[0][2]*Ew[1]*Ew[1]+ Cw[1][1]*Ew[0]*Ew[2] + 2*Cw[1][2]*Ew[0]*Ew[1] + Ew[0]*Ew[1]*Ew[1]*Ew[2];
    E_wsqKrwsq(4,7) = -Cw[0][0]*Cw[1][2] - Cw[0][0]*Ew[1]*Ew[2] - 2*Cw[0][1]*Cw[0][2] - 2*Cw[0][1]*Ew[0]*Ew[2] - 2*Cw[0][2]*Ew[0]*Ew[1] - 3*Cw[1][2]*Cw[2][2] - Cw[1][2]*Ew[0]*Ew[0]- 3*Cw[1][2]*Ew[2]*Ew[2]- 3*Cw[2][2]*Ew[1]*Ew[2] - Ew[0]* Ew[0]*Ew[1]*Ew[2] - Ew[1]*Ew[2]*Ew[2]*Ew[2];
    E_wsqKrwsq(4,8) = Cw[1][1]*Cw[2][2] + Cw[1][1]*Ew[2]*Ew[2]+ 2*Cw[1][2]*Cw[1][2]+ 4*Cw[1][2]*Ew[1]*Ew[2] + Cw[2][2]*Ew[1]*Ew[1]+ Ew[1]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(5,5) = 3*Cw[0][0]*Cw[0][0]+ Cw[0][0]*Cw[1][1] + Cw[0][0]*Cw[2][2] + 6*Cw[0][0]*Ew[0]*Ew[0]+ Cw[0][0]*Ew[1]*Ew[1]+ Cw[0][0]*Ew[2]*Ew[2]+ 2*Cw[0][1]*Cw[0][1]+ 4*Cw[0][1]*Ew[0]*Ew[1] + 2*Cw[0][2]*Cw[0][2]+ 4*Cw[0][2]*Ew[0]*Ew[2] + Cw[1][1]*Cw[2][2] + Cw[1][1]*Ew[0]*Ew[0]+ Cw[1][1]*Ew[2]*Ew[2]+ 2*Cw[1][2]*Cw[1][2]+ 4*Cw[1][2]*Ew[1]*Ew[2] + Cw[2][2]*Ew[0]*Ew[0]+ Cw[2][2]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]* Ew[0]* Ew[0]+ Ew[0]* Ew[0]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]*Ew[2]*Ew[2]+ Ew[1]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(5,6) = Cw[0][1]*Cw[2][2] + Cw[0][1]*Ew[2]*Ew[2]+ 2*Cw[0][2]*Cw[1][2] + 2*Cw[0][2]*Ew[1]*Ew[2] + 2*Cw[1][2]*Ew[0]*Ew[2] + Cw[2][2]*Ew[0]*Ew[1] + Ew[0]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(5,7) = Cw[1][1]*Cw[2][2] + Cw[1][1]*Ew[2]*Ew[2]+ 2*Cw[1][2]*Cw[1][2]+ 4*Cw[1][2]*Ew[1]*Ew[2] + Cw[2][2]*Ew[1]*Ew[1]+ Ew[1]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(5,8) = -Cw[0][0]*Cw[1][2] - Cw[0][0]*Ew[1]*Ew[2] - 2*Cw[0][1]*Cw[0][2] - 2*Cw[0][1]*Ew[0]*Ew[2] - 2*Cw[0][2]*Ew[0]*Ew[1] - 3*Cw[1][1]*Cw[1][2] - 3*Cw[1][1]*Ew[1]*Ew[2] - Cw[1][2]*Ew[0]*Ew[0]- 3*Cw[1][2]*Ew[1]*Ew[1]- Ew[0]* Ew[0]*Ew[1]*Ew[2] - Ew[1]* Ew[1]* Ew[1]*Ew[2];
    E_wsqKrwsq(6,6) = Cw[0][0]*Cw[1][1] + Cw[0][0]*Cw[2][2] + Cw[0][0]*Ew[1]*Ew[1]+ Cw[0][0]*Ew[2]*Ew[2]+ 2*Cw[0][1]*Cw[0][1]+ 4*Cw[0][1]*Ew[0]*Ew[1] + 2*Cw[0][2]*Cw[0][2]+ 4*Cw[0][2]*Ew[0]*Ew[2] + 3*Cw[1][1]*Cw[1][1]+ Cw[1][1]*Cw[2][2] + Cw[1][1]*Ew[0]*Ew[0]+ 6*Cw[1][1]*Ew[1]*Ew[1]+ Cw[1][1]*Ew[2]*Ew[2]+ 2*Cw[1][2]*Cw[1][2]+ 4*Cw[1][2]*Ew[1]*Ew[2] + Cw[2][2]*Ew[0]*Ew[0]+ Cw[2][2]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]*Ew[2]*Ew[2]+ Ew[1]* Ew[1]* Ew[1]* Ew[1]+ Ew[1]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(6,7) = -3*Cw[0][0]*Cw[0][1] - 3*Cw[0][0]*Ew[0]*Ew[1] - 3*Cw[0][1]*Cw[1][1] - 3*Cw[0][1]*Ew[0]*Ew[0]- 3*Cw[0][1]*Ew[1]*Ew[1]- 3*Cw[1][1]*Ew[0]*Ew[1] - Ew[0]* Ew[0]* Ew[0]*Ew[1] - Ew[0]*Ew[1]*Ew[1]*Ew[1];
    E_wsqKrwsq(6,8) = -3*Cw[0][0]*Cw[0][2] - 3*Cw[0][0]*Ew[0]*Ew[2] - 2*Cw[0][1]*Cw[1][2] - 2*Cw[0][1]*Ew[1]*Ew[2] - Cw[0][2]*Cw[1][1] - 3*Cw[0][2]*Ew[0]*Ew[0]- Cw[0][2]*Ew[1]*Ew[1]- Cw[1][1]*Ew[0]*Ew[2] - 2*Cw[1][2]*Ew[0]*Ew[1] - Ew[0]* Ew[0]* Ew[0]*Ew[2] - Ew[0]*Ew[1]*Ew[1]*Ew[2];
    E_wsqKrwsq(7,7) = 3*Cw[0][0]*Cw[0][0]+ Cw[0][0]*Cw[1][1] + Cw[0][0]*Cw[2][2] + 6*Cw[0][0]*Ew[0]*Ew[0]+ Cw[0][0]*Ew[1]*Ew[1]+ Cw[0][0]*Ew[2]*Ew[2]+ 2*Cw[0][1]*Cw[0][1]+ 4*Cw[0][1]*Ew[0]*Ew[1] + 2*Cw[0][2]*Cw[0][2]+ 4*Cw[0][2]*Ew[0]*Ew[2] + Cw[1][1]*Cw[2][2] + Cw[1][1]*Ew[0]*Ew[0]+ Cw[1][1]*Ew[2]*Ew[2]+ 2*Cw[1][2]*Cw[1][2]+ 4*Cw[1][2]*Ew[1]*Ew[2] + Cw[2][2]*Ew[0]*Ew[0]+ Cw[2][2]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]* Ew[0]* Ew[0]+ Ew[0]* Ew[0]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]*Ew[2]*Ew[2]+ Ew[1]*Ew[1]*Ew[2]*Ew[2];
    E_wsqKrwsq(7,8) = -Cw[0][0]*Cw[1][2] - Cw[0][0]*Ew[1]*Ew[2] - 2*Cw[0][1]*Cw[0][2] - 2*Cw[0][1]*Ew[0]*Ew[2] - 2*Cw[0][2]*Ew[0]*Ew[1] - 3*Cw[1][1]*Cw[1][2] - 3*Cw[1][1]*Ew[1]*Ew[2] - Cw[1][2]*Ew[0]*Ew[0]- 3*Cw[1][2]*Ew[1]*Ew[1]- Ew[0]* Ew[0]*Ew[1]*Ew[2] - Ew[1]* Ew[1]* Ew[1]*Ew[2];
    E_wsqKrwsq(8,8) = 3*Cw[0][0]*Cw[0][0]+ 2*Cw[0][0]*Cw[1][1] + 6*Cw[0][0]*Ew[0]*Ew[0]+ 2*Cw[0][0]*Ew[1]*Ew[1]+ 4*Cw[0][1]*Cw[0][1]+ 8*Cw[0][1]*Ew[0]*Ew[1] + 3*Cw[1][1]*Cw[1][1]+ 2*Cw[1][1]*Ew[0]*Ew[0]+ 6*Cw[1][1]*Ew[1]*Ew[1]+ Ew[0]* Ew[0]* Ew[0]* Ew[0]+ 2*Ew[0]*Ew[0]*Ew[1]*Ew[1]+ Ew[1]* Ew[1]* Ew[1]* Ew[1];

    E_wsqKrwsq(1,0) = E_wsqKrwsq(0,1);
    E_wsqKrwsq(2,0) = E_wsqKrwsq(0,2);
    E_wsqKrwsq(3,0) = E_wsqKrwsq(0,3);
    E_wsqKrwsq(4,0) = E_wsqKrwsq(0,4);
    E_wsqKrwsq(5,0) = E_wsqKrwsq(0,5);
    E_wsqKrwsq(6,0) = E_wsqKrwsq(0,6);
    E_wsqKrwsq(7,0) = E_wsqKrwsq(0,7);
    E_wsqKrwsq(8,0) = E_wsqKrwsq(0,8);
    E_wsqKrwsq(2,1) = E_wsqKrwsq(1,2);
    E_wsqKrwsq(3,1) = E_wsqKrwsq(1,3);
    E_wsqKrwsq(4,1) = E_wsqKrwsq(1,4);
    E_wsqKrwsq(5,1) = E_wsqKrwsq(1,5);
    E_wsqKrwsq(6,1) = E_wsqKrwsq(1,6);
    E_wsqKrwsq(7,1) = E_wsqKrwsq(1,7);
    E_wsqKrwsq(8,1) = E_wsqKrwsq(1,8);
    E_wsqKrwsq(3,2) = E_wsqKrwsq(2,3);
    E_wsqKrwsq(4,2) = E_wsqKrwsq(2,4);
    E_wsqKrwsq(5,2) = E_wsqKrwsq(2,5);
    E_wsqKrwsq(6,2) = E_wsqKrwsq(2,6);
    E_wsqKrwsq(7,2) = E_wsqKrwsq(2,7);
    E_wsqKrwsq(8,2) = E_wsqKrwsq(2,8);
    E_wsqKrwsq(4,3) = E_wsqKrwsq(3,4);
    E_wsqKrwsq(5,3) = E_wsqKrwsq(3,5);
    E_wsqKrwsq(6,3) = E_wsqKrwsq(3,6);
    E_wsqKrwsq(7,3) = E_wsqKrwsq(3,7);
    E_wsqKrwsq(8,3) = E_wsqKrwsq(3,8);
    E_wsqKrwsq(5,4) = E_wsqKrwsq(4,5);
    E_wsqKrwsq(6,4) = E_wsqKrwsq(4,6);
    E_wsqKrwsq(7,4) = E_wsqKrwsq(4,7);
    E_wsqKrwsq(8,4) = E_wsqKrwsq(4,8);
    E_wsqKrwsq(6,5) = E_wsqKrwsq(5,6);
    E_wsqKrwsq(7,5) = E_wsqKrwsq(5,7);
    E_wsqKrwsq(8,5) = E_wsqKrwsq(5,8);
    E_wsqKrwsq(7,6) = E_wsqKrwsq(6,7);
    E_wsqKrwsq(8,6) = E_wsqKrwsq(6,8);
    E_wsqKrwsq(8,7) = E_wsqKrwsq(7,8);

    return _E_wsqKrwsq;
}


// func definition
py::array_t<double> calc_E_vCM_kron_vCM(py::array_t<double> v, py::array_t<double> cov_v){
    // initialize
    py::array_t<double> _E_wKrw({9,9});
    auto E_wKrw = _E_wKrw.mutable_unchecked<2>();
    for (int i=0; i<9; i++){
        for (int j=0; j<9; j++){
            E_wKrw(i,j) = 0.;
        }
    }
    // convert into std::array
    std::array<double, 3> Ew;
    std::array<std::array<double, 3>, 3> Cw;
    for (int i=0; i<3; i++){
        Ew[i] = *v.data(i);
        for (int j=0; j<3; j++){
            Cw[i][j] = *cov_v.data(i,j);
        }
    }

    E_wKrw(0,4) = Cw[2][2] + Ew[2]*Ew[2];
    E_wKrw(0,5) = -Cw[1][2] - Ew[1]*Ew[2];
    E_wKrw(0,7) = -Cw[1][2] - Ew[1]*Ew[2];
    E_wKrw(0,8) = Cw[1][1] + Ew[1]*Ew[1];
    E_wKrw(1,3) = -Cw[2][2] - Ew[2]*Ew[2];
    E_wKrw(1,5) = Cw[0][2] + Ew[0]*Ew[2];
    E_wKrw(1,6) = Cw[1][2] + Ew[1]*Ew[2];
    E_wKrw(1,8) = -Cw[0][1] - Ew[0]*Ew[1];
    E_wKrw(2,3) = Cw[1][2] + Ew[1]*Ew[2];
    E_wKrw(2,4) = -Cw[0][2] - Ew[0]*Ew[2];
    E_wKrw(2,6) = -Cw[1][1] - Ew[1]*Ew[1];
    E_wKrw(2,7) = Cw[0][1] + Ew[0]*Ew[1];
    E_wKrw(3,7) = Cw[0][2] + Ew[0]*Ew[2];
    E_wKrw(3,8) = -Cw[0][1] - Ew[0]*Ew[1];
    E_wKrw(4,6) = -Cw[0][2] - Ew[0]*Ew[2];
    E_wKrw(4,8) = Cw[0][0] + Ew[0]* Ew[0];
    E_wKrw(5,6) = Cw[0][1] + Ew[0]*Ew[1];
    E_wKrw(5,7) = -Cw[0][0] - Ew[0]* Ew[0];

    E_wKrw(1,0) = E_wKrw(0,1);
    E_wKrw(2,0) = E_wKrw(0,2);
    E_wKrw(3,0) = E_wKrw(0,3);
    E_wKrw(4,0) = E_wKrw(0,4);
    E_wKrw(5,0) = E_wKrw(0,5);
    E_wKrw(6,0) = E_wKrw(0,6);
    E_wKrw(7,0) = E_wKrw(0,7);
    E_wKrw(8,0) = E_wKrw(0,8);
    E_wKrw(2,1) = E_wKrw(1,2);
    E_wKrw(3,1) = E_wKrw(1,3);
    E_wKrw(4,1) = E_wKrw(1,4);
    E_wKrw(5,1) = E_wKrw(1,5);
    E_wKrw(6,1) = E_wKrw(1,6);
    E_wKrw(7,1) = E_wKrw(1,7);
    E_wKrw(8,1) = E_wKrw(1,8);
    E_wKrw(3,2) = E_wKrw(2,3);
    E_wKrw(4,2) = E_wKrw(2,4);
    E_wKrw(5,2) = E_wKrw(2,5);
    E_wKrw(6,2) = E_wKrw(2,6);
    E_wKrw(7,2) = E_wKrw(2,7);
    E_wKrw(8,2) = E_wKrw(2,8);
    E_wKrw(4,3) = E_wKrw(3,4);
    E_wKrw(5,3) = E_wKrw(3,5);
    E_wKrw(6,3) = E_wKrw(3,6);
    E_wKrw(7,3) = E_wKrw(3,7);
    E_wKrw(8,3) = E_wKrw(3,8);
    E_wKrw(5,4) = E_wKrw(4,5);
    E_wKrw(6,4) = E_wKrw(4,6);
    E_wKrw(7,4) = E_wKrw(4,7);
    E_wKrw(8,4) = E_wKrw(4,8);
    E_wKrw(6,5) = E_wKrw(5,6);
    E_wKrw(7,5) = E_wKrw(5,7);
    E_wKrw(8,5) = E_wKrw(5,8);
    E_wKrw(7,6) = E_wKrw(6,7);
    E_wKrw(8,6) = E_wKrw(6,8);
    E_wKrw(8,7) = E_wKrw(7,8);

    return _E_wKrw;
}


// func definition
py::array_t<double> calc_translation_observation_1stmoment(
    py::array_t<double> E_q4th,
    py::array_t<double> gyro_i,
    py::array_t<double> gyro_j,
    py::array_t<double> _joint_wrt_i,
    py::array_t<double> _joint_wrt_j){
    
    // fourth moments
    double E_q4000 = *E_q4th.data(0);
    double E_q3100 = *E_q4th.data(1);
    double E_q2200 = *E_q4th.data(2);
    double E_q1300 = *E_q4th.data(3);
    double E_q0400 = *E_q4th.data(4);
    double E_q3010 = *E_q4th.data(5);
    double E_q2110 = *E_q4th.data(6);
    double E_q1210 = *E_q4th.data(7);
    double E_q0310 = *E_q4th.data(8);
    double E_q2020 = *E_q4th.data(9);
    double E_q1120 = *E_q4th.data(10);
    double E_q0220 = *E_q4th.data(11);
    double E_q1030 = *E_q4th.data(12);
    double E_q0130 = *E_q4th.data(13);
    double E_q0040 = *E_q4th.data(14);
    double E_q3001 = *E_q4th.data(15);
    double E_q2101 = *E_q4th.data(16);
    double E_q1201 = *E_q4th.data(17);
    double E_q0301 = *E_q4th.data(18);
    double E_q2011 = *E_q4th.data(19);
    double E_q1111 = *E_q4th.data(20);
    double E_q0211 = *E_q4th.data(21);
    double E_q1021 = *E_q4th.data(22);
    double E_q0121 = *E_q4th.data(23);
    double E_q0031 = *E_q4th.data(24);
    double E_q2002 = *E_q4th.data(25);
    double E_q1102 = *E_q4th.data(26);
    double E_q0202 = *E_q4th.data(27);
    double E_q1012 = *E_q4th.data(28);
    double E_q0112 = *E_q4th.data(29);
    double E_q0022 = *E_q4th.data(30);
    double E_q1003 = *E_q4th.data(31);
    double E_q0103 = *E_q4th.data(32);
    double E_q0013 = *E_q4th.data(33);
    double E_q0004 = *E_q4th.data(34);

    // initialize
    py::array_t<double> _E_obsv(6);
    auto E_obsv = _E_obsv.mutable_unchecked<1>();

    // convert into std::array
    std::array<double, 3> Ewi;
    std::array<double, 3> Ewj;
    std::array<double, 3> joint_wrt_i;
    std::array<double, 3> joint_wrt_j;
    for (int i=0; i<3; i++){
        Ewi[i] = *gyro_i.data(i);
        Ewj[i] = *gyro_j.data(i);
        joint_wrt_i[i] = *_joint_wrt_i.data(i);
        joint_wrt_j[i] = *_joint_wrt_j.data(i);
    }

    // set elements
    E_obsv(0) = joint_wrt_i[0] + joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);
    E_obsv(1) = joint_wrt_i[1] - 2*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100);
    E_obsv(2) = joint_wrt_i[2] - 2*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000);
    E_obsv(3) = Ewi[1]*joint_wrt_i[2] - Ewi[2]*joint_wrt_i[1] - 2*Ewj[0]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewj[0]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 2*Ewj[0]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewj[0]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*Ewj[1]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewj[1]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + Ewj[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[2]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewj[2]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewj[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewj[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000);
    E_obsv(4) = -Ewi[0]*joint_wrt_i[2] + Ewi[2]*joint_wrt_i[0] - 2*Ewj[0]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewj[0]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewj[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[1]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewj[1]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewj[1]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewj[1]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + Ewj[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewj[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[2]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewj[2]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001);
    E_obsv(5) = Ewi[0]*joint_wrt_i[1] - Ewi[1]*joint_wrt_i[0] - Ewj[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewj[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[0]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewj[0]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewj[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[1]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewj[1]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewj[2]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewj[2]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + 2*Ewj[2]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewj[2]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);

    return _E_obsv;
}


// func definition
py::array_t<double> calc_translation_observation_2ndmoment(
    py::array_t<double> E_q4th,
    py::array_t<double> gyro_i,
    py::array_t<double> gyro_j,
    py::array_t<double> gyro_noisecov_i,
    py::array_t<double> gyro_noisecov_j,
    py::array_t<double> _joint_wrt_i,
    py::array_t<double> _joint_wrt_j){
    
    // fourth moments
    double E_q4000 = *E_q4th.data(0);
    double E_q3100 = *E_q4th.data(1);
    double E_q2200 = *E_q4th.data(2);
    double E_q1300 = *E_q4th.data(3);
    double E_q0400 = *E_q4th.data(4);
    double E_q3010 = *E_q4th.data(5);
    double E_q2110 = *E_q4th.data(6);
    double E_q1210 = *E_q4th.data(7);
    double E_q0310 = *E_q4th.data(8);
    double E_q2020 = *E_q4th.data(9);
    double E_q1120 = *E_q4th.data(10);
    double E_q0220 = *E_q4th.data(11);
    double E_q1030 = *E_q4th.data(12);
    double E_q0130 = *E_q4th.data(13);
    double E_q0040 = *E_q4th.data(14);
    double E_q3001 = *E_q4th.data(15);
    double E_q2101 = *E_q4th.data(16);
    double E_q1201 = *E_q4th.data(17);
    double E_q0301 = *E_q4th.data(18);
    double E_q2011 = *E_q4th.data(19);
    double E_q1111 = *E_q4th.data(20);
    double E_q0211 = *E_q4th.data(21);
    double E_q1021 = *E_q4th.data(22);
    double E_q0121 = *E_q4th.data(23);
    double E_q0031 = *E_q4th.data(24);
    double E_q2002 = *E_q4th.data(25);
    double E_q1102 = *E_q4th.data(26);
    double E_q0202 = *E_q4th.data(27);
    double E_q1012 = *E_q4th.data(28);
    double E_q0112 = *E_q4th.data(29);
    double E_q0022 = *E_q4th.data(30);
    double E_q1003 = *E_q4th.data(31);
    double E_q0103 = *E_q4th.data(32);
    double E_q0013 = *E_q4th.data(33);
    double E_q0004 = *E_q4th.data(34);

    // initialize
    py::array_t<double> _E_OOT({6,6});
    auto E_OOT = _E_OOT.mutable_unchecked<2>();

    // convert into std::array
    std::array<double, 3> Ewi;
    std::array<double, 3> Ewj;
    std::array<std::array<double, 3>, 3> Cwi;
    std::array<std::array<double, 3>, 3> Cwj;
    std::array<double, 3> joint_wrt_i;
    std::array<double, 3> joint_wrt_j;
    for (int i=0; i<3; i++){
        Ewi[i] = *gyro_i.data(i);
        Ewj[i] = *gyro_j.data(i);
        joint_wrt_i[i] = *_joint_wrt_i.data(i);
        joint_wrt_j[i] = *_joint_wrt_j.data(i);
        for (int j=0; j<3; j++){
            Cwi[i][j] = *gyro_noisecov_i.data(i,j);
            Cwj[i][j] = *gyro_noisecov_j.data(i,j);
        }
    }

    // set elements
    // NW parts
    double elem_0 = E_q0004*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0022*joint_wrt_j[0]*joint_wrt_j[0]+ E_q0040*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q0103*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0112*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0121*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0130*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0202*joint_wrt_j[0]*joint_wrt_j[0];
    double elem_1 = + 4*E_q0202*joint_wrt_j[2]*joint_wrt_j[2]+ 8*E_q0211*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0220*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0220*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0301*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0310*joint_wrt_j[0]*joint_wrt_j[1] + E_q0400*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1003*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1012*joint_wrt_j[0]*joint_wrt_j[2] ;
    double elem_2 = + 4*E_q1021*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1030*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1102*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q1111*joint_wrt_j[1]*joint_wrt_j[1]+ 8*E_q1111*joint_wrt_j[2]*joint_wrt_j[2]+ 8*E_q1120*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1201*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1210*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q2002*joint_wrt_j[0]*joint_wrt_j[0];
    double elem_3 = + 4*E_q2002*joint_wrt_j[1]*joint_wrt_j[1]- 8*E_q2011*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q2020*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q2020*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2101*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2110*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2200*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q3001*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q3010*joint_wrt_j[0]*joint_wrt_j[2] + E_q4000*joint_wrt_j[0]*joint_wrt_j[0];
    double elem_4 = + joint_wrt_i[0]* joint_wrt_i[0]+ 2*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + 2*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - 2*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - 2*joint_wrt_i[0]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 4*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) ;
    E_OOT(0,0) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + 4*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 4*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 4*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);

    elem_0 = E_q0004*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0013*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0031*joint_wrt_j[0]*joint_wrt_j[2] - E_q0040*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0103*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0112*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0112*joint_wrt_j[1]*joint_wrt_j[1];
    elem_1 = + 4*E_q0112*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q0121*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0130*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0130*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q0211*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0220*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0301*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_2 = + 2*E_q0310*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0310*joint_wrt_j[1]*joint_wrt_j[1]- E_q0400*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1003*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1003*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q1012*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1021*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1021*joint_wrt_j[1]*joint_wrt_j[1];
    elem_3 = + 4*E_q1021*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1030*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1102*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1120*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1201*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1201*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1201*joint_wrt_j[2]*joint_wrt_j[2]- 6*E_q1210*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1300*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q2002*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_4 = + 6*E_q2011*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q2101*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2110*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2110*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2110*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q3001*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q3001*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q3010*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3100*joint_wrt_j[0]*joint_wrt_j[2] + E_q4000*joint_wrt_j[0]*joint_wrt_j[1] + joint_wrt_i[0]*joint_wrt_i[1] - 2*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) ;
    double elem_5 = + joint_wrt_i[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - joint_wrt_i[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + joint_wrt_i[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - joint_wrt_i[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + joint_wrt_i[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + joint_wrt_i[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - joint_wrt_i[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - joint_wrt_i[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) ;
    E_OOT(0,1) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + 2*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);

    elem_0 = -E_q0004*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0013*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0031*joint_wrt_j[0]*joint_wrt_j[1] + E_q0040*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0103*joint_wrt_j[0]*joint_wrt_j[0];
    elem_1 = + 2*E_q0103*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q0112*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0121*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0121*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0121*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0130*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_2 = + 6*E_q0202*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0211*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0301*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0301*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0310*joint_wrt_j[1]*joint_wrt_j[2] - E_q0400*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1003*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_3 = + 2*E_q1012*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1012*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1012*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q1021*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1030*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1030*joint_wrt_j[2]*joint_wrt_j[2]- 6*E_q1102*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1120*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_4 = + 6*E_q1201*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1210*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1210*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1210*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1300*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q2011*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q2020*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2101*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q2101*joint_wrt_j[1]*joint_wrt_j[1];
    elem_5 = + 2*E_q2101*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q2110*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3001*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3010*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q3010*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q3100*joint_wrt_j[0]*joint_wrt_j[1] + E_q4000*joint_wrt_j[0]*joint_wrt_j[2] + joint_wrt_i[0]*joint_wrt_i[2] - 2*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) ;
    double elem_6 = + 2*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - joint_wrt_i[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + joint_wrt_i[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + joint_wrt_i[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - joint_wrt_i[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) ;
    double elem_7 = + joint_wrt_i[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + joint_wrt_i[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - joint_wrt_i[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - joint_wrt_i[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) ;
    E_OOT(0,2) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + 2*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);

    elem_0 = E_q0004*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0013*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0022*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0022*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0031*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_1 = + E_q0040*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0112*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q0121*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0130*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0202*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0211*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_2 = + 4*E_q0220*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0220*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0310*joint_wrt_j[0]*joint_wrt_j[1] + E_q0400*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1003*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q1012*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1021*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_3 = + 4*E_q1102*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q1111*joint_wrt_j[0]*joint_wrt_j[0]- 8*E_q1111*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1120*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1201*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q1210*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1300*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_4 = + 4*E_q2002*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2002*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q2011*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2020*joint_wrt_j[1]*joint_wrt_j[1]- 8*E_q2101*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2110*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q2200*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q2200*joint_wrt_j[2]*joint_wrt_j[2];
    elem_5 = + 4*E_q3001*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q3100*joint_wrt_j[1]*joint_wrt_j[2] + E_q4000*joint_wrt_j[1]*joint_wrt_j[1]+ joint_wrt_i[1]* joint_wrt_i[1]- 4*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 4*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - 2*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    elem_6 = + 2*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - 2*joint_wrt_i[1]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 4*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) ;
    E_OOT(1,1) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + 4*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100);

    elem_0 = -E_q0004*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0013*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0013*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q0022*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0031*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0031*joint_wrt_j[2]*joint_wrt_j[2]- E_q0040*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0103*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_1 = + 6*E_q0112*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0121*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0130*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0211*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0211*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0211*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0301*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0310*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_2 = + E_q0400*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1003*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1012*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1021*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1030*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1102*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1102*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1102*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1120*joint_wrt_j[0]*joint_wrt_j[0];
    elem_3 = + 2*E_q1120*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1120*joint_wrt_j[2]*joint_wrt_j[2]- 6*E_q1201*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1210*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1300*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1300*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2011*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2011*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q2011*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q2101*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_4 = + 6*E_q2110*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q2200*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3001*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q3010*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q3100*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q3100*joint_wrt_j[2]*joint_wrt_j[2]+ E_q4000*joint_wrt_j[1]*joint_wrt_j[2] + joint_wrt_i[1]*joint_wrt_i[2] - 2*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - joint_wrt_i[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    elem_5 = + joint_wrt_i[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + joint_wrt_i[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - joint_wrt_i[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + joint_wrt_i[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - joint_wrt_i[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + joint_wrt_i[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - joint_wrt_i[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) ;
    E_OOT(1,2) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + 2*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100);

    elem_0 = E_q0004*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0013*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0022*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0022*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0031*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_1 = + E_q0040*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0103*joint_wrt_j[0]*joint_wrt_j[2] + 8*E_q0112*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0121*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0202*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0202*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0211*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_2 = + 2*E_q0220*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0301*joint_wrt_j[0]*joint_wrt_j[2] + E_q0400*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1012*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1021*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1030*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1102*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q1111*joint_wrt_j[0]*joint_wrt_j[0];
    elem_3 = + 8*E_q1111*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1120*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q1201*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1210*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1300*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2002*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2011*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2020*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2020*joint_wrt_j[2]*joint_wrt_j[2];
    elem_4 = + 4*E_q2101*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q2110*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2200*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q2200*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q3010*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q3100*joint_wrt_j[1]*joint_wrt_j[2] + E_q4000*joint_wrt_j[2]*joint_wrt_j[2]+ joint_wrt_i[2]* joint_wrt_i[2]- 4*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) ;
    elem_5 = + 4*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 4*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 4*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    E_OOT(2,2) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + 2*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + 2*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - 2*joint_wrt_i[2]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000);


    // NE parts
    elem_0 = E_q0004*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0004*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0022*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0022*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0040*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0040*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0103*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_1 = + 2*E_q0103*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0103*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q0103*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0112*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0112*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0112*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0112*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0121*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_2 = + 2*E_q0121*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0121*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q0121*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0130*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0130*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0130*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0130*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0202*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q0202*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_3 = + 2*E_q0202*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0211*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0211*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0211*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0211*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0220*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0220*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0220*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0301*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0301*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_4 = + 2*E_q0301*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0301*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0310*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0310*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0310*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0310*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ E_q0400*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0400*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1003*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1003*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1003*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1003*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1012*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_5 = + 2*E_q1012*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1012*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1012*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1021*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1021*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1021*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1021*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1030*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1030*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1030*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1030*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1102*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1102*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_6 = + 4*E_q1102*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1102*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 16*E_q1111*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q1111*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1111*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1120*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1120*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1120*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1120*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1201*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1201*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1201*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1201*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_7 = + 2*E_q1210*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1210*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1210*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1210*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q2002*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q2002*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q2002*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2011*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q2011*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2011*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2011*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2020*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q2020*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2020*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] ;
    double elem_8 = + 2*E_q2101*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q2101*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2101*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q2101*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q2110*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2110*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2110*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2110*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q2200*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q2200*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q3001*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q3001*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3001*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q3001*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q3010*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3010*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0];
    double elem_9 = + 2*E_q3010*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q3010*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + E_q4000*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - E_q4000*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + Ewi[1]*joint_wrt_i[0]*joint_wrt_i[2] + Ewi[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - Ewi[2]*joint_wrt_i[0]*joint_wrt_i[1] - Ewi[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    double elem_10 = + Ewi[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 2*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) ;
    double elem_11 = + 2*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    E_OOT(0,3) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000);

    elem_0 = -E_q0004*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + E_q0004*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0013*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0013*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0031*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_1 = + 2*E_q0031*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ E_q0040*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0040*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0103*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0103*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0112*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q0112*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_2 = + 4*E_q0121*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0121*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0121*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0121*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0130*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0130*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0130*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_3 = + 2*E_q0211*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0211*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0211*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0211*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0220*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0220*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0220*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q0220*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_4 = + 2*E_q0301*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0301*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0310*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0310*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0310*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0400*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0400*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1003*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1003*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_5 = + 4*E_q1003*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1012*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1012*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1012*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1012*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1021*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1021*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1030*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1030*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_6 = + 2*E_q1102*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1102*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1102*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1102*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1120*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1120*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1120*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1120*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1201*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1201*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1210*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_7 = + 2*E_q1210*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1210*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1210*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1300*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1300*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2002*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q2002*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q2002*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q2002*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q2011*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q2011*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q2011*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2011*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_8 = + 4*E_q2101*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q2101*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2101*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2101*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q2110*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q2110*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3001*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3001*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q3001*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3010*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q3010*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q3100*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q3100*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- E_q4000*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_9 = + E_q4000*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- Ewi[0]*joint_wrt_i[0]*joint_wrt_i[2] - Ewi[0]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[0]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[0]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[0]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) ;
    elem_10 = + Ewi[2]*joint_wrt_i[0]*joint_wrt_i[0]+ Ewi[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) ;
    elem_11 = + 2*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    double elem_12 = + Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) ;
    E_OOT(0,4) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + 2*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001);

    elem_0 = -E_q0004*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0004*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0013*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0013*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0031*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0031*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_1 = + E_q0040*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - E_q0040*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0103*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0103*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0103*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0112*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0112*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0112*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_2 = + 4*E_q0112*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q0121*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q0121*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0130*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0130*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0202*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0202*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0202*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0202*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0211*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_3 = + 4*E_q0211*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0211*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q0211*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0301*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0301*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0301*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0310*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0310*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - E_q0400*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0400*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1003*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_4 = + 2*E_q1003*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q1012*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1012*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1021*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1021*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1021*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1021*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1030*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1030*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1030*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1102*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1102*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1102*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_5 = + 4*E_q1102*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1120*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1120*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1120*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1120*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1201*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1201*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1201*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1201*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1210*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1210*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1300*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1300*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2011*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_6 = + 4*E_q2011*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2011*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q2011*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q2020*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2020*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q2020*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2020*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q2101*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q2101*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2110*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2110*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q2110*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2110*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q3001*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q3001*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_7 = + 2*E_q3010*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q3010*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3010*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3100*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3100*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ E_q4000*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - E_q4000*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ Ewi[0]*joint_wrt_i[0]*joint_wrt_i[1] + Ewi[0]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[0]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[0]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[0]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) ;
    elem_8 = + 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - Ewi[1]*joint_wrt_i[0]*joint_wrt_i[0]- Ewi[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) ;
    elem_9 = + 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) ;
    elem_10 = + 2*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) ;
    E_OOT(0,5) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + 2*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);

    elem_0 = E_q0004*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0004*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0013*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q0013*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0031*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_1 = + 2*E_q0031*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0040*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0040*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0103*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0103*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_2 = + 6*E_q0112*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q0112*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0121*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0121*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0121*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_3 = + 4*E_q0121*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0130*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0130*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0130*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0211*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0211*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_4 = + 2*E_q0211*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0211*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0220*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0220*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0220*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0220*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0301*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_5 = + 2*E_q0301*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0310*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0310*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0310*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - E_q0400*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0400*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1003*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1003*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_6 = + 4*E_q1003*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1012*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1012*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1012*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1012*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1021*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1021*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1030*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1030*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_7 = + 4*E_q1102*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1102*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1102*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1102*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1120*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1120*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1120*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1120*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1201*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1201*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1210*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_8 = + 4*E_q1210*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1210*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1210*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1300*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1300*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2002*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q2002*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q2002*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2002*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q2011*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2011*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2011*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q2011*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_9 = + 2*E_q2101*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2101*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q2101*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2101*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q2110*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q2110*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3001*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3001*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q3001*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q3010*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q3010*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3100*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q3100*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_10 = + E_q4000*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - E_q4000*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ Ewi[1]*joint_wrt_i[1]*joint_wrt_i[2] - 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + Ewi[1]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[1]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[1]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[1]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) ;
    elem_11 = + 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewi[2]*joint_wrt_i[1]*joint_wrt_i[1]+ 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) ;
    elem_12 = + 2*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    E_OOT(1,3) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000);

    elem_0 = -E_q0004*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0004*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0013*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0013*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q0013*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0013*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_1 = + 6*E_q0022*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0022*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0022*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0031*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0031*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0031*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_2 = + 2*E_q0031*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0040*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0040*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0112*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0112*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0112*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0112*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_3 = + 4*E_q0121*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0121*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0121*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0121*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0130*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0130*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0130*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0130*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0202*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_4 = + 2*E_q0202*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0211*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0211*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q0211*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0211*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0220*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0220*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q0220*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0310*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0310*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0310*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_5 = + 2*E_q0310*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- E_q0400*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0400*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1003*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1003*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1003*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1003*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1012*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1012*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1012*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1012*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1021*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_6 = + 2*E_q1021*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1021*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1021*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1102*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1102*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1102*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1102*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1111*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 16*E_q1111*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1111*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1120*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1120*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_7 = + 2*E_q1120*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1120*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1201*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1201*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1201*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1201*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1210*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1210*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1210*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1210*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1300*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1300*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1300*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_8 = + 2*E_q1300*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2002*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2002*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q2002*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2011*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q2011*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q2011*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2011*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q2020*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2020*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2101*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2101*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q2101*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_9 = + 4*E_q2101*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q2110*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2110*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2110*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2110*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q2200*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q2200*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q2200*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3001*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3001*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3001*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q3001*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q3100*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q3100*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_10 = + 2*E_q3100*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3100*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - E_q4000*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + E_q4000*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - Ewi[0]*joint_wrt_i[1]*joint_wrt_i[2] + 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) ;
    elem_11 = + 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewi[2]*joint_wrt_i[0]*joint_wrt_i[1] - 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + Ewi[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) ;
    elem_12 = + 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) ;
    double elem_13 = + Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) ;
    E_OOT(1,4) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + elem_13 + 2*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001);

    elem_0 = -E_q0004*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ E_q0004*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0013*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0013*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0013*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_1 = + 2*E_q0022*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0022*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0022*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0022*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0031*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_2 = + 2*E_q0031*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0031*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - E_q0040*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ E_q0040*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0103*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0103*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_3 = + 2*E_q0112*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0112*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0112*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0112*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0121*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0121*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_4 = + 4*E_q0121*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0121*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0130*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0130*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 6*E_q0211*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q0211*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0301*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_5 = + 2*E_q0301*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0310*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0310*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ E_q0400*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- E_q0400*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1003*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1003*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1012*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_6 = + 2*E_q1012*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1012*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1012*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1021*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1021*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1021*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1021*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1030*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_7 = + 2*E_q1030*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q1102*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1102*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1120*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1120*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1201*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1201*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1201*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_8 = + 4*E_q1201*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1210*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1210*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1210*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1210*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1300*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1300*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1300*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q2011*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_9 = + 6*E_q2011*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2101*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2101*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2101*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2101*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q2110*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q2110*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q2110*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2110*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q2200*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_10 = + 4*E_q2200*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q2200*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2200*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3001*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3001*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q3010*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3010*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q3100*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3100*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3100*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_11 = + E_q4000*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- E_q4000*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + Ewi[0]*joint_wrt_i[1]*joint_wrt_i[1]- 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + Ewi[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) ;
    elem_12 = + 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewi[1]*joint_wrt_i[0]*joint_wrt_i[1] + 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[1]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[1]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[1]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[1]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    elem_13 = + Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) ;
    E_OOT(1,5) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + elem_13 + 2*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);

    elem_0 = -E_q0004*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ E_q0004*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0013*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0013*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0031*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_1 = + 2*E_q0031*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ E_q0040*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- E_q0040*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0103*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0103*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_2 = + 2*E_q0103*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0112*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0112*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0112*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0112*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q0121*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_3 = + 6*E_q0121*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0130*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0130*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0202*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0202*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0202*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0202*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0211*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_4 = + 2*E_q0211*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0211*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0211*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0301*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0301*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0301*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0310*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0310*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0400*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_5 = + E_q0400*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1003*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1003*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1012*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1012*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1021*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1021*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1021*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1021*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1030*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_6 = + 4*E_q1030*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1030*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1102*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1102*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1102*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1102*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1120*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1120*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1120*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1120*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_7 = + 4*E_q1201*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1201*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1201*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1201*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1210*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1210*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1300*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1300*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2011*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2011*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_8 = + 4*E_q2011*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2011*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2020*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2020*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2020*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q2020*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q2101*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q2101*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2110*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q2110*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2110*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_9 = + 2*E_q2110*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3001*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q3001*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3010*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q3010*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3010*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q3100*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3100*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ E_q4000*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- E_q4000*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + Ewi[1]*joint_wrt_i[2]*joint_wrt_i[2]- 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) ;
    elem_10 = + 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[1]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewi[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - Ewi[2]*joint_wrt_i[1]*joint_wrt_i[2] + 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) ;
    elem_11 = + 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewi[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewi[2]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[2]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[2]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[2]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 2*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) ;
    elem_12 = + 2*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) ;
    E_OOT(2,3) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000);

    elem_0 = E_q0004*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- E_q0004*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0013*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0013*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0013*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_1 = + 4*E_q0022*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0022*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0022*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0022*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0031*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_2 = + 2*E_q0031*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0031*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0040*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- E_q0040*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0103*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0103*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_3 = + 4*E_q0112*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0112*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0112*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0112*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0121*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0121*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_4 = + 2*E_q0121*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q0121*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0130*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q0130*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q0211*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q0211*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0301*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0301*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0310*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_5 = + 2*E_q0310*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0400*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ E_q0400*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1003*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1003*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1012*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1012*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1012*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1012*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1021*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_6 = + 4*E_q1021*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1021*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1021*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1030*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1030*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 6*E_q1102*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1102*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1120*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1120*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1201*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_7 = + 4*E_q1201*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1201*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1201*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1210*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1210*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1210*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1210*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1300*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1300*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1300*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q2011*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_8 = + 6*E_q2011*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q2101*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2101*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2101*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q2101*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q2110*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2110*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2110*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q2110*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q2200*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q2200*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2200*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q2200*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_9 = + 2*E_q3001*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q3001*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3010*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q3010*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q3100*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3100*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3100*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - E_q4000*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ E_q4000*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - Ewi[0]*joint_wrt_i[2]*joint_wrt_i[2]+ 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) ;
    elem_10 = + 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewi[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewi[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + Ewi[2]*joint_wrt_i[0]*joint_wrt_i[2] - 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewi[2]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    elem_11 = + Ewi[2]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[2]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[2]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) ;
    elem_12 = + Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) ;
    E_OOT(2,4) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + 2*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001);

    elem_0 = E_q0004*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0004*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0013*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0013*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0013*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_1 = + 2*E_q0013*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q0022*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0022*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0022*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0031*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_2 = + 2*E_q0031*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q0031*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0031*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + E_q0040*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0040*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0103*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0103*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_3 = + 2*E_q0103*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0103*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0112*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0112*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0112*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q0112*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0121*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_4 = + 2*E_q0121*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0121*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q0121*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0202*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q0202*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0202*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0211*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0211*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_5 = + 2*E_q0211*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0211*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0220*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0220*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0301*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0301*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0301*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q0301*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_6 = + E_q0400*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0400*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1012*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1012*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1012*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1012*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1021*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1021*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1021*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_7 = + 4*E_q1021*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1030*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1030*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1030*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1030*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1102*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1102*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1102*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1102*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1111*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q1111*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_8 = + 16*E_q1111*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1120*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1120*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1120*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1120*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1201*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1201*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1201*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1201*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1210*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1210*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_9 = + 2*E_q1210*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1210*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1300*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1300*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q1300*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1300*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2002*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q2002*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2011*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q2011*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q2011*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2011*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q2020*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_10 = + 6*E_q2020*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q2020*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2101*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q2101*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2101*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q2101*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2110*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q2110*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q2110*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q2110*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q2200*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2200*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2200*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3010*Ewj[0]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_11 = + 2*E_q3010*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q3010*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q3010*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3100*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q3100*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q3100*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q3100*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + E_q4000*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - E_q4000*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + Ewi[0]*joint_wrt_i[1]*joint_wrt_i[2] - 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewi[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    elem_12 = + Ewi[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - Ewi[1]*joint_wrt_i[0]*joint_wrt_i[2] + 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewi[1]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewi[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    elem_13 = + Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) ;
    E_OOT(2,5) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + elem_13 + 2*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);


    // SE parts
    elem_0 = Cwi[1][1]*joint_wrt_i[2]*joint_wrt_i[2]- 2*Cwi[1][2]*joint_wrt_i[1]*joint_wrt_i[2] + Cwi[2][2]*joint_wrt_i[1]*joint_wrt_i[1]+ 4*Cwj[0][0]*E_q0202*joint_wrt_j[1]*joint_wrt_j[1]- 8*Cwj[0][0]*E_q0211*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_1 = + 4*Cwj[0][0]*E_q0220*joint_wrt_j[2]*joint_wrt_j[2]+ 8*Cwj[0][0]*E_q1102*joint_wrt_j[1]*joint_wrt_j[2] + 8*Cwj[0][0]*E_q1111*joint_wrt_j[1]*joint_wrt_j[1]- 8*Cwj[0][0]*E_q1111*joint_wrt_j[2]*joint_wrt_j[2]- 8*Cwj[0][0]*E_q1120*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_2 = + 4*Cwj[0][0]*E_q2002*joint_wrt_j[2]*joint_wrt_j[2]+ 8*Cwj[0][0]*E_q2011*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][0]*E_q2020*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][1]*E_q0103*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q0112*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][1]*E_q0121*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_3 = + 4*Cwj[0][1]*E_q0130*joint_wrt_j[2]*joint_wrt_j[2]- 8*Cwj[0][1]*E_q0202*joint_wrt_j[0]*joint_wrt_j[1] + 8*Cwj[0][1]*E_q0211*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q0301*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q0310*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][1]*E_q1003*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][1]*E_q1012*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q1021*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][1]*E_q1030*joint_wrt_j[1]*joint_wrt_j[2] - 8*Cwj[0][1]*E_q1102*joint_wrt_j[0]*joint_wrt_j[2] - 16*Cwj[0][1]*E_q1111*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_4 = + 8*Cwj[0][1]*E_q1120*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q1201*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][1]*E_q1210*joint_wrt_j[1]*joint_wrt_j[2] - 8*Cwj[0][1]*E_q2011*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[0][1]*E_q2020*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][1]*E_q2101*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q2110*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][1]*E_q3001*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][1]*E_q3010*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q0103*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][2]*E_q0112*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q0121*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][2]*E_q0130*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_5 = + 8*Cwj[0][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[1] - 8*Cwj[0][2]*E_q0220*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q0301*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[0][2]*E_q0310*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q1003*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q1012*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[0][2]*E_q1021*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q1030*joint_wrt_j[1]*joint_wrt_j[1]- 8*Cwj[0][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[1] + 16*Cwj[0][2]*E_q1111*joint_wrt_j[0]*joint_wrt_j[2] + 8*Cwj[0][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q1201*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q1210*joint_wrt_j[1]*joint_wrt_j[1]- 8*Cwj[0][2]*E_q2002*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[0][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q2101*joint_wrt_j[1]*joint_wrt_j[1];
    elem_6 = + 4*Cwj[0][2]*E_q2110*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q3001*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q3010*joint_wrt_j[1]*joint_wrt_j[1]+ Cwj[1][1]*E_q0004*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[1][1]*E_q0022*joint_wrt_j[2]*joint_wrt_j[2]+ Cwj[1][1]*E_q0040*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[1][1]*E_q0103*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][1]*E_q0121*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][1]*E_q0202*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q0202*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[1][1]*E_q0220*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[1][1]*E_q0301*joint_wrt_j[0]*joint_wrt_j[2] + Cwj[1][1]*E_q0400*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[1][1]*E_q1012*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][1]*E_q1030*joint_wrt_j[0]*joint_wrt_j[2] + 8*Cwj[1][1]*E_q1111*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][1]*E_q1210*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][1]*E_q2002*joint_wrt_j[2]*joint_wrt_j[2];
    elem_7 = + 4*Cwj[1][1]*E_q2020*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q2020*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[1][1]*E_q2101*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[1][1]*E_q2200*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[1][1]*E_q3010*joint_wrt_j[0]*joint_wrt_j[2] + Cwj[1][1]*E_q4000*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[1][2]*E_q0004*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q0022*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[1][2]*E_q0040*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q0103*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[1][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q0121*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[1][2]*E_q0130*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q0202*joint_wrt_j[1]*joint_wrt_j[2] - 8*Cwj[1][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][2]*E_q0220*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q0301*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[1][2]*E_q0310*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][2]*E_q0400*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_8 = + 4*Cwj[1][2]*E_q1003*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q1012*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[1][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q1030*joint_wrt_j[0]*joint_wrt_j[1] + 8*Cwj[1][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[0]- 8*Cwj[1][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q1210*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[1][2]*E_q2002*joint_wrt_j[1]*joint_wrt_j[2] + 8*Cwj[1][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][2]*E_q2020*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q2101*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[1][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q2200*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q3001*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q3010*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[1][2]*E_q4000*joint_wrt_j[1]*joint_wrt_j[2] + Cwj[2][2]*E_q0004*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[2][2]*E_q0022*joint_wrt_j[1]*joint_wrt_j[1]+ Cwj[2][2]*E_q0040*joint_wrt_j[1]*joint_wrt_j[1];
    elem_9 = + 4*Cwj[2][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[2][2]*E_q0130*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[2][2]*E_q0202*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[2][2]*E_q0220*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q0220*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[2][2]*E_q0310*joint_wrt_j[0]*joint_wrt_j[1] + Cwj[2][2]*E_q0400*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[2][2]*E_q1003*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[2][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[1] - 8*Cwj[2][2]*E_q1111*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[2][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[2][2]*E_q2002*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q2002*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[2][2]*E_q2020*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[2][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[2][2]*E_q2200*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[2][2]*E_q3001*joint_wrt_j[0]*joint_wrt_j[1] + Cwj[2][2]*E_q4000*joint_wrt_j[1]*joint_wrt_j[1]+ E_q0004*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0004*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_10 = + E_q0004*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0022*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0022*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0022*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ E_q0040*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0040*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0040*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0103*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0103*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0103*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0103*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0112*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0112*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0112*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0112*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0121*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0121*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0121*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0121*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_11 = + 4*E_q0130*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0130*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0130*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0130*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0202*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 8*E_q0202*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0202*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0202*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0202*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0202*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 8*E_q0211*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q0211*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 8*E_q0211*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q0211*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0220*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q0220*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0220*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0220*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0220*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0220*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1];
    elem_12 = + 4*E_q0301*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0301*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0301*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0301*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0310*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0310*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0310*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0310*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0400*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0400*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0400*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1003*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1003*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1003*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1003*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1012*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1012*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1012*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1012*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1021*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1021*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_13 = + 4*E_q1021*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1021*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1030*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1030*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1030*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1030*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q1102*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q1102*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1102*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q1102*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 8*E_q1111*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 8*E_q1111*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 16*E_q1111*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 16*E_q1111*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 8*E_q1111*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 8*E_q1111*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 8*E_q1120*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q1120*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 8*E_q1120*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q1120*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1201*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1201*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1201*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] ;
    double elem_14 = + 4*E_q1201*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1210*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1210*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1210*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1210*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2002*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q2002*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q2002*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2002*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2002*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2002*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 8*E_q2011*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q2011*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q2011*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q2011*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q2020*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 8*E_q2020*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2020*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2020*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2020*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q2020*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q2101*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q2101*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2101*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    double elem_15 = + 4*E_q2101*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2110*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2110*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2110*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q2110*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2200*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2200*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2200*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q3001*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q3001*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q3001*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q3001*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q3010*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q3010*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q3010*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q3010*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q4000*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q4000*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + E_q4000*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ Ewi[1]* Ewi[1]*joint_wrt_i[2]*joint_wrt_i[2]- 2*Ewi[1]*Ewi[2]*joint_wrt_i[1]*joint_wrt_i[2] - 4*Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 4*Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 4*Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 4*Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) ;
    double elem_16 = + 4*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 4*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 4*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 4*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + Ewi[2]* Ewi[2]*joint_wrt_i[1]*joint_wrt_i[1]+ 4*Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 4*Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 4*Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 4*Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 4*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 4*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    double elem_17 = + 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 4*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 4*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) ;
    E_OOT(3,3) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + elem_13 + elem_14 + elem_15 + elem_16 + elem_17 + 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000);

    elem_0 = -Cwi[0][1]*joint_wrt_i[2]*joint_wrt_i[2]+ Cwi[0][2]*joint_wrt_i[1]*joint_wrt_i[2] + Cwi[1][2]*joint_wrt_i[0]*joint_wrt_i[2] - Cwi[2][2]*joint_wrt_i[0]*joint_wrt_i[1] + 2*Cwj[0][0]*E_q0103*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_1 = + 4*Cwj[0][0]*E_q0112*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q0112*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[0][0]*E_q0121*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][0]*E_q0130*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[0][0]*E_q0301*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q0310*joint_wrt_j[2]*joint_wrt_j[2];
    elem_2 = + 2*Cwj[0][0]*E_q1003*joint_wrt_j[2]*joint_wrt_j[2]+ 6*Cwj[0][0]*E_q1012*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][0]*E_q1021*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q1021*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[0][0]*E_q1030*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][0]*E_q1201*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[0][0]*E_q1201*joint_wrt_j[2]*joint_wrt_j[2];
    elem_3 = + 6*Cwj[0][0]*E_q1210*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][0]*E_q2101*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][0]*E_q2110*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[0][0]*E_q2110*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[0][0]*E_q3001*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[0][0]*E_q3010*joint_wrt_j[1]*joint_wrt_j[2] - Cwj[0][1]*E_q0004*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[0][1]*E_q0013*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][1]*E_q0031*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_4 = + Cwj[0][1]*E_q0040*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[0][1]*E_q0103*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[0][1]*E_q0112*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[0][1]*E_q0121*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[0][1]*E_q0211*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][1]*E_q0220*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[0][1]*E_q0301*joint_wrt_j[0]*joint_wrt_j[2] + Cwj[0][1]*E_q0400*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[0][1]*E_q1012*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[0][1]*E_q1021*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_5 = + 2*Cwj[0][1]*E_q1030*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[0][1]*E_q1102*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[0][1]*E_q1120*joint_wrt_j[1]*joint_wrt_j[2] + 8*Cwj[0][1]*E_q1201*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[0][1]*E_q1210*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[0][1]*E_q1300*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[0][1]*E_q2002*joint_wrt_j[2]*joint_wrt_j[2]+ 6*Cwj[0][1]*E_q2011*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[0][1]*E_q2101*joint_wrt_j[0]*joint_wrt_j[2] + 8*Cwj[0][1]*E_q2110*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_6 = + 2*Cwj[0][1]*E_q3010*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[0][1]*E_q3100*joint_wrt_j[1]*joint_wrt_j[2] - Cwj[0][1]*E_q4000*joint_wrt_j[2]*joint_wrt_j[2]+ Cwj[0][2]*E_q0004*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][2]*E_q0013*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[0][2]*E_q0031*joint_wrt_j[1]*joint_wrt_j[1]- Cwj[0][2]*E_q0040*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][2]*E_q0103*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[0][2]*E_q0121*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q0130*joint_wrt_j[0]*joint_wrt_j[2] - 6*Cwj[0][2]*E_q0211*joint_wrt_j[1]*joint_wrt_j[1];
    elem_7 = + 6*Cwj[0][2]*E_q0220*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][2]*E_q0301*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][2]*E_q0310*joint_wrt_j[0]*joint_wrt_j[2] - Cwj[0][2]*E_q0400*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q1003*joint_wrt_j[0]*joint_wrt_j[2] - 6*Cwj[0][2]*E_q1012*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[0][2]*E_q1030*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[0][2]*E_q1102*joint_wrt_j[1]*joint_wrt_j[1]- 6*Cwj[0][2]*E_q1120*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[2] - 6*Cwj[0][2]*E_q1210*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_8 = + 2*Cwj[0][2]*E_q1300*joint_wrt_j[1]*joint_wrt_j[1]- 6*Cwj[0][2]*E_q2002*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][2]*E_q2011*joint_wrt_j[1]*joint_wrt_j[1]+ 6*Cwj[0][2]*E_q2101*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q3001*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[0][2]*E_q3010*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[0][2]*E_q3100*joint_wrt_j[1]*joint_wrt_j[1]+ Cwj[0][2]*E_q4000*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[1][1]*E_q0013*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[1][1]*E_q0031*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][1]*E_q0112*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q0112*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[1][1]*E_q0130*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[1][1]*E_q0211*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_9 = + 2*Cwj[1][1]*E_q0310*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[1][1]*E_q1003*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[1][1]*E_q1021*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q1021*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[1][1]*E_q1102*joint_wrt_j[0]*joint_wrt_j[2] - 6*Cwj[1][1]*E_q1120*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][1]*E_q1201*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[1][1]*E_q1201*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[1][1]*E_q1300*joint_wrt_j[0]*joint_wrt_j[2] - 6*Cwj[1][1]*E_q2011*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][1]*E_q2110*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[1][1]*E_q2110*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[1][1]*E_q3001*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[1][1]*E_q3100*joint_wrt_j[0]*joint_wrt_j[2] + Cwj[1][2]*E_q0004*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][2]*E_q0013*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[1][2]*E_q0031*joint_wrt_j[0]*joint_wrt_j[1] - Cwj[1][2]*E_q0040*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_10 = + 2*Cwj[1][2]*E_q0103*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][2]*E_q0112*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q0121*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][2]*E_q0130*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[1][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[1][2]*E_q0220*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[1][2]*E_q0301*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q0310*joint_wrt_j[1]*joint_wrt_j[2] - Cwj[1][2]*E_q0400*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q1003*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[1][2]*E_q1012*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][2]*E_q1021*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[1][2]*E_q1030*joint_wrt_j[0]*joint_wrt_j[0]+ 6*Cwj[1][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[1][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[1][2]*E_q1201*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[1][2]*E_q1210*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][2]*E_q1300*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[1][2]*E_q2002*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_11 = + 6*Cwj[1][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[1][2]*E_q2101*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q2110*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q3001*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[1][2]*E_q3010*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][2]*E_q3100*joint_wrt_j[0]*joint_wrt_j[1] + Cwj[1][2]*E_q4000*joint_wrt_j[0]*joint_wrt_j[2] - Cwj[2][2]*E_q0004*joint_wrt_j[0]*joint_wrt_j[1] + Cwj[2][2]*E_q0040*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[2][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q0112*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[2][2]*E_q0130*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q0130*joint_wrt_j[1]*joint_wrt_j[1]- 6*Cwj[2][2]*E_q0220*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[2][2]*E_q0310*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[2][2]*E_q0310*joint_wrt_j[1]*joint_wrt_j[1]+ Cwj[2][2]*E_q0400*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[2][2]*E_q1003*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q1003*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[2][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q1021*joint_wrt_j[1]*joint_wrt_j[1];
    elem_12 = + 2*Cwj[2][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[2][2]*E_q1201*joint_wrt_j[1]*joint_wrt_j[1]+ 6*Cwj[2][2]*E_q2002*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[2][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[2][2]*E_q2110*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[2][2]*E_q3001*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[2][2]*E_q3001*joint_wrt_j[1]*joint_wrt_j[1]- Cwj[2][2]*E_q4000*joint_wrt_j[0]*joint_wrt_j[1] - E_q0004*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ E_q0004*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0004*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0004*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0013*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0013*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0013*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0013*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0031*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0031*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0031*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0031*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_13 = + E_q0040*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- E_q0040*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0040*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + E_q0040*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0103*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0103*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0103*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0103*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0112*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0112*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q0112*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0112*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0112*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0112*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0112*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0112*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0112*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q0121*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q0121*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0121*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q0121*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_14 = + 2*E_q0130*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0130*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0130*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0130*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0130*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0130*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q0211*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q0211*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q0211*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0211*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q0220*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q0220*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q0220*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q0220*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0301*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0301*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0301*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0301*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0310*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0310*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0310*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0310*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0310*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_15 = + 2*E_q0310*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ E_q0400*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- E_q0400*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0400*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + E_q0400*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1003*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1003*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1003*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1003*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1003*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1003*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q1012*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1012*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1012*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q1012*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1021*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1021*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q1021*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1021*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1021*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1021*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1021*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1021*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1021*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1030*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_16 = + 2*E_q1030*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1030*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1030*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 6*E_q1102*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1102*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q1102*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1102*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q1120*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1120*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q1120*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1120*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1201*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1201*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 8*E_q1201*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1201*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1201*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1201*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1201*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1201*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1201*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q1210*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1210*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1210*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q1210*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1300*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_17 = + 2*E_q1300*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1300*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1300*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q2002*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 6*E_q2002*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q2002*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q2002*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q2011*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q2011*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q2011*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q2011*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q2101*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q2101*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q2101*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q2101*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q2110*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q2110*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 8*E_q2110*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2110*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q2110*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2110*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2110*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2110*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2110*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q3001*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q3001*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] ;
    double elem_18 = + 2*E_q3001*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q3001*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3001*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q3001*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q3010*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3010*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3010*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3010*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q3100*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3100*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q3100*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q3100*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - E_q4000*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ E_q4000*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + E_q4000*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - E_q4000*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - Ewi[0]*Ewi[1]*joint_wrt_i[2]*joint_wrt_i[2]+ Ewi[0]*Ewi[2]*joint_wrt_i[1]*joint_wrt_i[2] + 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    double elem_19 = + Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + Ewi[1]*Ewi[2]*joint_wrt_i[0]*joint_wrt_i[2] - 2*Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    double elem_20 = + Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[2]* Ewi[2]*joint_wrt_i[0]*joint_wrt_i[1] - 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) ;
    double elem_21 = + 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) ;
    double elem_22 = + 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    E_OOT(3,4) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + elem_13 + elem_14 + elem_15 + elem_16 + elem_17 + elem_18 + elem_19 + elem_20 + elem_21 + elem_22 + Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001);

    elem_0 = Cwi[0][1]*joint_wrt_i[1]*joint_wrt_i[2] - Cwi[0][2]*joint_wrt_i[1]*joint_wrt_i[1]- Cwi[1][1]*joint_wrt_i[0]*joint_wrt_i[2] + Cwi[1][2]*joint_wrt_i[0]*joint_wrt_i[1] + 2*Cwj[0][0]*E_q0103*joint_wrt_j[1]*joint_wrt_j[1]- 6*Cwj[0][0]*E_q0112*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q0121*joint_wrt_j[1]*joint_wrt_j[1];
    elem_1 = + 4*Cwj[0][0]*E_q0121*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[0][0]*E_q0130*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q0301*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[0][0]*E_q0310*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][0]*E_q1003*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][0]*E_q1012*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][0]*E_q1012*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[0][0]*E_q1021*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q1030*joint_wrt_j[1]*joint_wrt_j[1]- 6*Cwj[0][0]*E_q1201*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q1210*joint_wrt_j[1]*joint_wrt_j[1];
    elem_2 = + 4*Cwj[0][0]*E_q1210*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[0][0]*E_q2101*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][0]*E_q2101*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[0][0]*E_q2110*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][0]*E_q3001*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][0]*E_q3010*joint_wrt_j[1]*joint_wrt_j[1]- Cwj[0][1]*E_q0004*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][1]*E_q0013*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[0][1]*E_q0031*joint_wrt_j[2]*joint_wrt_j[2]+ Cwj[0][1]*E_q0040*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q0103*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[0][1]*E_q0112*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_3 = + 4*Cwj[0][1]*E_q0121*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][1]*E_q0130*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[0][1]*E_q0202*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][1]*E_q0211*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][1]*E_q0301*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][1]*E_q0310*joint_wrt_j[0]*joint_wrt_j[2] - Cwj[0][1]*E_q0400*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][1]*E_q1003*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q1012*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[0][1]*E_q1021*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q1030*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[0][1]*E_q1102*joint_wrt_j[2]*joint_wrt_j[2];
    elem_4 = + 6*Cwj[0][1]*E_q1120*joint_wrt_j[2]*joint_wrt_j[2]+ 6*Cwj[0][1]*E_q1201*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q1210*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][1]*E_q1300*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[0][1]*E_q2011*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[0][1]*E_q2020*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q2101*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[0][1]*E_q2110*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[0][1]*E_q3001*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q3010*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][1]*E_q3100*joint_wrt_j[2]*joint_wrt_j[2]+ Cwj[0][1]*E_q4000*joint_wrt_j[1]*joint_wrt_j[2] + Cwj[0][2]*E_q0004*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][2]*E_q0013*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][2]*E_q0031*joint_wrt_j[1]*joint_wrt_j[2] - Cwj[0][2]*E_q0040*joint_wrt_j[1]*joint_wrt_j[1];
    elem_5 = + 6*Cwj[0][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[1] - 8*Cwj[0][2]*E_q0121*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[0][2]*E_q0130*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[0][2]*E_q0202*joint_wrt_j[1]*joint_wrt_j[1]+ 6*Cwj[0][2]*E_q0211*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][2]*E_q0310*joint_wrt_j[0]*joint_wrt_j[1] + Cwj[0][2]*E_q0400*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][2]*E_q1003*joint_wrt_j[0]*joint_wrt_j[1] + 8*Cwj[0][2]*E_q1012*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[0][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[0][2]*E_q1102*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][2]*E_q1120*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[0][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[1] - 8*Cwj[0][2]*E_q1210*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[0][2]*E_q1300*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[0][2]*E_q2011*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_6 = + 6*Cwj[0][2]*E_q2020*joint_wrt_j[1]*joint_wrt_j[1]+ 8*Cwj[0][2]*E_q2101*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[0][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][2]*E_q3001*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[0][2]*E_q3100*joint_wrt_j[1]*joint_wrt_j[2] - Cwj[0][2]*E_q4000*joint_wrt_j[1]*joint_wrt_j[1]+ Cwj[1][1]*E_q0004*joint_wrt_j[0]*joint_wrt_j[2] - Cwj[1][1]*E_q0040*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[1][1]*E_q0103*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q0103*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[1][1]*E_q0121*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q0121*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[1][1]*E_q0202*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][1]*E_q0301*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[1][1]*E_q0301*joint_wrt_j[2]*joint_wrt_j[2]+ Cwj[1][1]*E_q0400*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[1][1]*E_q1012*joint_wrt_j[0]*joint_wrt_j[0];
    elem_7 = + 2*Cwj[1][1]*E_q1012*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[1][1]*E_q1030*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[1][1]*E_q1030*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[1][1]*E_q1210*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q1210*joint_wrt_j[2]*joint_wrt_j[2]+ 6*Cwj[1][1]*E_q2020*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[1][1]*E_q2101*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[1][1]*E_q2101*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[1][1]*E_q3010*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q3010*joint_wrt_j[2]*joint_wrt_j[2]- Cwj[1][1]*E_q4000*joint_wrt_j[0]*joint_wrt_j[2] - Cwj[1][2]*E_q0004*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[1][2]*E_q0013*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][2]*E_q0031*joint_wrt_j[0]*joint_wrt_j[2] + Cwj[1][2]*E_q0040*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[1][2]*E_q0103*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[0];
    elem_8 = + 4*Cwj[1][2]*E_q0121*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[1][2]*E_q0130*joint_wrt_j[0]*joint_wrt_j[0]+ 6*Cwj[1][2]*E_q0202*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[1][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q0301*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[1][2]*E_q0310*joint_wrt_j[0]*joint_wrt_j[0]- Cwj[1][2]*E_q0400*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[1][2]*E_q1003*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q1012*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q1030*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][2]*E_q1210*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[1][2]*E_q1300*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[1][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q2020*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[1][2]*E_q2101*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[0];
    elem_9 = + 2*Cwj[1][2]*E_q3001*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][2]*E_q3010*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[1][2]*E_q3100*joint_wrt_j[0]*joint_wrt_j[2] + Cwj[1][2]*E_q4000*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[2][2]*E_q0013*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[2][2]*E_q0031*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[2][2]*E_q0103*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[2][2]*E_q0121*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q0121*joint_wrt_j[1]*joint_wrt_j[1]- 6*Cwj[2][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[2][2]*E_q0301*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[2][2]*E_q1012*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[2][2]*E_q1012*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[2][2]*E_q1030*joint_wrt_j[1]*joint_wrt_j[1]+ 6*Cwj[2][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[2][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[2][2]*E_q1210*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q1210*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[2][2]*E_q1300*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[2][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[2][2]*E_q2101*joint_wrt_j[0]*joint_wrt_j[0];
    elem_10 = + 2*Cwj[2][2]*E_q2101*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[2][2]*E_q3010*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[2][2]*E_q3100*joint_wrt_j[0]*joint_wrt_j[1] - E_q0004*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0004*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ E_q0004*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0004*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0013*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0013*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0013*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0013*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0031*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0031*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0031*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0031*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0040*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0040*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- E_q0040*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + E_q0040*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0103*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0103*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_11 = + 2*E_q0103*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0103*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0103*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0103*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q0112*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q0112*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0112*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q0112*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0121*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0121*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0121*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q0121*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0121*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0121*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0121*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0121*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0121*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0130*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0130*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0130*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0130*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_12 = + 6*E_q0202*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q0202*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q0202*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0202*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q0211*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q0211*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q0211*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q0211*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0301*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0301*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0301*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0301*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0301*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0301*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0310*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0310*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0310*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0310*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- E_q0400*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0400*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ E_q0400*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0400*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_13 = + 2*E_q1003*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1003*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1003*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1003*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1012*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1012*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1012*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q1012*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1012*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1012*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1012*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1012*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1012*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q1021*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1021*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1021*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1021*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1030*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1030*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1030*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1030*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1030*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_14 = + 2*E_q1030*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q1102*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 6*E_q1102*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1102*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1102*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q1120*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 6*E_q1120*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q1120*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1120*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1201*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1201*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q1201*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1201*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1210*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1210*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1210*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q1210*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1210*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1210*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1210*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1210*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1210*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1300*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_15 = + 2*E_q1300*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1300*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1300*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q2011*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q2011*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q2011*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q2011*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q2020*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q2020*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q2020*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q2020*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2101*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2101*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2101*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q2101*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2101*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2101*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2101*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q2101*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2101*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q2110*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q2110*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q2110*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q2110*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_16 = + 2*E_q3001*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3001*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q3001*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q3001*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q3010*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q3010*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q3010*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q3010*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q3010*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3010*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q3100*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 2*E_q3100*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q3100*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q3100*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q4000*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - E_q4000*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- E_q4000*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + E_q4000*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + Ewi[0]*Ewi[1]*joint_wrt_i[1]*joint_wrt_i[2] - Ewi[0]*Ewi[2]*joint_wrt_i[1]*joint_wrt_i[1]- 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) ;
    elem_17 = + 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - Ewi[1]* Ewi[1]*joint_wrt_i[0]*joint_wrt_i[2] + Ewi[1]*Ewi[2]*joint_wrt_i[0]*joint_wrt_i[1] + 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    elem_18 = + Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewi[1]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[1]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 2*Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) ;
    elem_19 = + Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[1]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[2]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[2]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) ;
    elem_20 = + 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) ;
    E_OOT(3,5) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + elem_13 + elem_14 + elem_15 + elem_16 + elem_17 + elem_18 + elem_19 + elem_20 + 2*Ewi[2]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);

    elem_0 = Cwi[0][0]*joint_wrt_i[2]*joint_wrt_i[2]- 2*Cwi[0][2]*joint_wrt_i[0]*joint_wrt_i[2] + Cwi[2][2]*joint_wrt_i[0]*joint_wrt_i[0]+ Cwj[0][0]*E_q0004*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][0]*E_q0013*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_1 = + 4*Cwj[0][0]*E_q0022*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q0022*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][0]*E_q0031*joint_wrt_j[1]*joint_wrt_j[2] + Cwj[0][0]*E_q0040*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[0][0]*E_q0202*joint_wrt_j[2]*joint_wrt_j[2];
    elem_2 = + 4*Cwj[0][0]*E_q0211*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q0220*joint_wrt_j[2]*joint_wrt_j[2]+ Cwj[0][0]*E_q0400*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][0]*E_q1102*joint_wrt_j[1]*joint_wrt_j[2] - 8*Cwj[0][0]*E_q1111*joint_wrt_j[1]*joint_wrt_j[1];
    elem_3 = + 4*Cwj[0][0]*E_q1120*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][0]*E_q1300*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q2002*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][0]*E_q2011*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][0]*E_q2020*joint_wrt_j[2]*joint_wrt_j[2];
    elem_4 = + 4*Cwj[0][0]*E_q2200*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q2200*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][0]*E_q3100*joint_wrt_j[1]*joint_wrt_j[2] + Cwj[0][0]*E_q4000*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][1]*E_q0013*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[0][1]*E_q0022*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_5 = + 4*Cwj[0][1]*E_q0031*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q0112*joint_wrt_j[2]*joint_wrt_j[2]+ 8*Cwj[0][1]*E_q0121*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q0130*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][1]*E_q0211*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q0310*joint_wrt_j[2]*joint_wrt_j[2];
    elem_6 = + 4*Cwj[0][1]*E_q1003*joint_wrt_j[2]*joint_wrt_j[2]+ 8*Cwj[0][1]*E_q1012*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q1021*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][1]*E_q1102*joint_wrt_j[0]*joint_wrt_j[2] + 16*Cwj[0][1]*E_q1111*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][1]*E_q1120*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_7 = + 4*Cwj[0][1]*E_q1201*joint_wrt_j[2]*joint_wrt_j[2]- 8*Cwj[0][1]*E_q1210*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q1300*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q2011*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[0][1]*E_q2101*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q2110*joint_wrt_j[2]*joint_wrt_j[2]- 8*Cwj[0][1]*E_q2200*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][1]*E_q3001*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][1]*E_q3100*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[0][2]*E_q0004*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q0013*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_8 = + 4*Cwj[0][2]*E_q0022*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q0031*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][2]*E_q0040*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q0112*joint_wrt_j[1]*joint_wrt_j[2] - 8*Cwj[0][2]*E_q0121*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[0][2]*E_q0130*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q0202*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][2]*E_q0220*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q0310*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][2]*E_q0400*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q1003*joint_wrt_j[1]*joint_wrt_j[2] - 8*Cwj[0][2]*E_q1012*joint_wrt_j[1]*joint_wrt_j[1];
    elem_9 = + 4*Cwj[0][2]*E_q1021*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q1201*joint_wrt_j[1]*joint_wrt_j[2] + 8*Cwj[0][2]*E_q1210*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[0][2]*E_q1300*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][2]*E_q2002*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q2020*joint_wrt_j[0]*joint_wrt_j[2] + 8*Cwj[0][2]*E_q2101*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[0][2]*E_q2110*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q2200*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q3001*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q3100*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][2]*E_q4000*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_10 = + 4*Cwj[1][1]*E_q0022*joint_wrt_j[0]*joint_wrt_j[0]- 8*Cwj[1][1]*E_q0121*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][1]*E_q0220*joint_wrt_j[2]*joint_wrt_j[2]- 8*Cwj[1][1]*E_q1012*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[1][1]*E_q1111*joint_wrt_j[0]*joint_wrt_j[0]+ 8*Cwj[1][1]*E_q1111*joint_wrt_j[2]*joint_wrt_j[2]+ 8*Cwj[1][1]*E_q1210*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][1]*E_q2002*joint_wrt_j[2]*joint_wrt_j[2]+ 8*Cwj[1][1]*E_q2101*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][1]*E_q2200*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][2]*E_q0013*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q0031*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[2] + 8*Cwj[1][2]*E_q0121*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[1][2]*E_q0130*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[0]- 8*Cwj[1][2]*E_q0220*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q0310*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q1003*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_11 = + 8*Cwj[1][2]*E_q1012*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[1][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[0]- 16*Cwj[1][2]*E_q1111*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[1][2]*E_q1210*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[1][2]*E_q1300*joint_wrt_j[0]*joint_wrt_j[0]- 8*Cwj[1][2]*E_q2002*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[0]- 8*Cwj[1][2]*E_q2101*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[1][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q3001*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q3100*joint_wrt_j[0]*joint_wrt_j[0]+ Cwj[2][2]*E_q0004*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q0022*joint_wrt_j[0]*joint_wrt_j[0]+ Cwj[2][2]*E_q0040*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[2][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[2][2]*E_q0130*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[2][2]*E_q0202*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q0220*joint_wrt_j[0]*joint_wrt_j[0];
    elem_12 = + 4*Cwj[2][2]*E_q0220*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[2][2]*E_q0310*joint_wrt_j[0]*joint_wrt_j[1] + Cwj[2][2]*E_q0400*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[2][2]*E_q1003*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[2][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[1] + 8*Cwj[2][2]*E_q1111*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[2][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[2][2]*E_q2002*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[2][2]*E_q2002*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[2][2]*E_q2020*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[2][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[2][2]*E_q2200*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[2][2]*E_q3001*joint_wrt_j[0]*joint_wrt_j[1] + Cwj[2][2]*E_q4000*joint_wrt_j[0]*joint_wrt_j[0]+ E_q0004*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0004*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + E_q0004*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0013*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0013*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0013*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0013*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_13 = + 4*E_q0022*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0022*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q0022*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0022*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0022*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0022*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q0031*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0031*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0031*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0031*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ E_q0040*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0040*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + E_q0040*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0112*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0112*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0112*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0112*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q0121*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q0121*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 8*E_q0121*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_14 = + 8*E_q0121*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0130*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0130*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0130*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0130*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0202*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0202*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0202*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0211*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0211*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0211*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0211*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0220*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0220*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0220*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q0220*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0220*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0220*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0310*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0310*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0310*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_15 = + 4*E_q0310*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0400*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0400*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + E_q0400*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1003*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1003*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1003*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1003*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q1012*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q1012*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 8*E_q1012*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 8*E_q1012*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1021*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1021*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1021*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1021*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1102*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1102*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1102*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1102*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 8*E_q1111*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 16*E_q1111*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q1111*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_16 = + 8*E_q1111*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 16*E_q1111*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q1111*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1120*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1120*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1120*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1120*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1201*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1201*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1201*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1201*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q1210*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q1210*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 8*E_q1210*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1210*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1300*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1300*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1300*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1300*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2002*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2002*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2002*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q2002*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q2002*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_17 = + 4*E_q2002*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2011*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2011*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2011*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2011*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2020*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2020*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2020*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 8*E_q2101*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q2101*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 8*E_q2101*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q2101*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2110*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2110*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2110*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q2110*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2200*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q2200*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q2200*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q2200*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2200*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2200*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q3001*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q3001*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q3001*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q3001*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_18 = + 4*E_q3100*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q3100*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q3100*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q3100*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ E_q4000*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q4000*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + E_q4000*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ Ewi[0]* Ewi[0]*joint_wrt_i[2]*joint_wrt_i[2]- 2*Ewi[0]*Ewi[2]*joint_wrt_i[0]*joint_wrt_i[2] + 4*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 4*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 4*Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 4*Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + 4*Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 4*Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    elem_19 = + 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 4*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 4*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + Ewi[2]* Ewi[2]*joint_wrt_i[0]*joint_wrt_i[0]- 4*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 4*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 4*Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 4*Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 4*Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 4*Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    elem_20 = + 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 4*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) ;
    E_OOT(4,4) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + elem_13 + elem_14 + elem_15 + elem_16 + elem_17 + elem_18 + elem_19 + elem_20 + 4*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001);

    elem_0 = -Cwi[0][0]*joint_wrt_i[1]*joint_wrt_i[2] + Cwi[0][1]*joint_wrt_i[0]*joint_wrt_i[2] + Cwi[0][2]*joint_wrt_i[0]*joint_wrt_i[1] - Cwi[1][2]*joint_wrt_i[0]*joint_wrt_i[0]+ Cwj[0][0]*E_q0004*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_1 = + 2*Cwj[0][0]*E_q0013*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q0013*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[0][0]*E_q0022*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q0031*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[0][0]*E_q0031*joint_wrt_j[2]*joint_wrt_j[2];
    elem_2 = + Cwj[0][0]*E_q0040*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q0211*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q0211*joint_wrt_j[2]*joint_wrt_j[2]- Cwj[0][0]*E_q0400*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q1102*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q1102*joint_wrt_j[2]*joint_wrt_j[2];
    elem_3 = + 2*Cwj[0][0]*E_q1120*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[0][0]*E_q1120*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[0][0]*E_q1300*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q1300*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[0][0]*E_q2011*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[0][0]*E_q2011*joint_wrt_j[2]*joint_wrt_j[2];
    elem_4 = + 6*Cwj[0][0]*E_q2200*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q3100*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[0][0]*E_q3100*joint_wrt_j[2]*joint_wrt_j[2]- Cwj[0][0]*E_q4000*joint_wrt_j[1]*joint_wrt_j[2] - Cwj[0][1]*E_q0004*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q0013*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[0][1]*E_q0022*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_5 = + 4*Cwj[0][1]*E_q0031*joint_wrt_j[0]*joint_wrt_j[1] - Cwj[0][1]*E_q0040*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[0][1]*E_q0103*joint_wrt_j[2]*joint_wrt_j[2]+ 6*Cwj[0][1]*E_q0112*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][1]*E_q0121*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[0][1]*E_q0130*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q0211*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_6 = + 2*Cwj[0][1]*E_q0301*joint_wrt_j[2]*joint_wrt_j[2]- 2*Cwj[0][1]*E_q0310*joint_wrt_j[1]*joint_wrt_j[2] + Cwj[0][1]*E_q0400*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[0][1]*E_q1003*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][1]*E_q1012*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[0][1]*E_q1021*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][1]*E_q1030*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][1]*E_q1102*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][1]*E_q1120*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[0][1]*E_q1201*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][1]*E_q1210*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][1]*E_q1300*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][1]*E_q2011*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[0][1]*E_q2101*joint_wrt_j[2]*joint_wrt_j[2];
    elem_7 = + 6*Cwj[0][1]*E_q2110*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][1]*E_q2200*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[0][1]*E_q3001*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][1]*E_q3010*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][1]*E_q3100*joint_wrt_j[0]*joint_wrt_j[1] + Cwj[0][1]*E_q4000*joint_wrt_j[0]*joint_wrt_j[2] - Cwj[0][2]*E_q0004*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][2]*E_q0013*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[0][2]*E_q0022*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q0031*joint_wrt_j[0]*joint_wrt_j[2] - Cwj[0][2]*E_q0040*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][2]*E_q0103*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][2]*E_q0112*joint_wrt_j[1]*joint_wrt_j[1]+ 6*Cwj[0][2]*E_q0121*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][2]*E_q0130*joint_wrt_j[1]*joint_wrt_j[1];
    elem_8 = + 4*Cwj[0][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[0][2]*E_q0301*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][2]*E_q0310*joint_wrt_j[1]*joint_wrt_j[1]+ Cwj[0][2]*E_q0400*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][2]*E_q1003*joint_wrt_j[1]*joint_wrt_j[1]+ 6*Cwj[0][2]*E_q1012*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[0][2]*E_q1021*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][2]*E_q1030*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[0][2]*E_q1201*joint_wrt_j[1]*joint_wrt_j[1]+ 6*Cwj[0][2]*E_q1210*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q1300*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[0][2]*E_q2101*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[0][2]*E_q2110*joint_wrt_j[1]*joint_wrt_j[1]- 6*Cwj[0][2]*E_q2200*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[0][2]*E_q3001*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][2]*E_q3010*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q3100*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_9 = + Cwj[0][2]*E_q4000*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[1][1]*E_q0013*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q0031*joint_wrt_j[0]*joint_wrt_j[0]- 6*Cwj[1][1]*E_q0112*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[1][1]*E_q0130*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][1]*E_q0211*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][1]*E_q0211*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[1][1]*E_q0310*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][1]*E_q1003*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[1][1]*E_q1021*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][1]*E_q1102*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][1]*E_q1102*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[1][1]*E_q1120*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][1]*E_q1120*joint_wrt_j[2]*joint_wrt_j[2]+ 6*Cwj[1][1]*E_q1201*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[1][1]*E_q1300*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[1][1]*E_q2011*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][1]*E_q2011*joint_wrt_j[2]*joint_wrt_j[2]- 6*Cwj[1][1]*E_q2110*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][1]*E_q3001*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][1]*E_q3100*joint_wrt_j[0]*joint_wrt_j[0];
    elem_10 = + Cwj[1][2]*E_q0004*joint_wrt_j[0]*joint_wrt_j[0]- 6*Cwj[1][2]*E_q0022*joint_wrt_j[0]*joint_wrt_j[0]+ Cwj[1][2]*E_q0040*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][2]*E_q0103*joint_wrt_j[0]*joint_wrt_j[2] + 6*Cwj[1][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[1][2]*E_q0121*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][2]*E_q0130*joint_wrt_j[0]*joint_wrt_j[1] - 8*Cwj[1][2]*E_q0211*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[1][2]*E_q0301*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][2]*E_q0310*joint_wrt_j[0]*joint_wrt_j[1] - Cwj[1][2]*E_q0400*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[1][2]*E_q1003*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[1][2]*E_q1012*joint_wrt_j[0]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[1][2]*E_q1030*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[1][2]*E_q1102*joint_wrt_j[1]*joint_wrt_j[2] + 8*Cwj[1][2]*E_q1120*joint_wrt_j[1]*joint_wrt_j[2] - 6*Cwj[1][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[1][2]*E_q1210*joint_wrt_j[0]*joint_wrt_j[2] + 8*Cwj[1][2]*E_q2011*joint_wrt_j[1]*joint_wrt_j[2] + 6*Cwj[1][2]*E_q2101*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_11 = + 6*Cwj[1][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[1] + 6*Cwj[1][2]*E_q2200*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[1][2]*E_q3001*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[1][2]*E_q3010*joint_wrt_j[0]*joint_wrt_j[2] - Cwj[1][2]*E_q4000*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[2][2]*E_q0013*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[2][2]*E_q0031*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[2][2]*E_q0103*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[2][2]*E_q0121*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[2][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[2][2]*E_q0211*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[2][2]*E_q0301*joint_wrt_j[0]*joint_wrt_j[1] - 6*Cwj[2][2]*E_q1012*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[2][2]*E_q1030*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[2][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[2][2]*E_q1102*joint_wrt_j[1]*joint_wrt_j[1]+ 2*Cwj[2][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[2][2]*E_q1120*joint_wrt_j[1]*joint_wrt_j[1]- 6*Cwj[2][2]*E_q1210*joint_wrt_j[0]*joint_wrt_j[1] - 2*Cwj[2][2]*E_q1300*joint_wrt_j[0]*joint_wrt_j[0]+ 2*Cwj[2][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[2][2]*E_q2011*joint_wrt_j[1]*joint_wrt_j[1]- 6*Cwj[2][2]*E_q2101*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_12 = + 2*Cwj[2][2]*E_q3010*joint_wrt_j[0]*joint_wrt_j[1] + 2*Cwj[2][2]*E_q3100*joint_wrt_j[0]*joint_wrt_j[0]+ E_q0004*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0004*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0004*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0004*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0013*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0013*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q0013*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0013*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0013*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0013*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 6*E_q0022*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q0022*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0022*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q0022*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0031*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0031*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0031*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0031*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0031*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0031*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_13 = + E_q0040*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - E_q0040*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - E_q0040*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0040*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q0103*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0103*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0103*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0103*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q0112*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q0112*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q0112*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q0112*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q0121*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q0121*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q0121*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q0121*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0130*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0130*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0130*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0130*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0211*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0211*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_14 = + 4*E_q0211*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0211*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0211*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0211*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q0211*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0211*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0211*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0301*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q0301*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q0301*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q0301*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0310*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q0310*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q0310*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0310*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - E_q0400*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + E_q0400*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + E_q0400*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - E_q0400*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q1003*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1003*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1003*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1003*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1012*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_15 = + 6*E_q1012*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1012*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1012*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1021*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1021*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q1021*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1021*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1030*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q1030*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1030*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1030*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q1102*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1102*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q1102*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1102*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q1102*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1102*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q1102*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q1102*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q1102*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1120*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q1120*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1120*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1120*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_16 = + 2*E_q1120*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1120*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 8*E_q1120*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q1120*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1120*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q1201*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1201*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 6*E_q1201*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1201*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 6*E_q1210*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q1210*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q1210*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q1210*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q1300*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q1300*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q1300*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1300*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q1300*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q1300*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2011*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q2011*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 4*E_q2011*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2011*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q2011*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q2011*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_17 = + 8*E_q2011*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 2*E_q2011*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q2011*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q2101*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 6*E_q2101*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 6*E_q2101*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q2101*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q2110*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q2110*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 6*E_q2110*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 6*E_q2110*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q2200*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 6*E_q2200*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 6*E_q2200*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 6*E_q2200*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q3001*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3001*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q3001*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3001*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q3010*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 2*E_q3010*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 2*E_q3010*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 2*E_q3010*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q3100*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 2*E_q3100*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2];
    elem_18 = + 4*E_q3100*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q3100*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q3100*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q3100*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- E_q4000*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + E_q4000*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + E_q4000*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - E_q4000*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- Ewi[0]* Ewi[0]*joint_wrt_i[1]*joint_wrt_i[2] + Ewi[0]*Ewi[1]*joint_wrt_i[0]*joint_wrt_i[2] + Ewi[0]*Ewi[2]*joint_wrt_i[0]*joint_wrt_i[1] - 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[0]*Ewj[0]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) ;
    elem_19 = + 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[0]*Ewj[1]*joint_wrt_i[2]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) + 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) ;
    elem_20 = + 2*Ewi[0]*Ewj[2]*joint_wrt_i[2]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - Ewi[1]*Ewi[2]*joint_wrt_i[0]*joint_wrt_i[0]+ 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) + 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0112 + E_q0130 + E_q0310 + E_q2110) - 2*Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1003 + E_q1021 + E_q1201 + E_q3001) - Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) ;
    elem_21 = + Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) + 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) ;
    elem_22 = + 2*Ewi[2]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) ;
    double elem_23 = + Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 2*Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 2*Ewi[2]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) ;
    E_OOT(4,5) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + elem_13 + elem_14 + elem_15 + elem_16 + elem_17 + elem_18 + elem_19 + elem_20 + elem_21 + elem_22 + elem_23 + 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 2*Ewi[2]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);

    elem_0 = Cwi[0][0]*joint_wrt_i[1]*joint_wrt_i[1]- 2*Cwi[0][1]*joint_wrt_i[0]*joint_wrt_i[1] + Cwi[1][1]*joint_wrt_i[0]*joint_wrt_i[0]+ Cwj[0][0]*E_q0004*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][0]*E_q0013*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q0022*joint_wrt_j[1]*joint_wrt_j[1];
    elem_1 = + 4*Cwj[0][0]*E_q0022*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][0]*E_q0031*joint_wrt_j[1]*joint_wrt_j[2] + Cwj[0][0]*E_q0040*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q0202*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[0][0]*E_q0211*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][0]*E_q0220*joint_wrt_j[1]*joint_wrt_j[1];
    elem_2 = + Cwj[0][0]*E_q0400*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][0]*E_q1102*joint_wrt_j[1]*joint_wrt_j[2] + 8*Cwj[0][0]*E_q1111*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][0]*E_q1120*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][0]*E_q1300*joint_wrt_j[1]*joint_wrt_j[2] + 2*Cwj[0][0]*E_q2002*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][0]*E_q2011*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][0]*E_q2020*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][0]*E_q2200*joint_wrt_j[1]*joint_wrt_j[1];
    elem_3 = + 4*Cwj[0][0]*E_q2200*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][0]*E_q3100*joint_wrt_j[1]*joint_wrt_j[2] + Cwj[0][0]*E_q4000*joint_wrt_j[1]*joint_wrt_j[1]- 2*Cwj[0][1]*E_q0004*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][1]*E_q0013*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q0022*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][1]*E_q0031*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[0][1]*E_q0040*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][1]*E_q0103*joint_wrt_j[1]*joint_wrt_j[2] - 8*Cwj[0][1]*E_q0112*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[0][1]*E_q0121*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_4 = + 4*Cwj[0][1]*E_q0202*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][1]*E_q0211*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q0220*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][1]*E_q0301*joint_wrt_j[1]*joint_wrt_j[2] - 2*Cwj[0][1]*E_q0400*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][1]*E_q1012*joint_wrt_j[1]*joint_wrt_j[2] + 8*Cwj[0][1]*E_q1021*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][1]*E_q1030*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q1102*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q1120*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[0][1]*E_q1201*joint_wrt_j[2]*joint_wrt_j[2];
    elem_5 = + 4*Cwj[0][1]*E_q1210*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q1300*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][1]*E_q2002*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][1]*E_q2011*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q2020*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][1]*E_q2101*joint_wrt_j[1]*joint_wrt_j[2] + 8*Cwj[0][1]*E_q2110*joint_wrt_j[2]*joint_wrt_j[2]+ 4*Cwj[0][1]*E_q2200*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][1]*E_q3010*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][1]*E_q3100*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[0][1]*E_q4000*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_6 = + 4*Cwj[0][2]*E_q0013*joint_wrt_j[0]*joint_wrt_j[1] - 8*Cwj[0][2]*E_q0022*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q0031*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q0103*joint_wrt_j[1]*joint_wrt_j[1]+ 8*Cwj[0][2]*E_q0112*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q0121*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][2]*E_q0301*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[0][2]*E_q1012*joint_wrt_j[1]*joint_wrt_j[1]- 8*Cwj[0][2]*E_q1021*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q1030*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[0][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[1] - 16*Cwj[0][2]*E_q1111*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[1] ;
    elem_7 = + 8*Cwj[0][2]*E_q1201*joint_wrt_j[1]*joint_wrt_j[2] - 4*Cwj[0][2]*E_q1210*joint_wrt_j[1]*joint_wrt_j[1]- 4*Cwj[0][2]*E_q1300*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[0][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[0][2]*E_q2101*joint_wrt_j[1]*joint_wrt_j[1]- 8*Cwj[0][2]*E_q2110*joint_wrt_j[1]*joint_wrt_j[2] - 8*Cwj[0][2]*E_q2200*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[0][2]*E_q3010*joint_wrt_j[1]*joint_wrt_j[1]+ 4*Cwj[0][2]*E_q3100*joint_wrt_j[0]*joint_wrt_j[1] + Cwj[1][1]*E_q0004*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q0022*joint_wrt_j[0]*joint_wrt_j[0]+ Cwj[1][1]*E_q0040*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][1]*E_q0103*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][1]*E_q0121*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][1]*E_q0202*joint_wrt_j[0]*joint_wrt_j[0];
    elem_8 = + 4*Cwj[1][1]*E_q0202*joint_wrt_j[2]*joint_wrt_j[2]+ 2*Cwj[1][1]*E_q0220*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][1]*E_q0301*joint_wrt_j[0]*joint_wrt_j[2] + Cwj[1][1]*E_q0400*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][1]*E_q1012*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][1]*E_q1030*joint_wrt_j[0]*joint_wrt_j[2] - 8*Cwj[1][1]*E_q1111*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[1][1]*E_q1210*joint_wrt_j[0]*joint_wrt_j[2] + 2*Cwj[1][1]*E_q2002*joint_wrt_j[0]*joint_wrt_j[0]- 2*Cwj[1][1]*E_q2020*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][1]*E_q2020*joint_wrt_j[2]*joint_wrt_j[2]- 4*Cwj[1][1]*E_q2101*joint_wrt_j[0]*joint_wrt_j[2] - 2*Cwj[1][1]*E_q2200*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][1]*E_q3010*joint_wrt_j[0]*joint_wrt_j[2] + Cwj[1][1]*E_q4000*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q0013*joint_wrt_j[0]*joint_wrt_j[0];
    elem_9 = + 4*Cwj[1][2]*E_q0031*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[1][2]*E_q0103*joint_wrt_j[0]*joint_wrt_j[1] + 8*Cwj[1][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q0121*joint_wrt_j[0]*joint_wrt_j[1] - 8*Cwj[1][2]*E_q0202*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q0211*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q0301*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[1][2]*E_q1012*joint_wrt_j[0]*joint_wrt_j[1] - 8*Cwj[1][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q1030*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[1][2]*E_q1102*joint_wrt_j[0]*joint_wrt_j[0]+ 16*Cwj[1][2]*E_q1111*joint_wrt_j[1]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q1120*joint_wrt_j[0]*joint_wrt_j[0]+ 8*Cwj[1][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[2] + 4*Cwj[1][2]*E_q1210*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[1][2]*E_q1300*joint_wrt_j[0]*joint_wrt_j[0]- 4*Cwj[1][2]*E_q2011*joint_wrt_j[0]*joint_wrt_j[0]- 8*Cwj[1][2]*E_q2020*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_10 = + 4*Cwj[1][2]*E_q2101*joint_wrt_j[0]*joint_wrt_j[1] - 8*Cwj[1][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[2] - 4*Cwj[1][2]*E_q3010*joint_wrt_j[0]*joint_wrt_j[1] - 4*Cwj[1][2]*E_q3100*joint_wrt_j[0]*joint_wrt_j[0]+ 4*Cwj[2][2]*E_q0022*joint_wrt_j[0]*joint_wrt_j[0]- 8*Cwj[2][2]*E_q0112*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[2][2]*E_q0202*joint_wrt_j[1]*joint_wrt_j[1]+ 8*Cwj[2][2]*E_q1021*joint_wrt_j[0]*joint_wrt_j[1] + 8*Cwj[2][2]*E_q1111*joint_wrt_j[0]*joint_wrt_j[0]- 8*Cwj[2][2]*E_q1111*joint_wrt_j[1]*joint_wrt_j[1]- 8*Cwj[2][2]*E_q1201*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[2][2]*E_q2020*joint_wrt_j[1]*joint_wrt_j[1]+ 8*Cwj[2][2]*E_q2110*joint_wrt_j[0]*joint_wrt_j[1] + 4*Cwj[2][2]*E_q2200*joint_wrt_j[0]*joint_wrt_j[0]+ E_q0004*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0004*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0004*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q0013*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] ;
    elem_11 = + 4*E_q0013*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q0013*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0013*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q0022*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0022*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q0022*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q0022*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q0022*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0022*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0031*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0031*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0031*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0031*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ E_q0040*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0040*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0040*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0103*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0103*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0103*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_12 = + 4*E_q0103*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q0112*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 8*E_q0112*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q0112*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q0112*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q0121*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0121*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0121*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0121*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0202*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0202*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q0202*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q0202*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q0202*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0202*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0211*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q0211*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0211*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q0211*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0];
    elem_13 = + 2*E_q0220*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q0220*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q0220*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q0301*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q0301*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q0301*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q0301*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0400*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q0400*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + E_q0400*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q1012*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1012*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1012*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1012*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q1021*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q1021*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q1021*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] + 8*E_q1021*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1030*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1030*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1030*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_14 = + 4*E_q1030*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1102*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q1102*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q1102*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q1102*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 8*E_q1111*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]- 16*E_q1111*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1111*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 16*E_q1111*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q1111*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 8*E_q1111*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q1120*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1120*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1120*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1120*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 8*E_q1201*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]+ 8*E_q1201*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 8*E_q1201*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 8*E_q1201*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1210*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1210*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q1210*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_15 = + 4*E_q1210*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1300*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q1300*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q1300*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 4*E_q1300*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ 2*E_q2002*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2002*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + 2*E_q2002*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q2011*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2011*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2011*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q2011*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 2*E_q2020*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q2020*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q2020*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q2020*Ewj[1]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q2020*Ewj[1]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q2020*Ewj[2]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q2101*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] - 4*E_q2101*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]- 4*E_q2101*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q2101*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] + 8*E_q2110*Ewj[0]*Ewj[1]*joint_wrt_j[2]*joint_wrt_j[2]- 8*E_q2110*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[2] - 8*E_q2110*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] ;
    elem_16 = + 8*E_q2110*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 2*E_q2200*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q2200*Ewj[0]*Ewj[0]*joint_wrt_j[2]*joint_wrt_j[2]+ 4*E_q2200*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] - 8*E_q2200*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[2] - 2*E_q2200*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ 4*E_q2200*Ewj[2]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]- 4*E_q3010*Ewj[0]*Ewj[1]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q3010*Ewj[0]*Ewj[2]*joint_wrt_j[1]*joint_wrt_j[1]+ 4*E_q3010*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] - 4*E_q3010*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q3100*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[2] + 4*E_q3100*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[2] + 4*E_q3100*Ewj[0]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[1] - 4*E_q3100*Ewj[1]*Ewj[2]*joint_wrt_j[0]*joint_wrt_j[0]+ E_q4000*Ewj[0]*Ewj[0]*joint_wrt_j[1]*joint_wrt_j[1]- 2*E_q4000*Ewj[0]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[1] + E_q4000*Ewj[1]*Ewj[1]*joint_wrt_j[0]*joint_wrt_j[0]+ Ewi[0]* Ewi[0]*joint_wrt_i[1]*joint_wrt_i[1]- 2*Ewi[0]*Ewi[1]*joint_wrt_i[0]*joint_wrt_i[1] - 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) + 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - 2*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) ;
    elem_17 = + 4*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 4*Ewi[0]*Ewj[0]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + 2*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 4*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) + 4*Ewi[0]*Ewj[1]*joint_wrt_i[1]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) - 4*Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 4*Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) + 4*Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 4*Ewi[0]*Ewj[2]*joint_wrt_i[1]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + Ewi[1]* Ewi[1]*joint_wrt_i[0]*joint_wrt_i[0]+ 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) - 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) - 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) + 2*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) - 4*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) - 4*Ewi[1]*Ewj[0]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0004 + E_q0022 + E_q0202 + E_q2002) ;
    elem_18 = + 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0022 + E_q0040 + E_q0220 + E_q2020) + 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0202 + E_q0220 + E_q0400 + E_q2200) - 2*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q2002 + E_q2020 + E_q2200 + E_q4000) ;
    elem_19 = + 4*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) - 4*Ewi[1]*Ewj[1]*joint_wrt_i[0]*joint_wrt_j[2]*(E_q1012 + E_q1030 + E_q1210 + E_q3010) + 4*Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q0013 + E_q0031 + E_q0211 + E_q2011) + 4*Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[0]*(E_q1102 + E_q1120 + E_q1300 + E_q3100) - 4*Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q0103 + E_q0121 + E_q0301 + E_q2101) ;
    E_OOT(5,5) = elem_0 + elem_1 + elem_2 + elem_3 + elem_4 + elem_5 + elem_6 + elem_7 + elem_8 + elem_9 + elem_10 + elem_11 + elem_12 + elem_13 + elem_14 + elem_15 + elem_16 + elem_17 + elem_18 + elem_19 + 4*Ewi[1]*Ewj[2]*joint_wrt_i[0]*joint_wrt_j[1]*(E_q1012 + E_q1030 + E_q1210 + E_q3010);

    // symmetric parts
    E_OOT(1,0) = E_OOT(0,1);
    E_OOT(2,0) = E_OOT(0,2);
    E_OOT(3,0) = E_OOT(0,3);
    E_OOT(4,0) = E_OOT(0,4);
    E_OOT(5,0) = E_OOT(0,5);
    E_OOT(2,1) = E_OOT(1,2);
    E_OOT(3,1) = E_OOT(1,3);
    E_OOT(4,1) = E_OOT(1,4);
    E_OOT(5,1) = E_OOT(1,5);
    E_OOT(3,2) = E_OOT(2,3);
    E_OOT(4,2) = E_OOT(2,4);
    E_OOT(5,2) = E_OOT(2,5);
    E_OOT(4,3) = E_OOT(3,4);
    E_OOT(5,3) = E_OOT(3,5);
    E_OOT(5,4) = E_OOT(4,5);

    return _E_OOT;
}



// for pybind module
PYBIND11_MODULE(_noisecov_helper, m)
{
    // The utility functions for covariance calculations
    m.def("_calc_10D_ddnc", &calc_10D_ddnc, "");
    m.def("_calc_4thmoment_coeff", &calc_4thmoment_coeff, "");
    m.def("_calc_Bingham_4thMoment", &calc_Bingham_4thMoment, "");
    m.def("_calc_covQ_from_4thmoment", &calc_covQ_from_4thmoment, "");
    m.def("_calc_nextq_Cov", &calc_nextq_Cov, "");
    m.def("_calc_rotation_prediction_noise", &calc_rotation_prediction_noise, "");
    m.def("_calc_E_R", &calc_E_R, "");
    m.def("_calc_E_R_kron_R", &calc_E_R_kron_R, "");
    m.def("_calc_E_vCMcb_kron_vCMcb", &calc_E_vCMcb_kron_vCMcb, "");
    m.def("_calc_E_vCMsq_kron_vCMsq", &calc_E_vCMsq_kron_vCMsq, "");
    m.def("_calc_E_vCM_kron_vCM", &calc_E_vCM_kron_vCM, "");
    m.def("_calc_translation_observation_1stmoment", &calc_translation_observation_1stmoment, "");
    m.def("_calc_translation_observation_2ndmoment", &calc_translation_observation_2ndmoment, "");
}